<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Te Reo MƒÅori Wordle | Te Kete Ako</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Merriweather:ital,wght@0,400;1,300&family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/main.css">
    <style>
        .game-container {
            max-width: 500px;
            margin: 0 auto;
            padding: clamp(0.5rem, 2.5vw, 1rem);
            text-align: center;
            width: 100%;
        }
        
        .game-header {
            margin-bottom: 2rem;
        }
        
        .game-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--color-primary);
            margin-bottom: 0.5rem;
        }
        
        .game-subtitle {
            color: var(--color-text-secondary);
            font-size: 1.1rem;
        }
        
        .stats-container {
            display: flex;
            justify-content: space-around;
            background: #f8f9fa;
            border-radius: 8px;
            padding: clamp(0.5rem, 2vw, 1rem);
            margin-bottom: 2rem;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--color-secondary);
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: var(--color-text-secondary);
        }
        
        .game-board {
            margin: 2rem 0;
        }
        
        .row {
            display: flex;
            justify-content: center;
            margin-bottom: 5px;
        }
        
        .tile {
            width: clamp(45px, 10vw, 60px);
            height: clamp(45px, 10vw, 60px);
            border: 2px solid #d3d6da;
            margin: 0 clamp(1px, 0.5vw, 2px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(1.2rem, 4vw, 2rem);
            font-weight: bold;
            text-transform: uppercase;
            transition: all 0.3s ease;
            background: white;
            border-radius: 4px;
        }
        
        /* Loading state */
        .game-loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
            color: var(--color-text-secondary);
        }
        
        .loading-spinner {
            border: 3px solid var(--color-border);
            border-top: 3px solid var(--color-secondary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin-right: 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Success animations */
        .tile.success {
            animation: bounce 0.6s ease-in-out;
        }
        
        @keyframes bounce {
            0%, 20%, 60%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            80% {
                transform: translateY(-5px);
            }
        }
        
        /* Improved focus states */
        .tile:focus {
            outline: 2px solid var(--color-secondary);
            outline-offset: 2px;
        }
        
        /* Better contrast for accessibility */
        @media (prefers-contrast: high) {
            .tile.present {
                background: #b8860b;
                border-color: #b8860b;
            }
        }
        
        .tile.filled {
            border-color: #878a8c;
            animation: pop 0.1s ease-in-out;
        }
        
        .tile.correct {
            background: var(--color-secondary);
            border-color: var(--color-secondary);
            color: white;
            animation: flip 0.6s ease-in-out;
        }
        
        .tile.present {
            background: #c9b458;
            border-color: #c9b458;
            color: white;
            animation: flip 0.6s ease-in-out;
        }
        
        .tile.absent {
            background: #787c7e;
            border-color: #787c7e;
            color: white;
            animation: flip 0.6s ease-in-out;
        }
        
        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes flip {
            0% { transform: rotateX(0); }
            50% { transform: rotateX(90deg); }
            100% { transform: rotateX(0); }
        }

        @keyframes slideUp {
            0% {
                transform: translateX(-50%) translateY(100px);
                opacity: 0;
                scale: 0.8;
            }
            100% {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
                scale: 1;
            }
        }

        @keyframes slideDown {
            0% {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
                scale: 1;
            }
            100% {
                transform: translateX(-50%) translateY(100px);
                opacity: 0;
                scale: 0.8;
            }
        }

        /* Koru-inspired decorative elements */
        .cultural-accent::before {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            background: linear-gradient(45deg, var(--color-secondary), var(--color-accent));
            border-radius: 12px;
            z-index: -1;
            opacity: 0.1;
        }

        /* Confetti animation */
        @keyframes confettiFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .definition-popup .cultural-note {
            font-style: italic;
            color: var(--color-secondary);
            background: rgba(184, 134, 11, 0.1);
            padding: 0.5rem;
            border-radius: 4px;
            margin-top: 0.5rem;
        }
        
        .keyboard {
            margin: 2rem 0;
        }
        
        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 8px;
        }
        
        .key {
            background: #d3d6da;
            border: none;
            border-radius: 4px;
            color: var(--color-text);
            cursor: pointer;
            font-size: clamp(12px, 2.5vw, 14px);
            font-weight: bold;
            height: clamp(44px, 8vw, 58px);
            margin: 0 clamp(2px, 0.5vw, 3px);
            min-width: clamp(35px, 7vw, 43px);
            padding: 0;
            text-transform: uppercase;
            transition: background-color 0.1s ease;
            touch-action: manipulation;
            user-select: none;
        }
        
        .key:hover {
            background: #bbb;
            transform: translateY(-1px);
        }
        
        .key:active {
            transform: translateY(0);
            background: #aaa;
        }
        
        .key:focus {
            outline: 2px solid var(--color-secondary);
            outline-offset: 2px;
        }
        
        .key.wide {
            min-width: clamp(55px, 12vw, 65px);
            font-size: clamp(10px, 2vw, 12px);
        }
        
        .key.correct {
            background: var(--color-secondary);
            color: white;
        }
        
        .key.present {
            background: #c9b458;
            color: white;
        }
        
        .key.absent {
            background: #787c7e;
            color: white;
        }
        
        .message {
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
            font-weight: bold;
            text-align: center;
        }
        
        .message.win {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .message.lose {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .message.error {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .message.success {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #b6d4da;
        }
        
        .word-info {
            background: var(--color-cultural-light);
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
            text-align: left;
            display: none;
        }
        
        .buttons {
            margin: 2rem 0;
        }
        
        .btn {
            background: var(--color-secondary);
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            margin: 0 0.5rem;
            padding: 12px 24px;
            transition: background-color 0.2s ease;
        }
        
        .btn:hover {
            background: #2c5f3f;
        }
        
        .btn.secondary {
            background: #6c757d;
        }
        
        .btn.secondary:hover {
            background: #5a6268;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 2rem;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: #000;
        }
        
        .help-section {
            margin: 1rem 0;
            text-align: left;
        }
        
        .example-tile {
            display: inline-flex;
            width: 40px;
            height: 40px;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
            margin-right: 0.5rem;
            border: 2px solid;
            border-radius: 4px;
        }
    </style>
</head>

<body>
    <header class="site-header no-print">
        <div class="nav-container">
            <a href="../index.html" class="nav-brand">
                <span class="brand-logo">üß∫</span>
                <span class="brand-text">
                    <span class="brand-main">Te Kete Ako</span>
                </span>
            </a>
            <nav class="main-nav">
                <ul>
                        <li>
                            <a href="../browse.html">
                                <span class="nav-icon">üìö</span>
                                <span class="nav-text-mi" lang="mi">NgƒÅ Rauemi</span>
                                <span class="nav-text-en">Resources</span>
                            </a>
                        <div class="nav-dropdown">
                            <ul>
                                <li><a href="../unit-plans.html"><span class="dropdown-mi">üìö NgƒÅ Mahere WƒÅhanga</span><span class="dropdown-en">Unit Plans (6-8 weeks)</span></a></li>
                                <li><a href="../lessons.html"><span class="dropdown-mi">üìñ NgƒÅ Mahere Akoranga</span><span class="dropdown-en">Lesson Plans (60-75 min)</span></a></li>
                                <li><a href="../handouts.html"><span class="dropdown-mi">üìÑ NgƒÅ Kape</span><span class="dropdown-en">Handouts & Materials</span></a></li>
                                <li><a href="../browse.html"><span class="dropdown-mi">üîç Tirohia Katoa</span><span class="dropdown-en">Browse All Resources</span></a></li>
                            </ul>
                        </div>
                    </li>
                        <li>
                            <a href="browse.html?filter=subject">
                                <span class="nav-icon">üé®</span>
                                <span class="nav-text-mi" lang="mi">NgƒÅ Marau</span>
                                <span class="nav-text-en">Subjects</span>
                            </a>
                        <div class="nav-dropdown">
                            <ul>
                                <li><a href="browse.html?subject=english"><span class="dropdown-mi">üìù Reo PƒÅkehƒÅ</span><span class="dropdown-en">English</span></a></li>
                                <li><a href="browse.html?subject=math"><span class="dropdown-mi">üî¢ PƒÅngarau</span><span class="dropdown-en">Mathematics</span></a></li>
                                <li><a href="browse.html?subject=science"><span class="dropdown-mi">üî¨ P≈´taiao</span><span class="dropdown-en">Science</span></a></li>
                                <li><a href="browse.html?subject=social-studies"><span class="dropdown-mi">üåè Tikanga-ƒÅ-Iwi</span><span class="dropdown-en">Social Studies</span></a></li>
                                <li><a href="browse.html?subject=te-reo"><span class="dropdown-mi">üåø Te Reo MƒÅori</span><span class="dropdown-en">MƒÅori Language</span></a></li>
                                <li><a href="browse.html?subject=arts"><span class="dropdown-mi">üé® NgƒÅ Toi</span><span class="dropdown-en">The Arts</span></a></li>
                                <li><a href="browse.html?subject=health-pe"><span class="dropdown-mi">üí™ Hauora</span><span class="dropdown-en">Health & PE</span></a></li>
                                <li><a href="browse.html?subject=technology"><span class="dropdown-mi">üîß Hangarau</span><span class="dropdown-en">Technology</span></a></li>
                            </ul>
                        </div>
                    </li>
                        <li>
                            <a href="browse.html?filter=year">
                                <span class="nav-icon">üìÖ</span>
                                <span class="nav-text-mi" lang="mi">NgƒÅ Tau</span>
                                <span class="nav-text-en">Year Levels</span>
                            </a>
                            <div class="nav-dropdown nav-dropdown-wide">
                                <div class="year-stage-label">Primary / Tuatahi (1-6)</div>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=1"><span class="dropdown-mi">Tau 1</span><span class="dropdown-en">Year 1</span></a></li>
                                    <li><a href="browse.html?year=2"><span class="dropdown-mi">Tau 2</span><span class="dropdown-en">Year 2</span></a></li>
                                    <li><a href="browse.html?year=3"><span class="dropdown-mi">Tau 3</span><span class="dropdown-en">Year 3</span></a></li>
                                </ul>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=4"><span class="dropdown-mi">Tau 4</span><span class="dropdown-en">Year 4</span></a></li>
                                    <li><a href="browse.html?year=5"><span class="dropdown-mi">Tau 5</span><span class="dropdown-en">Year 5</span></a></li>
                                    <li><a href="browse.html?year=6"><span class="dropdown-mi">Tau 6</span><span class="dropdown-en">Year 6</span></a></li>
                                </ul>
                                <div class="year-stage-label">Intermediate / Waenga (7-8)</div>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=7"><span class="dropdown-mi">Tau 7</span><span class="dropdown-en">Year 7</span></a></li>
                                    <li><a href="browse.html?year=8"><span class="dropdown-mi">Tau 8</span><span class="dropdown-en">Year 8</span></a></li>
                                </ul>
                                <div class="year-stage-label">Junior Secondary / Tuarua (9-10)</div>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=9"><span class="dropdown-mi">Tau 9</span><span class="dropdown-en">Year 9</span></a></li>
                                    <li><a href="browse.html?year=10"><span class="dropdown-mi">Tau 10</span><span class="dropdown-en">Year 10</span></a></li>
                                </ul>
                                <div class="year-stage-label">Senior Secondary / NCEA (11-13)</div>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=11"><span class="dropdown-mi">Tau 11</span><span class="dropdown-en">Year 11</span></a></li>
                                    <li><a href="browse.html?year=12"><span class="dropdown-mi">Tau 12</span><span class="dropdown-en">Year 12</span></a></li>
                                    <li><a href="browse.html?year=13"><span class="dropdown-mi">Tau 13</span><span class="dropdown-en">Year 13</span></a></li>
                                </ul>
                            </div>
                        </li>
                    <li>
                        <a href="#more">
                            <span class="nav-icon">üì¶</span>
                            <span class="nav-text-mi" lang="mi">ƒítahi Atu</span>
                            <span class="nav-text-en">More Stuff</span>
                        </a>
                        <div class="nav-dropdown">
                            <ul>
                                <li><a href="../games.html"><span class="dropdown-mi">üéÆ NgƒÅ Kƒìmu</span><span class="dropdown-en">Games</span></a></li>
                                <li><a href="../youtube.html"><span class="dropdown-mi">üì∫ Ataata YouTube</span><span class="dropdown-en">YouTube Videos</span></a></li>
                                <li><a href="../curriculum-alignment.html"><span class="dropdown-mi">üìã Te Marautanga</span><span class="dropdown-en">Curriculum Alignment</span></a></li>
                                <li><a href="../other-resources.html"><span class="dropdown-mi">üîó ƒítahi Atu Rauemi</span><span class="dropdown-en">Other Resources</span></a></li>
                            </ul>
                        </div>
                    </li>
                    <li class="auth-nav auth-logged-out">
                        <a href="../login.html" class="auth-btn">
                            <span class="nav-icon" data-icon="login"></span>
                            <span class="nav-text-mi" lang="mi">Takiuru</span>
                            <span class="nav-text-en">Login</span>
                        </a>
                    </li>
                    <li class="auth-nav auth-logged-in" style="display: none;">
                        <a href="../my-kete.html" class="dashboard-btn">
                            <span class="nav-icon" data-icon="kete"></span>
                            <span class="nav-text-mi" lang="mi">T≈çku Kete</span>
                            <span class="nav-text-en">My Kete</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="main-container">
        <aside class="left-sidebar no-print">
            <div class="sidebar-widget">
                <h3 class="sidebar-widget-title">Game Navigation</h3>
                <ul>
                    <li><a href="../games.html">‚Üê Back to All Games</a></li>
                    <li><a href="te-reo-wordle-6.html">Play 6-Letter Wordle</a></li>
                    <li><a href="#" onclick="showHelp()">How to Play</a></li>
                    <li><a href="#" onclick="newGame()">New Game</a></li>
                </ul>
            </div>

            <div class="sidebar-widget cultural-accent">
                <h3 class="sidebar-widget-title">Whakataukƒ´</h3>
                <p style="font-style: italic; color: var(--color-secondary);">"K≈çrero MƒÅori"</p>
                <p style="font-size: 0.9rem;">Speak MƒÅori - every word learned is a step forward</p>
            </div>

            <div class="sidebar-widget">
                <h3 class="sidebar-widget-title">Learning Tips</h3>
                <ul style="font-size: 0.9rem;">
                    <li>Think about common MƒÅori vowels: A, E, I, O, U</li>
                    <li>No silent letters in Te Reo MƒÅori</li>
                    <li>Common endings: -NG, -RA, -GA, -TA</li>
                    <li>Think of everyday MƒÅori words you know</li>
                </ul>
            </div>
        </aside>

        <main class="content-area">
            <div class="game-container">
                <div class="game-header">
                    <h1 class="game-title">Te Reo MƒÅori Wordle</h1>
                    <p class="game-subtitle">Guess the Te Reo MƒÅori word in 6 tries</p>
                </div>

                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-number" id="played">0</div>
                        <div class="stat-label">Played</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="winPercentage">0</div>
                        <div class="stat-label">Win %</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="currentStreak">0</div>
                        <div class="stat-label">Current Streak</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="maxStreak">0</div>
                        <div class="stat-label">Max Streak</div>
                    </div>
                </div>

                <div id="message"></div>

                <div class="game-board" id="gameBoard" role="grid" aria-label="Te Reo MƒÅori Wordle Game Board">
                    <!-- Board will be generated by JavaScript -->
                    <div class="game-loading">
                        <div class="loading-spinner"></div>
                        <p>Loading Te Reo MƒÅori Wordle...</p>
                    </div>
                </div>

                <div class="keyboard" id="keyboard" role="group" aria-label="Virtual Keyboard">
                    <!-- Keyboard will be generated by JavaScript -->
                </div>

                <div id="wordInfo" class="word-info">
                    <h3>About Today's Word - K≈çrero m≈ç te Kupu o te RƒÅ</h3>
                    <p><strong>Word / Kupu:</strong> <span id="wordDisplay"></span></p>
                    <p><strong>Category / R≈çp≈´:</strong> <span id="categoryDisplay"></span></p>
                    <p><strong>Meaning / Tikanga:</strong> <span id="meaningDisplay"></span></p>
                    <p><strong>Example / Tauira:</strong> <span id="exampleDisplay"></span></p>
                    <div class="cultural-note" style="margin-top: 1rem; padding: 1rem; background: rgba(184, 134, 11, 0.1); border-radius: 6px; border-left: 4px solid var(--color-secondary);">
                        <p style="margin: 0; font-style: italic; color: var(--color-secondary);">
                            <strong>Cultural Note:</strong> Every Te Reo MƒÅori word carries deeper cultural meaning and connects to the rich history and worldview of MƒÅori people.
                        </p>
                    </div>
                </div>

                <div class="buttons">
                    <button class="btn secondary" onclick="showHelp()">How to Play</button>
                    <button class="btn" onclick="newGame()">New Game</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeHelp()">&times;</span>
            <h2>How to Play Te Reo MƒÅori Wordle</h2>
            
            <div class="help-section">
                <h3>Goal</h3>
                <p>Guess the hidden 5-letter Te Reo MƒÅori word in 6 tries or fewer.</p>
            </div>
            
            <div class="help-section">
                <h3>How to Play</h3>
                <ul>
                    <li>Type a 5-letter word and press Enter</li>
                    <li>After each guess, the color of the tiles will change</li>
                    <li>You have 6 attempts to guess correctly</li>
                </ul>
            </div>
            
            <div class="help-section">
                <h3>Color Meanings</h3>
                <p>
                    <span class="example-tile correct">K</span>
                    <strong>Green:</strong> Letter is correct and in the right position
                </p>
                <p>
                    <span class="example-tile present">I</span>
                    <strong>Yellow:</strong> Letter is in the word but in wrong position
                </p>
                <p>
                    <span class="example-tile absent">A</span>
                    <strong>Gray:</strong> Letter is not in the word
                </p>
            </div>
            
            <div class="help-section">
                <h3>Te Reo MƒÅori Tips</h3>
                <ul>
                    <li>All letters are pronounced - no silent letters!</li>
                    <li>Vowels: A (ah), E (eh), I (ee), O (oh), U (oo)</li>
                    <li>Common patterns: NG, WH, combinations with vowels</li>
                    <li>Think of MƒÅori words you already know</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Achievement Feedback Container -->
    <div id="achievement-feedback" class="achievement-feedback"></div>
    
    <!-- Game Achievements Widget -->
    <div class="game-achievements-widget" id="achievements-widget">
        <h4>Your Progress</h4>
        <div class="quick-stats" id="quick-stats">
            <div class="quick-stat">
                <span class="quick-stat-number" id="games-played">0</span>
                <div class="quick-stat-label">Games Played</div>
            </div>
            <div class="quick-stat">
                <span class="quick-stat-number" id="total-score">0</span>
                <div class="quick-stat-label">Total Score</div>
            </div>
            <div class="quick-stat">
                <span class="quick-stat-number" id="current-streak">0</span>
                <div class="quick-stat-label">Day Streak</div>
            </div>
            <div class="quick-stat">
                <span class="quick-stat-number" id="cultural-level">Tamaiti</span>
                <div class="quick-stat-label">Cultural Level</div>
            </div>
        </div>
        <div class="recent-achievements" id="recent-achievements">
            <!-- Recent achievements will be shown here -->
        </div>
    </div>

    <footer class="site-footer no-print">
        <div class="footer-content">
            <div class="footer-grid">
                <!-- Brand Section -->
                <div class="footer-section footer-brand">
                    <h3>üß∫ Te Kete Ako</h3>
                    <p class="footer-whakataukƒ´">"Whaowhia te kete mƒÅtauranga"</p>
                    <p class="footer-tagline">Fill the basket of knowledge</p>
                    <p class="footer-description">Quality teaching resources for Aotearoa New Zealand educators, honoring mƒÅtauranga MƒÅori and contemporary pedagogy.</p>
                </div>

                <!-- Resources Section -->
                <div class="footer-section footer-resources">
                    <h4><span class="footer-mi">NgƒÅ Rauemi</span> <span class="footer-en">Resources</span></h4>
                    <ul>
                        <li><a href="../unit-plans.html">üìö Unit Plans / NgƒÅ Mahere WƒÅhanga</a></li>
                        <li><a href="../lessons.html">üìñ Lesson Plans / NgƒÅ Akoranga</a></li>
                        <li><a href="../handouts.html">üìÑ Handouts / NgƒÅ Kape</a></li>
                        <li><a href="../games.html">üéÆ Games / NgƒÅ Kƒìmu</a></li>
                        <li><a href="../browse.html">üîç Browse All / Tirohia Katoa</a></li>
                    </ul>
                </div>

                <!-- Curriculum Section -->
                <div class="footer-section footer-curriculum">
                    <h4><span class="footer-mi">Te Marautanga</span> <span class="footer-en">Curriculum</span></h4>
                    <ul>
                        <li><a href="browse.html?subject=english">üìù English / Reo PƒÅkehƒÅ</a></li>
                        <li><a href="browse.html?subject=math">üî¢ Mathematics / PƒÅngarau</a></li>
                        <li><a href="browse.html?subject=science">üî¨ Science / P≈´taiao</a></li>
                        <li><a href="browse.html?subject=social-studies">üåè Social Studies / Tikanga-ƒÅ-Iwi</a></li>
                        <li><a href="../curriculum-alignment.html">üìã NZ Curriculum Alignment</a></li>
                    </ul>
                </div>

                <!-- Account & Support Section -->
                <div class="footer-section footer-support">
                    <h4><span class="footer-mi">Tautoko</span> <span class="footer-en">Support</span></h4>
                    <ul>
                        <li><a href="../my-kete.html">üß∫ My Kete / T≈çku Kete</a></li>
                        <li><a href="../login.html">üîê Login / Takiuru</a></li>
                        <li><a href="#about">‚ÑπÔ∏è About Us / M≈ç MƒÅtou</a></li>
                        <li><a href="#contact">‚úâÔ∏è Contact / WhakapƒÅ Mai</a></li>
                        <li><a href="#help">‚ùì Help / ƒÄwhina</a></li>
                    </ul>
                </div>
            </div>

            <!-- Footer Bottom -->
            <div class="footer-bottom">
                <div class="footer-bottom-content">
                    <span class="footer-copyright">¬© 2025 Te Kete Ako</span>
                    <span class="footer-separator">‚Ä¢</span>
                    <span class="footer-location">Aotearoa New Zealand</span>
                    <span class="footer-separator">‚Ä¢</span>
                    <a href="#privacy">Privacy</a>
                    <span class="footer-separator">‚Ä¢</span>
                    <a href="#terms">Terms</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="../js/maori-dictionary-api.js"></script>
    <script src="../js/gamification-system.js"></script>
    <script src="../js/adaptive-difficulty-system.js"></script>
    <script>
        // Te Reo MƒÅori word database with meanings and cultural context
        const MAORI_WORDS = [
            // Basic vocabulary - everyday words
            { word: 'AROHA', meaning: 'Love, compassion, empathy', example: 'Aroha atu ki a koe - Love to you', category: 'emotions' },
            { word: 'WHARE', meaning: 'House, building, home', example: 'Kei te whare au - I am at home', category: 'places' },
            { word: 'MAURI', meaning: 'Life force, vital essence', example: 'Kia mauri ora - Be well, be healthy', category: 'spiritual' },
            { word: 'TAIAO', meaning: 'Environment, natural world', example: 'Tiaki i te taiao - Care for the environment', category: 'nature' },
            { word: 'KAIAKO', meaning: 'Teacher, educator', example: 'He kaiako pai ia - They are a good teacher', category: 'people' },
            { word: 'RANGI', meaning: 'Sky, heaven, day', example: 'He rangi ataahua - A beautiful day', category: 'nature' },
            { word: 'MOANA', meaning: 'Ocean, sea, large lake', example: 'Kei te moana mƒÅtou - We are at the ocean', category: 'nature' },
            { word: 'MANA', meaning: 'Power, authority, prestige', example: 'He mana t≈ç - You have power/authority', category: 'spiritual' },
            { word: 'TAONGA', meaning: 'Treasure, precious thing', example: 'He taonga tƒìnei - This is a treasure', category: 'cultural' },
            { word: 'WAIRUA', meaning: 'Spirit, soul', example: 'He wairua pai - A good spirit', category: 'spiritual' },
            
            // Family and relationships - whƒÅnau
            { word: 'MATUA', meaning: 'Parent, father, elder', example: 'Ko taku matua - My father', category: 'whanau' },
            { word: 'WHAEA', meaning: 'Mother, aunt, female elder', example: 'Ko taku whaea - My mother', category: 'whanau' },
            { word: 'WHANAU', meaning: 'Family, extended family group', example: 'Ko taku whƒÅnau - My family', category: 'whanau' },
            
            // Cultural concepts - tikanga
            { word: 'HONGI', meaning: 'Traditional greeting - touching noses', example: 'Hongi mai - Come and hongi', category: 'cultural' },
            { word: 'HANGI', meaning: 'Earth oven, traditional cooking method', example: 'Hangi kai - Earth oven food', category: 'cultural' },
            
            // Nature and environment - taiao
            { word: 'WHENUA', meaning: 'Land, country, birth place', example: 'Taku whenua - My land', category: 'nature' },
            { word: 'KOWHAI', meaning: 'Golden native tree', example: 'He rƒÅkau k≈çwhai - A kowhai tree', category: 'nature' },
            { word: 'KAURI', meaning: 'Native tree species', example: 'He kauri rƒÅkau - A kauri tree', category: 'nature' },
            { word: 'MAUNGA', meaning: 'Mountain', example: 'Te maunga - The mountain', category: 'nature' },
            
            // Actions and movement - mahi
            { word: 'HAERE', meaning: 'Go, come, travel', example: 'Haere mai - Come here', category: 'actions' },
            { word: 'NOHO', meaning: 'Sit, stay, remain', example: 'Noho mai - Stay here', category: 'actions' },
            { word: 'TITIRO', meaning: 'Look, watch', example: 'Titiro mai - Look here', category: 'actions' },
            
            // Time and seasons - taima
            
            // Colors - nga tae
            { word: 'WHERO', meaning: 'Red', example: 'He whero - Red', category: 'colors' },
            { word: 'MANGU', meaning: 'Black', example: 'He mangu - Black', category: 'colors' },
            
            // Food - kai
            { word: 'PIPI', meaning: 'Small shellfish', example: 'NgƒÅ pipi - The pipi', category: 'food' },
            { word: 'KINA', meaning: 'Sea urchin', example: 'He kina - Sea urchin', category: 'food' }
        ];

        // Comprehensive list of valid 5-letter MƒÅori words for guess validation
        const VALID_MAORI_WORDS = [
            // From the main word list
            'AROHA', 'WHARE', 'MAURI', 'TAIAO', 'RANGI', 'MOANA', 'MANA', 'WAIRUA',
            'MATUA', 'WHAEA', 'HONGI', 'HANGI', 'KAURI', 'HAERE', 'NOHO', 'WHERO',
            'MANGU', 'KINA', 'PIPI',
            
            // Additional common 5-letter words
            'MARAE', 'MAORI', 'NGATI', 'HAPUU', 'RONGO', 'REHUA', 'RAKAU', 'POAKA',
            'HUNGA', 'KAWE', 'AWHI', 'KATA', 'KETE', 'KORU', 'RATA', 'RIMU',
            'TANE', 'HINE', 'PAPA', 'NUKU', 'RAUA', 'MAHI', 'HORA', 'RAHI',
            'PAUA', 'TUNA', 'MAKO', 'HOKI', 'TAPU', 'NOKO',
            'KURU', 'PURE', 'PARA', 'KAHA', 'KINO', 'NGARO', 'RURU', 'KIWI', 
            'TITI', 'KAKA', 'HUHU', 'WETA', 'PEPE', 'TERA', 'TENEI', 'KOIA', 
            'RANEI', 'PUKU', 'MATA', 'RINGA', 'WAHA', 'HOPE', 'MOKO',
            'KEKE', 'KOPE', 'KETE', 'MIRO', 'TARO', 'KONO', 'KURA', 'HAKA'
        ];

        // Function to normalize MƒÅori text (handle macrons)
        function normalizeMaoriText(text) {
            if (!text) return '';
            return text.toUpperCase()
                .replace(/ƒÄ/g, 'A')
                .replace(/ƒí/g, 'E')
                .replace(/ƒ™/g, 'I')
                .replace(/≈å/g, 'O')
                .replace(/≈™/g, 'U');
        }

        // Function to validate if a word is a legitimate MƒÅori word using the dictionary API
        async function isValidMaoriWord(word) {
            if (!window.maoriDictionaryAPI) {
                console.warn('MƒÅori Dictionary API not loaded, using fallback validation');
                const normalizedWord = normalizeMaoriText(word);
                const normalizedValidWords = VALID_MAORI_WORDS.map(w => normalizeMaoriText(w));
                return normalizedValidWords.includes(normalizedWord);
            }
            
            return await window.maoriDictionaryAPI.validateMaoriWord(word);
        }

        // Game state
        let currentWord = {};
        let currentGuess = '';
        let currentRow = 0;
        let gameOver = false;
        let gameWon = false;
        let guesses = [];

        // Statistics
        let stats = {
            played: 0,
            won: 0,
            currentStreak: 0,
            maxStreak: 0
        };

        // Initialize game
        function initGame() {
            console.log('üéÆ Initializing Te Reo MƒÅori Wordle...');
            
            try {
                loadStats();
                console.log('üìä Stats loaded');
                
                selectDailyWord();
                console.log('üìù Daily word selected:', currentWord.word);
                
                createBoard();
                console.log('üéØ Game board created');
                
                createKeyboard();
                console.log('‚å®Ô∏è Virtual keyboard created');
                
                updateStats();
                console.log('üìà Stats display updated');
                
                // Add keyboard event listeners
                document.addEventListener('keydown', handleKeyPress);
                console.log('‚úÖ Te Reo MƒÅori Wordle fully initialized');
                
                // Remove any loading indicator
                const loadingElement = document.querySelector('.game-loading');
                if (loadingElement) {
                    loadingElement.style.display = 'none';
                }
                
            } catch (error) {
                console.error('‚ùå Error initializing Te Reo MƒÅori Wordle:', error);
                showMessage('Error loading game. Please refresh the page.', 'error');
            }
        }

        // Select word based on NZ date for consistency (UTC+12/+13)
        function selectDailyWord() {
            // Get current time in New Zealand timezone
            const now = new Date();
            const nzTime = new Date(now.toLocaleString("en-US", {timeZone: "Pacific/Auckland"}));
            const seed = nzTime.getFullYear() * 1000 + nzTime.getMonth() * 100 + nzTime.getDate();
            
            // Use dictionary API for word selection if available
            if (window.maoriDictionaryAPI) {
                const dictionaryWords = window.maoriDictionaryAPI.getValidMaoriWords(5);
                if (dictionaryWords.length > 0) {
                    const index = seed % dictionaryWords.length;
                    const selectedWord = dictionaryWords[index];
                    const definition = window.maoriDictionaryAPI.fallbackDictionary[selectedWord];
                    if (definition) {
                        currentWord = {
                            word: definition.word,
                            meaning: definition.meaning,
                            example: definition.example,
                            category: definition.category
                        };
                        return;
                    }
                }
            }
            
            // Fallback to local word list
            const index = seed % MAORI_WORDS.length;
            currentWord = MAORI_WORDS[index];
        }

        // Create game board
        function createBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';
            
            for (let i = 0; i < 6; i++) {
                const row = document.createElement('div');
                row.className = 'row';
                row.setAttribute('role', 'row');
                row.setAttribute('aria-label', `Guess row ${i + 1}`);
                
                for (let j = 0; j < 5; j++) {
                    const tile = document.createElement('div');
                    tile.className = 'tile';
                    tile.id = `tile-${i}-${j}`;
                    tile.setAttribute('role', 'gridcell');
                    tile.setAttribute('aria-label', `Letter ${j + 1}, row ${i + 1}`);
                    tile.setAttribute('tabindex', '-1');
                    row.appendChild(tile);
                }
                
                board.appendChild(row);
            }
        }

        // Create keyboard
        function createKeyboard() {
            const keyboard = document.getElementById('keyboard');
            const rows = [
                ['Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P'],
                ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L'],
                ['ENTER', 'Z', 'X', 'C', 'V', 'B', 'N', 'M', 'BACKSPACE']
            ];
            
            keyboard.innerHTML = '';
            
            rows.forEach(row => {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'keyboard-row';
                
                row.forEach(key => {
                    const keyButton = document.createElement('button');
                    keyButton.className = key.length > 1 ? 'key wide' : 'key';
                    keyButton.textContent = key === 'BACKSPACE' ? '‚å´' : key;
                    keyButton.onclick = () => handleKeyClick(key);
                    keyButton.id = `key-${key}`;
                    keyButton.setAttribute('aria-label', 
                        key === 'ENTER' ? 'Submit guess' :
                        key === 'BACKSPACE' ? 'Delete letter' :
                        `Letter ${key}`
                    );
                    keyButton.setAttribute('type', 'button');
                    rowDiv.appendChild(keyButton);
                });
                
                keyboard.appendChild(rowDiv);
            });
        }

        // Handle key press
        function handleKeyPress(event) {
            if (gameOver) return;
            
            const key = event.key.toUpperCase();
            
            if (key === 'ENTER') {
                submitGuess();
            } else if (key === 'BACKSPACE') {
                deleteLetter();
            } else if (key.match(/[A-Z]/) && key.length === 1) {
                addLetter(key);
            }
        }

        // Handle key click
        function handleKeyClick(key) {
            if (gameOver) return;
            
            if (key === 'ENTER') {
                submitGuess();
            } else if (key === 'BACKSPACE') {
                deleteLetter();
            } else {
                addLetter(key);
            }
        }

        // Add letter to current guess
        function addLetter(letter) {
            if (currentGuess.length < 5) {
                // Remove any existing definition popup when user starts typing new word
                if (window.currentDefinitionPopup && window.currentDefinitionPopup.parentNode) {
                    window.currentDefinitionPopup.style.animation = 'slideDown 0.3s ease-in';
                    setTimeout(() => window.currentDefinitionPopup.remove(), 300);
                    window.currentDefinitionPopup = null;
                }
                
                currentGuess += letter;
                updateDisplay();
            }
        }

        // Delete letter from current guess
        function deleteLetter() {
            if (currentGuess.length > 0) {
                currentGuess = currentGuess.slice(0, -1);
                updateDisplay();
            }
        }

        // Update display
        function updateDisplay() {
            for (let i = 0; i < 5; i++) {
                const tile = document.getElementById(`tile-${currentRow}-${i}`);
                if (i < currentGuess.length) {
                    tile.textContent = currentGuess[i];
                    tile.classList.add('filled');
                } else {
                    tile.textContent = '';
                    tile.classList.remove('filled');
                }
            }
        }

        // Submit guess
        async function submitGuess() {
            if (currentGuess.length !== 5) {
                showMessage('Word must be 5 letters long!', 'error');
                return;
            }
            
            // Show loading message while validating
            showMessage('Checking word...', 'success');
            
            // Validate that the guess is a legitimate MƒÅori word
            const isValid = await isValidMaoriWord(currentGuess);
            if (!isValid) {
                showMessage(
                    `"${currentGuess}" is not a recognized Te Reo MƒÅori word. Try common MƒÅori words like AROHA, WHARE, or MOANA.`, 
                    'error'
                );
                return;
            }
            
            // Show definition popup for the guessed word
            await showGuessDefinition(currentGuess);
            
            checkGuess();
            guesses.push(currentGuess);
            
            if (normalizeMaoriText(currentGuess) === normalizeMaoriText(currentWord.word)) {
                gameWon = true;
                gameOver = true;
                const celebrations = [
                    'Ka rawe! You found the word! üéâ',
                    'Tino pai! Fantastic work! ‚ú®', 
                    'Kia kaha! You\'re learning Te Reo MƒÅori! üåü',
                    'He mea nui tƒìnei! This is amazing! üèÜ'
                ];
                const randomCelebration = celebrations[Math.floor(Math.random() * celebrations.length)];
                showMessage(randomCelebration, 'win');
                showWordInfo();
                updateStatsAfterGame(true);
                reportGameToGamificationSystem(true);
            } else if (currentRow === 5) {
                gameOver = true;
                showMessage(`Ka pai te whakamƒÅtau! The word was: ${currentWord.word} / Good try! The word was: ${currentWord.word}`, 'lose');
                showWordInfo();
                updateStatsAfterGame(false);
                reportGameToGamificationSystem(false);
            } else {
                currentRow++;
                currentGuess = '';
                showMessage('Ka pai! That\'s a valid Te Reo MƒÅori word. Keep trying!', 'success');
                setTimeout(() => {
                    document.getElementById('message').innerHTML = '';
                }, 2000);
            }
        }

        // Check guess and update colors
        function checkGuess() {
            const guess = currentGuess;
            const word = currentWord.word;
            const result = new Array(5).fill('absent');
            const wordLetters = word.split('');
            const guessLetters = guess.split('');
            
            // First pass: check for correct positions
            for (let i = 0; i < 5; i++) {
                if (guessLetters[i] === wordLetters[i]) {
                    result[i] = 'correct';
                    wordLetters[i] = null; // Mark as used
                    guessLetters[i] = null; // Mark as used
                }
            }
            
            // Second pass: check for present letters
            for (let i = 0; i < 5; i++) {
                if (guessLetters[i] !== null) {
                    const letterIndex = wordLetters.indexOf(guessLetters[i]);
                    if (letterIndex !== -1) {
                        result[i] = 'present';
                        wordLetters[letterIndex] = null; // Mark as used
                    }
                }
            }
            
            // Apply colors to tiles
            for (let i = 0; i < 5; i++) {
                const tile = document.getElementById(`tile-${currentRow}-${i}`);
                tile.classList.add(result[i]);
                
                // Update keyboard
                const key = document.getElementById(`key-${guess[i]}`);
                if (key) {
                    if (result[i] === 'correct') {
                        key.classList.remove('present', 'absent');
                        key.classList.add('correct');
                    } else if (result[i] === 'present' && !key.classList.contains('correct')) {
                        key.classList.remove('absent');
                        key.classList.add('present');
                    } else if (result[i] === 'absent' && !key.classList.contains('correct') && !key.classList.contains('present')) {
                        key.classList.add('absent');
                    }
                }
            }
        }

        // Show message
        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.innerHTML = `<div class="message ${type}" role="alert" aria-live="polite">${text}</div>`;
            
            // Announce to screen readers
            if (type === 'win') {
                messageDiv.setAttribute('aria-live', 'assertive');
            }
            
            if (type === 'error') {
                setTimeout(() => {
                    messageDiv.innerHTML = '';
                }, 3000);
            }
        }

        // Show word information
        function showWordInfo() {
            document.getElementById('wordDisplay').textContent = currentWord.word;
            document.getElementById('categoryDisplay').textContent = getCategoryName(currentWord.category);
            document.getElementById('meaningDisplay').textContent = currentWord.meaning;
            document.getElementById('exampleDisplay').textContent = currentWord.example;
            
            // Add pronunciation button to word info
            const wordDisplay = document.getElementById('wordDisplay');
            wordDisplay.innerHTML = `
                <span style="font-size: 1.5rem; font-weight: bold; color: var(--color-primary);">${currentWord.word}</span>
                <button onclick="speakMaoriWord('${currentWord.word}', '${window.maoriDictionaryAPI.fallbackDictionary[currentWord.word]?.pronunciation || ''}')" 
                        style="margin-left: 1rem; background: var(--color-secondary); color: white; border: none; border-radius: 20px; padding: 0.5rem 1rem; cursor: pointer;"
                        title="Listen to pronunciation">
                    üîä Whakarongo
                </button>
            `;
            
            document.getElementById('wordInfo').style.display = 'block';
            
            // Celebrate with confetti effect
            createConfettiEffect();
        }
        
        function createConfettiEffect() {
            // Simple confetti effect for celebrations
            const colors = ['#B8860B', '#40E0D0', '#2C5F41', '#FFD700'];
            const confettiCount = 50;
            
            for (let i = 0; i < confettiCount; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.style.cssText = `
                        position: fixed;
                        top: 0;
                        left: ${Math.random() * 100}%;
                        width: 10px;
                        height: 10px;
                        background: ${colors[Math.floor(Math.random() * colors.length)]};
                        border-radius: 50%;
                        pointer-events: none;
                        z-index: 9999;
                        animation: confettiFall ${2 + Math.random() * 3}s linear forwards;
                    `;
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 5000);
                }, i * 50);
            }
        }

        // Enhanced pronunciation function with Web Speech API
        function speakMaoriWord(word, pronunciation) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = 'mi-NZ'; // MƒÅori language code
                utterance.rate = 0.8; // Slower for learning
                utterance.pitch = 1.0;
                
                // If no MƒÅori voice available, use English with slower rate
                const voices = speechSynthesis.getVoices();
                const maoriVoice = voices.find(voice => voice.lang.includes('mi'));
                if (maoriVoice) {
                    utterance.voice = maoriVoice;
                } else {
                    utterance.lang = 'en-NZ';
                    utterance.rate = 0.6; // Even slower for pronunciation guide
                }
                
                speechSynthesis.speak(utterance);
            }
        }

        // Show definition popup for guessed words with enhanced features
        async function showGuessDefinition(word) {
            if (!window.maoriDictionaryAPI) return;
            
            const definition = await window.maoriDictionaryAPI.getWordDefinition(word);
            if (definition) {
                // Create enhanced definition popup
                const popup = document.createElement('div');
                popup.className = 'definition-popup';
                popup.innerHTML = `
                    <div class="definition-content">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                            <h4 style="margin: 0; color: var(--color-primary); font-size: 1.3rem;">${definition.word}</h4>
                            <button onclick="speakMaoriWord('${definition.word}', '${definition.pronunciation || ''}')" 
                                    style="background: var(--color-secondary); color: white; border: none; border-radius: 20px; padding: 0.3rem 0.8rem; cursor: pointer; font-size: 0.8rem;"
                                    title="Listen to pronunciation">
                                üîä Whakarongo
                            </button>
                        </div>
                        <p><strong>Meaning / Tikanga:</strong> ${definition.meaning}</p>
                        ${definition.pronunciation ? `<p><strong>Pronunciation / Whakahua:</strong> <span style="font-style: italic; color: var(--color-secondary);">${definition.pronunciation}</span></p>` : ''}
                        ${definition.example ? `<p><strong>Example / Tauira:</strong> <em>${definition.example}</em></p>` : ''}
                        ${definition.culturalNote ? `<div class="cultural-note"><strong>üåü Cultural Insight:</strong> ${definition.culturalNote}</div>` : ''}
                        <div style="margin-top: 1rem; text-align: center;">
                            <small style="color: var(--color-text-secondary); font-style: italic;">Ka rawe! You're learning Te Reo MƒÅori!</small>
                        </div>
                    </div>
                `;
                
                // Enhanced styling with cultural elements
                popup.style.cssText = `
                    position: fixed;
                    bottom: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: linear-gradient(135deg, var(--color-cultural-light) 0%, rgba(255,255,255,0.95) 100%);
                    border: 3px solid var(--color-secondary);
                    border-radius: 12px;
                    padding: 1.5rem;
                    max-width: 450px;
                    z-index: 1000;
                    box-shadow: 0 8px 25px rgba(0,0,0,0.2), 0 0 0 1px rgba(184,134,11,0.1);
                    animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                    backdrop-filter: blur(5px);
                `;
                
                document.body.appendChild(popup);
                
                // Store reference to current popup so it can be removed when next word starts
                window.currentDefinitionPopup = popup;
                
                // Click to dismiss
                popup.onclick = () => {
                    popup.style.animation = 'slideDown 0.3s ease-in';
                    setTimeout(() => popup.remove(), 300);
                };
            }
        }

        // Get friendly category name
        function getCategoryName(category) {
            const categoryMap = {
                'emotions': 'Emotions / Kare-ƒÅ-roto',
                'places': 'Places / NgƒÅ WƒÅhi',
                'spiritual': 'Spiritual / Whakapono',
                'nature': 'Nature / Taiao',
                'people': 'People / Tangata',
                'cultural': 'Cultural / Ahurea',
                'whanau': 'Family / WhƒÅnau',
                'actions': 'Actions / Mahi',
                'time': 'Time / Taima',
                'colors': 'Colors / NgƒÅ Tae',
                'food': 'Food / Kai'
            };
            return categoryMap[category] || category;
        }

        // Load statistics
        function loadStats() {
            const saved = localStorage.getItem('te-reo-wordle-stats');
            if (saved) {
                stats = JSON.parse(saved);
            }
        }

        // Save statistics
        function saveStats() {
            localStorage.setItem('te-reo-wordle-stats', JSON.stringify(stats));
        }

        // Update statistics display
        function updateStats() {
            document.getElementById('played').textContent = stats.played;
            document.getElementById('winPercentage').textContent = 
                stats.played > 0 ? Math.round((stats.won / stats.played) * 100) : 0;
            document.getElementById('currentStreak').textContent = stats.currentStreak;
            document.getElementById('maxStreak').textContent = stats.maxStreak;
        }

        // Update statistics after game
        function updateStatsAfterGame(won) {
            stats.played++;
            
            if (won) {
                stats.won++;
                stats.currentStreak++;
                stats.maxStreak = Math.max(stats.maxStreak, stats.currentStreak);
            } else {
                stats.currentStreak = 0;
            }
            
            saveStats();
            updateStats();
        }

        // New game
        function newGame() {
            currentGuess = '';
            currentRow = 0;
            gameOver = false;
            gameWon = false;
            guesses = [];
            
            selectDailyWord();
            createBoard();
            createKeyboard();
            
            document.getElementById('message').innerHTML = '';
            document.getElementById('wordInfo').style.display = 'none';
        }

        // Show help modal
        function showHelp() {
            document.getElementById('helpModal').style.display = 'block';
        }

        // Close help modal
        function closeHelp() {
            document.getElementById('helpModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('helpModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        // Gamification Integration Functions
        let gameStartTime = null;
        
        function reportGameToGamificationSystem(won) {
            const endTime = Date.now();
            const timeSpent = gameStartTime ? Math.round((endTime - gameStartTime) / 1000) : 0;
            
            // Calculate score based on performance with double scoring for Te Reo MƒÅori
            let score = 0;
            if (won) {
                const attemptsBonus = Math.max(0, (7 - (currentRow + 1)) * 100);
                const timeBonus = Math.max(0, Math.round((300 - timeSpent) / 3));
                const baseScore = 500 + attemptsBonus + timeBonus;
                
                // Double scoring for Te Reo MƒÅori games
                score = baseScore * 2;
            } else {
                // Even partial completion gets cultural bonus
                score = 200; // Double the normal completion bonus
            }
            
            // Add bonus for each MƒÅori word guessed correctly (position-wise)
            let maoriWordBonus = 0;
            guesses.forEach(guess => {
                // This is always Te Reo content, so add bonus for each valid guess
                maoriWordBonus += 50;
            });
            score += maoriWordBonus;
            
            // Report to gamification system
            if (window.reportGameCompletion) {
                const result = window.reportGameCompletion(
                    'te-reo-wordle',
                    score,
                    timeSpent,
                    true, // Always cultural bonus for Te Reo content
                    0, // No hints in current version
                    currentRow + 1, // Number of attempts
                    won // Completion status
                );
                
                if (result && result.newAchievements && result.newAchievements.length > 0) {
                    showAchievementNotification(result);
                }
            }
            
            updateGameStatsDisplay();
        }
        
        function showAchievementNotification(result) {
            const feedback = document.getElementById('achievement-feedback');
            if (!feedback) return;
            
            let message = `Ka pai! You scored ${result.score || 'points'}.`;
            
            if (result.streak > 1) {
                message += ` ${result.streak} day streak! üî•`;
            }
            
            if (result.newAchievements.length > 0) {
                message += ` New achievement unlocked! üéâ`;
            }
            
            message += ` Cultural bonus for Te Reo MƒÅori! üåü`;
            
            feedback.innerHTML = `
                <div class="feedback-message success">
                    <span class="feedback-icon">üéâ</span>
                    <p>${message}</p>
                </div>
            `;
            
            setTimeout(() => {
                feedback.innerHTML = '';
            }, 4000);
        }
        
        function updateGameStatsDisplay() {
            // Update the quick stats display
            if (window.teKeteAkoGamification) {
                const summary = window.teKeteAkoGamification.getProgressSummary();
                
                document.getElementById('games-played').textContent = summary.totalGames;
                document.getElementById('total-score').textContent = summary.totalScore;
                document.getElementById('current-streak').textContent = summary.currentStreak;
                document.getElementById('cultural-level').textContent = summary.currentLevel.name;
                
                // Update recent achievements
                const recentDiv = document.getElementById('recent-achievements');
                const recentAchievements = window.teKeteAkoGamification.getRecentAchievements();
                
                if (recentAchievements.length > 0) {
                    const achievementsHtml = recentAchievements.slice(0, 3).map(achievement => `
                        <div class="recent-achievement">
                            <span class="recent-achievement-icon">${achievement.achievement.icon}</span>
                            <span class="recent-achievement-text">${achievement.achievement.name}</span>
                        </div>
                    `).join('');
                    
                    recentDiv.innerHTML = achievementsHtml;
                } else {
                    recentDiv.innerHTML = '<div style="text-align: center; color: var(--color-text-secondary); font-style: italic;">Play more to unlock achievements!</div>';
                }
            }
        }
        
        function startNewGame() {
            gameStartTime = Date.now();
            newGame();
        }
        
        // Enhanced initialization with gamification
        function initGameWithGamification() {
            initGame();
            gameStartTime = Date.now();
            
            // Initialize stats display
            setTimeout(() => {
                updateGameStatsDisplay();
            }, 500);
        }

        // Initialize game when page loads with proper error handling
        document.addEventListener('DOMContentLoaded', function() {
            // Ensure all dependencies are loaded before initializing
            const checkDependencies = () => {
                if (window.maoriDictionaryAPI) {
                    initGameWithGamification();
                } else {
                    console.log('Waiting for MƒÅori Dictionary API to load...');
                    setTimeout(checkDependencies, 100);
                }
            };
            
            checkDependencies();
        });
        
        // Override the new game function to include timing
        const originalNewGame = newGame;
        newGame = function() {
            gameStartTime = Date.now();
            originalNewGame();
        };
    </script>
    
    <!-- Load sharing system -->
    <script src="../js/wordle-sharing.js"></script>
    <script>
        // Very carefully hook into game completion for sharing
        document.addEventListener('DOMContentLoaded', () => {
            // Wait for everything to load, then hook into existing updateStatsAfterGame
            setTimeout(() => {
                if (typeof updateStatsAfterGame === 'function') {
                    const originalUpdateStats = updateStatsAfterGame;
                    updateStatsAfterGame = function(won) {
                        // Call original function first - preserve all existing functionality
                        originalUpdateStats(won);
                        
                        // Add sharing modal after game completion
                        if (window.wordleSharing && gameOver) {
                            window.wordleSharing.onGameComplete();
                        }
                    };
                }
            }, 1000);
        });
    </script>
</body>
</html>
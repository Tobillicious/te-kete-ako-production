<!DOCTYPE html><html lang="en"><head>
    <title>üß† GraphRAG Brain - Live Intelligence | Te Kete Ako</title>
<!-- SEO TAGS - Open Graph, Twitter Cards, Canonical URL -->
<!-- Open Graph / Facebook -->
<meta property="og:type" content="website"/>
<meta property="og:url" content="https://tekete.netlify.app/graphrag-brain.html"/>
<meta property="og:title" content="üß† GraphRAG Brain - Live Intelligence | Te Kete Ako"/>
<meta property="og:description" content="Ask questions in natural language. Get intelligent answers from 163,200 relationships."/>
<meta property="og:image" content="https://tekete.netlify.app/images/og-image.jpg"/>
<meta property="og:image:width" content="1200"/>
<meta property="og:image:height" content="630"/>
<meta property="og:image:alt" content="Te Kete Ako - Educational Platform"/>
<meta property="og:site_name" content="Te Kete Ako"/>
<meta property="og:locale" content="en_NZ"/>

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:url" content="https://tekete.netlify.app/graphrag-brain.html"/>
<meta name="twitter:title" content="üß† GraphRAG Brain - Live Intelligence | Te Kete Ako"/>
<meta name="twitter:description" content="Ask questions in natural language. Get intelligent answers from 163,200 relationships."/>
<meta name="twitter:image" content="https://tekete.netlify.app/images/twitter-card.jpg"/>
<meta name="twitter:image:alt" content="Te Kete Ako - Educational Platform"/>
<meta name="twitter:site" content="@TeKeteAko"/>
<meta name="twitter:creator" content="@TeKeteAko"/>

<!-- Canonical URL -->
<link rel="canonical" href="https://tekete.netlify.app/graphrag-brain.html"/>

<!-- Additional SEO -->
<meta name="robots" content="index, follow"/>
<meta name="googlebot" content="index, follow"/>
<meta name="theme-color" content="#1a4d2e"/>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ask questions in natural language. Get intelligent answers from 163,200 relationships.">

<!-- UNIFIED DESIGN SYSTEM -->
<!-- PWA Manifest -->
<link href="/manifest.json" rel="manifest"/>
<meta content="#1a4d2e" name="theme-color"/>

<!-- CSS - UNIFIED PROFESSIONAL DESIGN SYSTEM (CONSOLIDATED) -->
<!-- ‚≠ê PROFESSIONAL SYSTEM FIRST - Core design tokens -->
<link rel="stylesheet" href="/css/professionalization-system.css">

<!-- ‚≠ê THEME SYSTEM (Tailwind + Ultimate Beauty) -->
<link rel="stylesheet" href="/css/te-kete-professional.css"/>
<link rel="stylesheet" href="/css/te-kete-ultimate-beauty-system.css"/>

<!-- ‚≠ê COMPONENT STYLES -->
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/navigation-standard.css">
    <link rel="stylesheet" href="/css/mobile-revolution.css">
    <link rel="stylesheet" href="/css/mobile-first-classroom-tablets.css"/>

<!-- ‚≠ê PRINT STYLES (media="print" = only for printing) -->
    <link rel="stylesheet" href="/css/print.css" media="print"/>
<link rel="stylesheet" href="/css/print-professional.css" media="print"/>

<!-- ‚≠ê TAILWIND (Loads second-to-last - utilities only, NO DUPLICATES) -->
<link rel="stylesheet" href="/css/tailwind.css">

<!-- ‚≠ê CASCADE FIX (Loads LAST - overrides conflicting variables) -->
<link rel="stylesheet" href="/css/cascade-fix.css"><body class="pattern-koru-subtle"> <!-- üé® ULTIMATE BEAUTY: Navigation --> <div id="nav-container"></div> <script>   fetch('/components/navigation-standard.html')     .then(r => r.text())     .then(html => document.getElementById('nav-container').innerHTML = html); </script>    <!-- Navigation -->    <script>        fetch('/components/navigation-standard.html')            .then(response => response.text())            .then(data => {                document.body.insertAdjacentHTML('afterbegin', data);            });    </script>    <div class="brain-container">        <div class="brain-header">            <h1>üß† GraphRAG Brain</h1>            <p style="font-size: 1.5rem; opacity: 0.9;">Ask me anything about Te Kete Ako's 5,269 educational resources</p>        </div>        <!-- Live Stats -->        <div class="stats-grid">            <div class="stat-card">                <div class="stat-number">163,200</div>                <div class="stat-label">Relationships Mapped</div>            </div>            <div class="stat-card">                <div class="stat-number">5,269</div>                <div class="stat-label">Resources Indexed</div>            </div>            <div class="stat-card">                <div class="stat-number">738</div>                <div class="stat-label">Learning Pathways</div>            </div>            <div class="stat-card">                <div class="stat-number">1,449</div>                <div class="stat-label">With Whakataukƒ´</div>            </div>        </div>        <!-- Query Interface -->        <div class="query-interface">            <h2 style="margin-top: 0; margin-bottom: 2rem;">üí¨ Ask the Brain</h2>            <div class="query-input-wrapper">                <input                    type="text"                    id="query-input"                    class="query-input"                    placeholder="e.g., Show me Year 8 mathematics lessons with cultural integration..."                    autocomplete="off"                >            </div>            <div class="quick-queries">                <button class="quick-query-btn" onclick="quickQuery('cultural')">                    üåø Resources with highest cultural integration                </button>                <button class="quick-query-btn" onclick="quickQuery('pathways')">                    üìö Show me the longest learning pathways                </button>                <button class="quick-query-btn" onclick="quickQuery('year8')">                    üéì All Year 8 cross-curricular resources                </button>                <button class="quick-query-btn" onclick="quickQuery('whakatauaki')">                    üåü Resources with whakataukƒ´ integration                </button>                <button class="quick-query-btn" onclick="quickQuery('connected')">                    üîó Most connected resources (influence hubs)                </button>                <button class="quick-query-btn" onclick="quickQuery('science-maori')">                    üî¨ Science + Te Ao MƒÅori bridges                </button>            </div>            <button class="query-btn" onclick="askBrain()">                üß† Ask the Brain            </button>            <div class="example-queries">                <strong style="color: #f59e0b;">üí° Try asking:</strong>                <ul style="margin: 0.5rem 0 0 1.5rem; opacity: 0.9;">                    <li>"What's the learning pathway from basic geometry to MƒÅori patterns?"</li>                    <li>"Show me all ecology resources with assessment rubrics"</li>                    <li>"Which units have the most teaching variants?"</li>                    <li>"Find resources connecting mathematics and whakataukƒ´"</li>                </ul>            </div>        </div>        <!-- Results Container -->        <div id="results" class="results-container">            <h2 style="margin-top: 0;">üéØ Results</h2>            <div id="results-content"></div>        </div>    </div>    <script>        const SUPABASE_URL = 'https://nlgldaqtubrlcqddppbq.supabase.co';        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5sZ2xkYXF0dWJybGNxZGRwcGJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwODkzMzksImV4cCI6MjA2ODY2NTMzOX0.IFaWqep1MBSofARiCUuzvAReC44hwGnmKOMNSd55nIM';        let supabase;        // Initialize        window.addEventListener('DOMContentLoaded', () => {            supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);            console.log('üß† GraphRAG Brain initialized');        });        // Handle Enter key        document.addEventListener('DOMContentLoaded', () => {            document.getElementById('query-input').addEventListener('keypress', (e) => {                if (e.key === 'Enter') askBrain();            });        });        async function quickQuery(type) {            const queries = {                'cultural': 'SELECT * FROM graphrag_resources WHERE cultural_context = true ORDER BY quality_score DESC LIMIT 10',                'pathways': 'SELECT source_path, COUNT(*) as chain_length FROM graphrag_relationships WHERE relationship_type = \'prerequisite\' GROUP BY source_path ORDER BY chain_length DESC LIMIT 10',                'year8': 'SELECT * FROM graphrag_resources WHERE year_level LIKE \'%Year 8%\' OR year_level LIKE \'%Y8%\' ORDER BY quality_score DESC LIMIT 15',                'whakatauaki': 'SELECT * FROM graphrag_resources WHERE has_whakataukƒ´ = true ORDER BY quality_score DESC LIMIT 20',                'connected': 'SELECT r.file_path, r.title, r.quality_score, COUNT(DISTINCT rel.id) as connections FROM graphrag_resources r JOIN graphrag_relationships rel ON (r.file_path = rel.source_path OR r.file_path = rel.target_path) WHERE r.resource_type NOT LIKE \'_agent%\' GROUP BY r.file_path, r.title, r.quality_score ORDER BY connections DESC LIMIT 10',                'science-maori': 'SELECT * FROM graphrag_resources WHERE (subject LIKE \'%Science%\' OR subject LIKE \'%Ecology%\') AND (has_whakataukƒ´ = true OR cultural_context = true) ORDER BY quality_score DESC LIMIT 15'            };            executeQuery(queries[type], type);        }        async function askBrain() {            const query = document.getElementById('query-input').value.trim();            if (!query) {                alert('Please enter a question!');                return;            }            const resultsDiv = document.getElementById('results');            const contentDiv = document.getElementById('results-content');            resultsDiv.classList.add('active');            contentDiv.innerHTML = '<div class="loading"><span class="thinking-animation">üß†</span> DeepSeek AI is analyzing your question...</div>';            try {                // Phase 1: Use DeepSeek to understand the query                const response = await fetch('/.netlify/functions/deepseek-agent', {                    method: 'POST',                    headers: { 'Content-Type': 'application/json' },                    body: JSON.stringify({                        message: query,                        use_graphrag: true,                        analysis_mode: 'educational'                    })                });                if (!response.ok) {                    throw new Error(`DeepSeek API error: ${response.status}`);                }                const data = await response.json();                // Display AI-enhanced results                displayAIResults(data);            } catch (error) {                console.error('DeepSeek error, falling back to basic search:', error);                // Fallback to basic search                let sql = convertToSQL(query);                executeQuery(sql, 'custom');            }        }        function displayAIResults(data) {            const contentDiv = document.getElementById('results-content');            let html = `                <div style="background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(236, 72, 153, 0.2)); padding: 2rem; border-radius: 16px; margin-bottom: 2rem; border-left: 4px solid #a855f7;">                    <h3 style="margin-top: 0; color: #a855f7;">üß† DeepSeek AI Analysis</h3>                    <p style="white-space: pre-wrap; line-height: 1.8;">${data.response || data.message}</p>                </div>            `;            if (data.graphrag_results && data.graphrag_results.length > 0) {                html += `<h3 style="margin-top: 2rem; color: white;">üìö Related Resources (${data.graphrag_results.length})</h3>`;                data.graphrag_results.forEach(resource => {                    html += `                        <div class="result-card">                            <div class="result-title">${resource.title || resource.file_path}</div>                            <p style="opacity: 0.9; margin: 0.5rem 0;">${resource.file_path}</p>                            <div class="result-meta">                                ${resource.quality_score ? `<span class="meta-badge">‚≠ê ${resource.quality_score}</span>` : ''}                                ${resource.subject ? `<span class="meta-badge">üìö ${resource.subject}</span>` : ''}                                ${resource.year_level ? `<span class="meta-badge">üéì ${resource.year_level}</span>` : ''}                            </div>                        </div>                    `;                });            }            contentDiv.innerHTML = html;        }        function convertToSQL(query) {            const lowerQuery = query.toLowerCase();            // Extract year level            const yearMatch = lowerQuery.match(/year (\d+|[7-9]|1[0-3])|y(\d+)/i);            const yearLevel = yearMatch ? (yearMatch[1] || yearMatch[2]) : null;            // Extract subject            const subjects = ['mathematics', 'science', 'english', 'ecology', 'physics', 'social studies'];            const subject = subjects.find(s => lowerQuery.includes(s));            // Build SQL            let conditions = [];            if (yearLevel) conditions.push(`year_level LIKE '%Year ${yearLevel}%' OR year_level LIKE '%Y${yearLevel}%'`);            if (subject) conditions.push(`subject ILIKE '%${subject}%'`);            if (lowerQuery.includes('whakataukƒ´') || lowerQuery.includes('cultural')) {                conditions.push('has_whakataukƒ´ = true');            }            if (lowerQuery.includes('high quality') || lowerQuery.includes('best')) {                conditions.push('quality_score >= 90');            }            const whereClause = conditions.length > 0 ? 'WHERE ' + conditions.join(' AND ') : '';            return `SELECT * FROM graphrag_resources ${whereClause} ORDER BY quality_score DESC LIMIT 20`;        }        async function executeQuery(sql, type) {            const resultsDiv = document.getElementById('results');            const contentDiv = document.getElementById('results-content');            resultsDiv.classList.add('active');            contentDiv.innerHTML = '<div class="loading"><span class="thinking-animation">üß†</span> Thinking...</div>';            try {                // Note: Direct SQL execution may not work due to RLS                // Using table queries instead                const { data, error } = await fetchResults(type);                if (error) throw error;                displayResults(data, type);            } catch (error) {                console.error('Error:', error);                contentDiv.innerHTML = `                    <div style="color: #ef4444; text-align: center; padding: 2rem;">                        <h3>‚ö†Ô∏è Query Error</h3>                        <p>${error.message}</p>                        <p style="opacity: 0.8; margin-top: 1rem;">Try a different question or use a quick query button!</p>                    </div>                `;            }        }        async function fetchResults(type) {            // Execute actual queries based on type            let query = supabase.table('graphrag_resources').select('*');            switch(type) {                case 'cultural':                    return query.eq('cultural_context', true).order('quality_score', { ascending: false }).limit(10).execute();                case 'year8':                    return query.ilike('year_level', '%Year 8%').order('quality_score', { ascending: false }).limit(15).execute();                case 'whakatauaki':                    return query.eq('has_whakataukƒ´', true).order('quality_score', { ascending: false }).limit(20).execute();                case 'science-maori':                    return query.or('subject.ilike.%Science%,subject.ilike.%Ecology%').eq('has_whakataukƒ´', true).order('quality_score', { ascending: false }).limit(15).execute();                default:                    return query.order('quality_score', { ascending: false }).limit(20).execute();            }        }        function displayResults(data, type) {            const contentDiv = document.getElementById('results-content');            if (!data || data.length === 0) {                contentDiv.innerHTML = '<p style="text-align: center; opacity: 0.7;">No results found. Try a different query!</p>';                return;            }            let html = `<p style="color: #10b981; font-weight: 700; margin-bottom: 1.5rem;">‚úÖ Found ${data.length} result(s)</p>`;            data.forEach(resource => {                html += `                    <div class="result-card">                        <div class="result-title">${resource.title || resource.file_path}</div>                        <p style="opacity: 0.9; margin: 0.5rem 0;">${resource.file_path}</p>                        <div class="result-meta">                            ${resource.quality_score ? `<span class="meta-badge">‚≠ê Quality: ${resource.quality_score}</span>` : ''}                            ${resource.subject ? `<span class="meta-badge">üìö ${resource.subject}</span>` : ''}                            ${resource.year_level ? `<span class="meta-badge">üéì ${resource.year_level}</span>` : ''}                            ${resource.has_whakataukƒ´ ? `<span class="meta-badge">üåø Whakataukƒ´</span>` : ''}                            ${resource.has_te_reo ? `<span class="meta-badge">üó£Ô∏è Te Reo</span>` : ''}                        </div>                    </div>                `;            });            contentDiv.innerHTML = html;        }    </script><!-- üé® ULTIMATE BEAUTY SYSTEM: Complete UX --><!-- Footer --><div id="footer-container"></div><script>  fetch('/components/footer.html').then(r=>r.text()).then(html=>{    document.getElementById('footer-container').innerHTML=html;  });</script><!-- Mobile Navigation --><div id="mobile-nav-bottom"></div><script>  fetch('/components/mobile-bottom-nav.html').then(r=>r.text()).then(html=>{    document.getElementById('mobile-nav-bottom').innerHTML=html;  });</script><!-- Floating Action Button (Help) --><div id="fab-quick-actions"></div><script>  fetch('/components/quick-actions-fab.html').then(r=>r.text()).then(html=>{    document.getElementById('fab-quick-actions').innerHTML=html;  });</script><!-- üé® ULTIMATE BEAUTY: Framer Cultural Gestures --><script src="/js/framer-cultural-gestures-ultimate.js" defer></script><!-- üìä ULTIMATE BEAUTY: PostHog Analytics (Privacy-First) --><script src="/js/posthog-analytics.js" defer></script></body></html>
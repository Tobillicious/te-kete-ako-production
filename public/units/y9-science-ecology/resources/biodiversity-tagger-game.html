<!DOCTYPE html>
<html lang="en" data-visibility="searchable" data-prominence="low">
<head>
    <title>Biodiversity Tagger Game (Y9 Ecology)</title>

<!-- UNIFIED DESIGN SYSTEM -->
<!-- PWA Manifest -->
<link href="/manifest.json" rel="manifest"/>
<meta content="#1a4d2e" name="theme-color"/>

<!-- CSS - UNIFIED PROFESSIONAL DESIGN SYSTEM (CONSOLIDATED) -->
<!-- ⭐ PROFESSIONAL SYSTEM FIRST - Core design tokens -->


<!-- ⭐ THEME SYSTEM (Tailwind + Ultimate Beauty) -->



<!-- ⭐ COMPONENT STYLES -->





<!-- ⭐ PRINT STYLES (media="print" = only for printing) -->



<!-- ⭐ TAILWIND (Loads second-to-last - utilities only, NO DUPLICATES) -->


<!-- ⭐ CASCADE FIX (Loads LAST - overrides conflicting variables) -->


<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
    // Wait for Supabase CDN to load before initializing singleton
    window.addEventListener('DOMContentLoaded', () => {
        if (!window.supabase) {
            // Log to monitoring instead of console
            if (window.posthog) {
                posthog.capture('supabase_cdn_error', {
                    message: 'Supabase CDN failed to load',
                    url: window.location.pathname
                });
            }
        }
    });
</script>
<script src="/js/supabase-singleton.js"></script>
<!-- My Kete Database Integration - loads after singleton -->
<script src="/js/my-kete-database.js"></script>
<!-- Navigation Loader Singleton - loads after supabase setup -->
<script src="/js/navigation-loader.js"></script>
<!-- Component Loader - centralized async component management -->
<script src="/js/component-loader.js"></script>
<meta name="mobile-web-app-capable" content="yes"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"/>
<meta content="Te Kete Ako" name="apple-mobile-web-app-title"/>
<link href="/icons/icon-192x192.png" rel="apple-touch-icon"/>
<!-- ENHANCED SEARCH -->
<script src="/js/enhanced-search.js" defer></script>
<!-- MOBILE PERFORMANCE OPTIMIZER -->
<script src="/js/mobile-performance-optimizer.js" defer></script>
<!-- TOUCH TARGET AUDITOR -->
<script src="/js/touch-target-auditor.js" defer></script>
<!-- 🎨 ULTIMATE CULTURAL GESTURES - Framer Motion System -->
<script src="/js/framer-cultural-gestures-ultimate.js" defer></script>
<!-- Service Worker Registration -->
<script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('✅ PWA: Service Worker registered!', registration);
                    })
                    .catch(error => {
                        // Log to monitoring instead of console
                        if (window.posthog) {
                            posthog.capture('pwa_service_worker_error', {
                                message: 'Service Worker registration failed',
                                error: error.message,
                                url: window.location.pathname
                            });
                        }
                    });
            });
        }
</script>

<meta name="robots" content="index, follow"/>
<meta name="googlebot" content="index, follow"/>
<meta name="theme-color" content="#1a4d2e"/>



<meta name="robots" content="index, follow"/>
<meta name="googlebot" content="index, follow"/>
<meta name="theme-color" content="#1a4d2e"/>


    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- UNIFIED DESIGN SYSTEM -->
<!-- PWA Manifest -->
<link href="/manifest.json" rel="manifest"/>
<meta content="#1a4d2e" name="theme-color"/>

<!-- CSS - UNIFIED PROFESSIONAL DESIGN SYSTEM (CONSOLIDATED) -->
<!-- ⭐ PROFESSIONAL SYSTEM FIRST - Core design tokens -->


<!-- ⭐ THEME SYSTEM (Tailwind + Ultimate Beauty) -->



<!-- ⭐ COMPONENT STYLES -->
    
    
    
    

<!-- ⭐ PRINT STYLES (media="print" = only for printing) -->
    


<!-- ⭐ TAILWIND (Loads second-to-last - utilities only, NO DUPLICATES) -->


<!-- ⭐ CASCADE FIX (Loads LAST - overrides conflicting variables) -->

<body>
  <div class="game">
    <header class="header">
      <h1 style="margin:0 0 .5rem">🌿 Biodiversity Tagger Challenge</h1>
      <p class="m-0" >How fast can you correctly classify NZ native species?</p>
    </header>

    <div class="game-area">
      <div class="flex mb-4" >
        <div><strong>Score:</strong> <span class="score" id="score">0</span></div>
        <div><strong>Time:</strong> <span id="timer">60</span>s</div>
        <div><strong>Streak:</strong> <span id="streak">0</span> 🔥</div>
      </div>

      <div id="question-panel" class="p-4 rounded-lg mb-4" >
        <h3 style="margin-top:0" id="question">Loading...</h3>
        <p style="font-size:.9rem;color:#6b7280" id="hint"></p>
      </div>

      <div class="species-grid" id="options"></div>

      <div class="text-center" >
        <button class="btn" onclick="game.start()" id="start-btn">Start Game</button>
        <button class="btn" onclick="game.restart()" id="restart-btn" style="display:none;background:#6b7280">Play Again</button>
      </div>
    </div>

    <div id="results" class="game-area" style="display:none">
      <h2 class="text-center" >Game Over!</h2>
      <p class="text-center text-base" >Final Score: <span class="score" id="final-score">0</span></p>
      <p class="text-center" id="rank"></p>
    </div>
  </div>

  <script>
    const game={
      score:0,streak:0,timer:60,interval:null,
      questions:[
        {q:'Which is a PRODUCER?',hint:'Makes its own food via photosynthesis',answer:'Rimu',options:['Rimu','Kererū','Tuatara','Wētā']},
        {q:'Which is a PRIMARY CONSUMER?',hint:'Eats plants',answer:'Kererū',options:['Kererū','Falcon','Rimu','Eel']},
        {q:'Which is a PREDATOR (secondary consumer)?',hint:'Eats other animals',answer:'Falcon',options:['Falcon','Harakeke','Kererū','Cabbage tree']},
        {q:'Which is NATIVE to NZ?',hint:'Evolved here over millions of years',answer:'Tuatara',options:['Tuatara','Possum','Rat','Cat']},
        {q:'Which is ENDEMIC to NZ?',hint:'Found ONLY in NZ, nowhere else',answer:'Kiwi',options:['Kiwi','Sparrow','Salmon','Gull']},
        {q:'Which is INTRODUCED/INVASIVE?',hint:'Brought by humans, harms natives',answer:'Possum',options:['Possum','Kākāpō','Weka','Morepork']},
        {q:'Which species is CRITICALLY ENDANGERED?',hint:'Fewer than 250 left in wild',answer:'Kākāpō',options:['Kākāpō','Tūī','Fantail','Kingfisher']},
        {q:'Which plant is a WETLAND species?',hint:'Thrives in swampy, water-logged soil',answer:'Harakeke',options:['Harakeke','Kauri','Mānuka','Beech']},
        {q:'Which is a DECOMPOSER?',hint:'Breaks down dead material',answer:'Wētā',options:['Wētā','Kiwi','Trout','Heron']},
        {q:'Which bird is a SEED DISPERSER?',hint:'Eats fruit, spreads seeds via droppings',answer:'Kererū',options:['Kererū','Hawk','Shag','Duck']}
      ],
      current:null,
      
      start(){
        this.score=0;this.streak=0;this.timer=60;
        document.getElementById('score').textContent=this.score;
        document.getElementById('streak').textContent=this.streak;
        document.getElementById('start-btn').style.display='none';
        document.getElementById('results').style.display='none';
        this.nextQuestion();
        this.interval=setInterval(()=>{
          this.timer--;
          document.getElementById('timer').textContent=this.timer;
          if(this.timer<=0){clearInterval(this.interval);this.end()}
        },1000);
      },
      
      nextQuestion(){
        this.current=this.questions[Math.floor(Math.random()*this.questions.length)];
        document.getElementById('question').textContent=this.current.q;
        document.getElementById('hint').textContent='💡 '+this.current.hint;
        const opts=document.getElementById('options');
        opts.innerHTML=this.current.options.map(o=>`<div class="species-card" onclick="game.check('${o}')">${o}</div>`).join('');
      },
      
      check(selected){
        const correct=selected===this.current.answer;
        const cards=document.querySelectorAll('.species-card');
        cards.forEach(c=>{
          c.style.pointerEvents='none';
          if(c.textContent===this.current.answer)c.classList.add('correct');
          if(c.textContent===selected&&!correct)c.classList.add('wrong');
        });
        if(correct){
          this.score+=10+this.streak*2;
          this.streak++;
          document.getElementById('score').textContent=this.score;
          document.getElementById('streak').textContent=this.streak;
        }else{
          this.streak=0;
          document.getElementById('streak').textContent=this.streak;
        }
        setTimeout(()=>this.nextQuestion(),1200);
      },
      
      end(){
        clearInterval(this.interval);
        document.getElementById('final-score').textContent=this.score;
        let rank='Emerging Ecologist';
        if(this.score>=150)rank='🏆 Kaitiaki Champion!';
        else if(this.score>=100)rank='🌟 Biodiversity Expert';
        else if(this.score>=50)rank='🌿 Growing Ecologist';
        document.getElementById('rank').textContent=rank;
        document.getElementById('results').style.display='block';
        document.getElementById('restart-btn').style.display='inline-block';
      },
      
      restart(){
        document.getElementById('restart-btn').style.display='none';
        document.getElementById('start-btn').style.display='inline-block';
      }
    };
  </script>

  <script src="/js/te-kete-professional.js" defer></script>
  <script src="/js/posthog-analytics.js" defer></script>
</body>
</html>

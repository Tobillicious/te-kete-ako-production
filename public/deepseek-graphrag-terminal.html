<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Performance: Optimize rendering -->
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#1b4332">
    <meta name="color-scheme" content="light">
    <!-- Performance: DNS prefetch for external domains -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    <!-- Performance: Preload critical resources -->
    <link rel="preload" href="/css/te-kete-professional.css" as="style">
    <link rel="preload" href="/js/te-kete-professional.js" as="script">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Lato:wght@300;400;700&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300;1,400&display=swap&display=swap" as="style" crossorigin>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Te Kete Ako - Award-winning educational platform integrating mÄtauranga MÄori with contemporary learning">
    <meta name="keywords" content="education, mÄori, indigenous, ai, learning, new zealand">
    <meta name="author" content="Te Kete Ako">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– DeepSeek + GraphRAG Terminal | Te Kete Ako</title>





    
    
    
    
    <link rel="stylesheet" href="/css/print.css" media="print"/>
    <link rel="stylesheet" href="/css/te-kete-professional.css"/>
    <script src="/js/breadcrumbs.js" defer></script>
    
</head>
<body>
                        <header class="site-header no-print">
        <div class="nav-container">
            <a href="/index.html" class="nav-brand">Te Kete Ako</a>
            <nav class="main-nav">
                <ul>
                    <li><a href="/unit-plans.html" class="nav-link"><span class="nav-icon">ğŸ“š</span><span class="nav-text-en">Unit Plans</span><span class="nav-text-mi" lang="mi">NgÄ Waehere</span></a></li>
                    <li><a href="/lessons.html" class="nav-link"><span class="nav-icon">ğŸ“</span><span class="nav-text-en">Lessons</span><span class="nav-text-mi" lang="mi">NgÄ Akoranga</span></a></li>
                    <li><a href="/handouts.html" class="nav-link"><span class="nav-icon">ğŸ“„</span><span class="nav-text-en">Handouts</span><span class="nav-text-mi" lang="mi">NgÄ Rauemi</span></a></li>
                    <li><a href="/teachers/index.html" class="nav-link"><span class="nav-icon">ğŸ§‘â€ğŸ«</span><span class="nav-text-en">Teachers</span><span class="nav-text-mi" lang="mi">NgÄ Kaiako</span></a></li>
                    <li class="auth-nav"><a href="/login.html" class="nav-link login-btn"><span class="nav-icon">ğŸ‘¤</span>Login</a></li>
                </ul>
            </nav>
            <nav class="breadcrumbs no-print" aria-label="Breadcrumb"><ol id="breadcrumbs" class="breadcrumbs-list"></ol></nav>
        </div>
    </header>


    <div class="container">
        <div class="header">
            <h1 class="wiley-hero-title">ğŸ¤– DeepSeek + GraphRAG Terminal</h1>
            <p>Multi-AI Coordination System | Te Kete Ako Platform</p>
        </div>

        <!-- AI Agent Status -->
        <div class="ai-status">
            <div class="ai-agent deepseek">
                <h3>ğŸ§  DeepSeek</h3>
                <p>Reasoning & Generation</p>
                <small id="deepseek-status">Ready</small>
            </div>
            <div class="ai-agent graphrag">
                <h3>ğŸ“š GraphRAG Brain</h3>
                <p>Institutional Memory</p>
                <small id="graphrag-status">179 resources, 553 relationships</small>
            </div>
            <div class="ai-agent firebase">
                <h3>ğŸ” Firebase Auth</h3>
                <p>User Authentication</p>
                <small id="firebase-status">Connected</small>
            </div>
            <div class="ai-agent supabase">
                <h3>ğŸ’¾ Supabase</h3>
                <p>Knowledge Storage</p>
                <small id="supabase-status">Ready</small>
            </div>
        </div>

        <!-- Chat Interface -->
        <div class="chat-interface">
            <input type="text" 
                   class="query-input" 
                   id="queryInput" 
                   placeholder="Ask anything... DeepSeek will use GraphRAG institutional memory to enhance responses"
                   maxlength="500">
            
            <div class="options">
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="useGraphRAG" checked>
                        <label for="useGraphRAG">Use GraphRAG Brain</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="showContext">
                        <label for="showContext">Show GraphRAG Context</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="culturalSafety" checked>
                        <label for="culturalSafety">Cultural Safety Mode</label>
                    </div>
                </div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="sendQuery()">
                    ğŸš€ Ask DeepSeek + GraphRAG
                </button>
                <button class="btn btn-secondary" onclick="clearChat()">
                    ğŸ—‘ï¸ Clear Chat
                </button>
                <button class="btn btn-secondary" onclick="showGraphRAGDemo()">
                    ğŸ“Š GraphRAG Demo
                </button>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>AI agents coordinating...</p>
            </div>

            <div class="response-area" id="responseArea">
                <div class="response-item ai-response">
                    <strong>ğŸ¤– System Ready</strong><br>
                    Welcome to the DeepSeek + GraphRAG coordination terminal! Ask any educational question and watch how multiple AI agents work together:
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li><strong>DeepSeek</strong> provides reasoning and generation</li>
                        <li><strong>GraphRAG</strong> provides institutional memory from 179+ educational resources</li>
                        <li><strong>Cultural Safety</strong> ensures authentic Te Ao MÄori representation</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalQueries">0</div>
                <div>Total Queries</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="graphragHits">0</div>
                <div>GraphRAG Hits</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="culturalResources">0</div>
                <div>Cultural Resources</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="aiCoordinations">0</div>
                <div>AI Coordinations</div>
            </div>
        </div>
    </div>

    <script>
        let queryCount = 0;
        let totalGraphRAGHits = 0;
        let totalCulturalResources = 0;
        let totalCoordinations = 0;

        // Handle Enter key in input
        document.getElementById('queryInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendQuery();
            }
        });

        async function sendQuery() {
            const query = document.getElementById('queryInput').value.trim();
            if (!query) return;

            const useGraphRAG = document.getElementById('useGraphRAG').checked;
            const showContext = document.getElementById('showContext').checked;
            const culturalSafety = document.getElementById('culturalSafety').checked;

            // Add user message to chat
            addMessage(`ğŸ§‘ User: ${query}`, 'user-message');

            // Show loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('queryInput').value = '';

            try {
                // Call the DeepSeek-GraphRAG bridge
                const response = await fetch('/.netlify/functions/deepseek-graphrag-bridge', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: query,
                        use_graphrag: useGraphRAG,
                        cultural_safety: culturalSafety,
                        user_id: 'demo_user_' + Date.now()
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();

                if (data.success) {
                    // Show GraphRAG context if requested
                    if (showContext && data.graphrag_context) {
                        const contextMsg = `ğŸ“š GraphRAG Context: Found ${data.graphrag_context.resources_found} resources, ${data.graphrag_context.cultural_resources} cultural resources, ${data.graphrag_context.connections} connections`;
                        addMessage(contextMsg, 'graphrag-context');
                    }

                    // Show AI response
                    addMessage(`ğŸ¤– DeepSeek + GraphRAG: ${data.response}`, 'ai-response');

                    // Update statistics
                    queryCount++;
                    if (data.graphrag_context) {
                        totalGraphRAGHits += data.graphrag_context.resources_found || 0;
                        totalCulturalResources += data.graphrag_context.cultural_resources || 0;
                    }
                    totalCoordinations++;
                    updateStats();

                    // Show coordination info
                    if (data.ai_coordination) {
                        const coordMsg = `ğŸ”— AI Coordination: ${Object.entries(data.ai_coordination).map(([ai, role]) => `${ai} (${role})`).join(', ')}`;
                        addMessage(coordMsg, 'graphrag-context');
                    }

                } else {
                    addMessage(`âŒ Error: ${data.error || 'Unknown error'}`, 'ai-response');
                }

            } catch (error) {
                console.error('Query error:', error);
                addMessage(`âŒ Connection Error: ${error.message}`, 'ai-response');
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        function addMessage(content, className) {
            const responseArea = document.getElementById('responseArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = `response-item ${className}`;
            messageDiv.innerHTML = content;
            responseArea.appendChild(messageDiv);
            responseArea.scrollTop = responseArea.scrollHeight;
        }

        function clearChat() {
            const responseArea = document.getElementById('responseArea');
            responseArea.innerHTML = `
                <div class="response-item ai-response">
                    <strong>ğŸ¤– Chat Cleared</strong><br>
                    Ready for new queries!
                </div>
            `;
        }

        function showGraphRAGDemo() {
            addMessage(`ğŸ“Š GraphRAG Demo Query: "Show me Te Ao MÄori resources for mathematics"`, 'user-message');
            
            // Simulate a GraphRAG demo response
            setTimeout(() => {
                addMessage(`ğŸ“š GraphRAG Context: Found 12 resources, 8 cultural resources, 23 connections`, 'graphrag-context');
                setTimeout(() => {
                    addMessage(`ğŸ¤– DeepSeek + GraphRAG: Based on the institutional memory, I found several excellent Te Ao MÄori mathematics resources:

1. **Traditional Navigation Mathematics** - Uses Polynesian wayfinding techniques
2. **Probability with Matauranga Integration** - Cultural probability concepts
3. **Climate Science Traditional Knowledge** - Weather pattern mathematics

The GraphRAG brain shows these resources connect to broader systems thinking and cultural assessment frameworks. This integration ensures mathematical learning honors indigenous knowledge systems while meeting curriculum standards.`, 'ai-response');
                }, 1000);
            }, 500);

            // Update demo stats
            totalGraphRAGHits += 12;
            totalCulturalResources += 8;
            totalCoordinations++;
            queryCount++;
            updateStats();
        }

        function updateStats() {
            document.getElementById('totalQueries').textContent = queryCount;
            document.getElementById('graphragHits').textContent = totalGraphRAGHits;
            document.getElementById('culturalResources').textContent = totalCulturalResources;
            document.getElementById('aiCoordinations').textContent = totalCoordinations;
        }

        // Initialize
        updateStats();
    </script>

    <!-- Load Supabase Client -->
    <script src="/js/supabase-client.js"></script>
    <!-- Load Auth UI -->
    <script src="/js/auth-enhanced.js" defer></script>

    <script>
    // Register service worker for performance
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('/sw.js')
                .then(registration => console.log('SW registered'))
                .catch(error => console.log('SW registration failed'));
        });
    }
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Performance: Optimize rendering -->
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#1b4332">
    <meta name="color-scheme" content="light">
    <!-- Performance: DNS prefetch for external domains -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    <!-- Performance: Preload critical resources -->
    <link rel="preload" href="/css/te-kete-professional.css" as="style">
    <link rel="preload" href="/js/te-kete-professional.js" as="script">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Lato:wght@300;400;700&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300;1,400&display=swap&display=swap" as="style" crossorigin>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Te Kete Ako - Award-winning educational platform integrating mƒÅtauranga MƒÅori with contemporary learning">
    <meta name="keywords" content="education, mƒÅori, indigenous, ai, learning, new zealand">
    <meta name="author" content="Te Kete Ako">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ DeepSeek + GraphRAG Terminal | Te Kete Ako</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f172a 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00d4ff, #ff3366, #ffaa00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s infinite alternate;
        }

        @keyframes pulse {
            from { opacity: 0.8; }
            to { opacity: 1; }
        }

        .ai-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .ai-agent {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid;
            position: relative;
            overflow: hidden;
        }

        .ai-agent::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(to bottom, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: scan 2s infinite;
        }

        @keyframes scan {
            0%, 100% { transform: translateY(-100%); }
            50% { transform: translateY(100%); }
        }

        .deepseek { border-left-color: #ff3366; }
        .graphrag { border-left-color: #00d4ff; }
        .firebase { border-left-color: #ffaa00; }
        .supabase { border-left-color: #3ecf8e; }

        .chat-interface {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .query-input {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: var(--text-lg);
            margin-bottom: 15px;
        }

        .query-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .response-area {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            min-height: 300px;
            margin-top: 20px;
            overflow-y: auto;
        }

        .response-item {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: var(--radius-md);
            border-left: 4px solid;
        }

        .user-message {
            background: rgba(0, 212, 255, 0.1);
            border-left-color: #00d4ff;
        }

        .ai-response {
            background: rgba(255, 51, 102, 0.1);
            border-left-color: #ff3366;
        }

        .graphrag-context {
            background: rgba(62, 207, 142, 0.1);
            border-left-color: #3ecf8e;
            font-size: var(--text-sm);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-left: 4px solid #00d4ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #00d4ff;
        }

        .options {
            margin-bottom: 15px;
        }

        .checkbox-group {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>





    
    
    
    
        <link rel="stylesheet" href="/css/design-system-v3.css"/>
    <link rel="stylesheet" href="/css/award-winning-polish.css"/>
    <link rel="stylesheet" href="/css/print.css" media="print"/>
    <link rel="stylesheet" href="/css/te-kete-professional.css"/>
    <script src="/js/breadcrumbs.js" defer></script>
    
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="wiley-hero-title">ü§ñ DeepSeek + GraphRAG Terminal</h1>
            <p>Multi-AI Coordination System | Te Kete Ako Platform</p>
        </div>

        <!-- AI Agent Status -->
        <div class="ai-status">
            <div class="ai-agent deepseek">
                <h3>üß† DeepSeek</h3>
                <p>Reasoning & Generation</p>
                <small id="deepseek-status">Ready</small>
            </div>
            <div class="ai-agent graphrag">
                <h3>üìö GraphRAG Brain</h3>
                <p>Institutional Memory</p>
                <small id="graphrag-status">179 resources, 553 relationships</small>
            </div>
            <div class="ai-agent firebase">
                <h3>üîê Firebase Auth</h3>
                <p>User Authentication</p>
                <small id="firebase-status">Connected</small>
            </div>
            <div class="ai-agent supabase">
                <h3>üíæ Supabase</h3>
                <p>Knowledge Storage</p>
                <small id="supabase-status">Ready</small>
            </div>
        </div>

        <!-- Chat Interface -->
        <div class="chat-interface">
            <input type="text" 
                   class="query-input" 
                   id="queryInput" 
                   placeholder="Ask anything... DeepSeek will use GraphRAG institutional memory to enhance responses"
                   maxlength="500">
            
            <div class="options">
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="useGraphRAG" checked>
                        <label for="useGraphRAG">Use GraphRAG Brain</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="showContext">
                        <label for="showContext">Show GraphRAG Context</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="culturalSafety" checked>
                        <label for="culturalSafety">Cultural Safety Mode</label>
                    </div>
                </div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="sendQuery()">
                    üöÄ Ask DeepSeek + GraphRAG
                </button>
                <button class="btn btn-secondary" onclick="clearChat()">
                    üóëÔ∏è Clear Chat
                </button>
                <button class="btn btn-secondary" onclick="showGraphRAGDemo()">
                    üìä GraphRAG Demo
                </button>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>AI agents coordinating...</p>
            </div>

            <div class="response-area" id="responseArea">
                <div class="response-item ai-response">
                    <strong>ü§ñ System Ready</strong><br>
                    Welcome to the DeepSeek + GraphRAG coordination terminal! Ask any educational question and watch how multiple AI agents work together:
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li><strong>DeepSeek</strong> provides reasoning and generation</li>
                        <li><strong>GraphRAG</strong> provides institutional memory from 179+ educational resources</li>
                        <li><strong>Cultural Safety</strong> ensures authentic Te Ao MƒÅori representation</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalQueries">0</div>
                <div>Total Queries</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="graphragHits">0</div>
                <div>GraphRAG Hits</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="culturalResources">0</div>
                <div>Cultural Resources</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="aiCoordinations">0</div>
                <div>AI Coordinations</div>
            </div>
        </div>
    </div>

    <script>
        let queryCount = 0;
        let totalGraphRAGHits = 0;
        let totalCulturalResources = 0;
        let totalCoordinations = 0;

        // Handle Enter key in input
        document.getElementById('queryInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendQuery();
            }
        });

        async function sendQuery() {
            const query = document.getElementById('queryInput').value.trim();
            if (!query) return;

            const useGraphRAG = document.getElementById('useGraphRAG').checked;
            const showContext = document.getElementById('showContext').checked;
            const culturalSafety = document.getElementById('culturalSafety').checked;

            // Add user message to chat
            addMessage(`üßë User: ${query}`, 'user-message');

            // Show loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('queryInput').value = '';

            try {
                // Call the DeepSeek-GraphRAG bridge
                const response = await fetch('/.netlify/functions/deepseek-graphrag-bridge', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: query,
                        use_graphrag: useGraphRAG,
                        cultural_safety: culturalSafety,
                        user_id: 'demo_user_' + Date.now()
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();

                if (data.success) {
                    // Show GraphRAG context if requested
                    if (showContext && data.graphrag_context) {
                        const contextMsg = `üìö GraphRAG Context: Found ${data.graphrag_context.resources_found} resources, ${data.graphrag_context.cultural_resources} cultural resources, ${data.graphrag_context.connections} connections`;
                        addMessage(contextMsg, 'graphrag-context');
                    }

                    // Show AI response
                    addMessage(`ü§ñ DeepSeek + GraphRAG: ${data.response}`, 'ai-response');

                    // Update statistics
                    queryCount++;
                    if (data.graphrag_context) {
                        totalGraphRAGHits += data.graphrag_context.resources_found || 0;
                        totalCulturalResources += data.graphrag_context.cultural_resources || 0;
                    }
                    totalCoordinations++;
                    updateStats();

                    // Show coordination info
                    if (data.ai_coordination) {
                        const coordMsg = `üîó AI Coordination: ${Object.entries(data.ai_coordination).map(([ai, role]) => `${ai} (${role})`).join(', ')}`;
                        addMessage(coordMsg, 'graphrag-context');
                    }

                } else {
                    addMessage(`‚ùå Error: ${data.error || 'Unknown error'}`, 'ai-response');
                }

            } catch (error) {
                console.error('Query error:', error);
                addMessage(`‚ùå Connection Error: ${error.message}`, 'ai-response');
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        function addMessage(content, className) {
            const responseArea = document.getElementById('responseArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = `response-item ${className}`;
            messageDiv.innerHTML = content;
            responseArea.appendChild(messageDiv);
            responseArea.scrollTop = responseArea.scrollHeight;
        }

        function clearChat() {
            const responseArea = document.getElementById('responseArea');
            responseArea.innerHTML = `
                <div class="response-item ai-response">
                    <strong>ü§ñ Chat Cleared</strong><br>
                    Ready for new queries!
                </div>
            `;
        }

        function showGraphRAGDemo() {
            addMessage(`üìä GraphRAG Demo Query: "Show me Te Ao MƒÅori resources for mathematics"`, 'user-message');
            
            // Simulate a GraphRAG demo response
            setTimeout(() => {
                addMessage(`üìö GraphRAG Context: Found 12 resources, 8 cultural resources, 23 connections`, 'graphrag-context');
                setTimeout(() => {
                    addMessage(`ü§ñ DeepSeek + GraphRAG: Based on the institutional memory, I found several excellent Te Ao MƒÅori mathematics resources:

1. **Traditional Navigation Mathematics** - Uses Polynesian wayfinding techniques
2. **Probability with Matauranga Integration** - Cultural probability concepts
3. **Climate Science Traditional Knowledge** - Weather pattern mathematics

The GraphRAG brain shows these resources connect to broader systems thinking and cultural assessment frameworks. This integration ensures mathematical learning honors indigenous knowledge systems while meeting curriculum standards.`, 'ai-response');
                }, 1000);
            }, 500);

            // Update demo stats
            totalGraphRAGHits += 12;
            totalCulturalResources += 8;
            totalCoordinations++;
            queryCount++;
            updateStats();
        }

        function updateStats() {
            document.getElementById('totalQueries').textContent = queryCount;
            document.getElementById('graphragHits').textContent = totalGraphRAGHits;
            document.getElementById('culturalResources').textContent = totalCulturalResources;
            document.getElementById('aiCoordinations').textContent = totalCoordinations;
        }

        // Initialize
        updateStats();
    </script>

    <!-- Load Supabase Client -->
    <script src="/js/supabase-client.js"></script>
    <!-- Load Auth UI -->
    <script src="/js/auth-enhanced.js" defer></script>

    <script>
    // Register service worker for performance
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('/sw.js')
                .then(registration => console.log('SW registered'))
                .catch(error => console.log('SW registration failed'));
        });
    }
    </script>
</body>
</html>
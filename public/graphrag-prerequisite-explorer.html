<!DOCTYPE html><html lang="en"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Prerequisite Chain Explorer | GraphRAG Intelligence | Te Kete Ako (Updated Oct 19 2025)</title>

<!-- UNIFIED DESIGN SYSTEM -->
<!-- PWA Manifest -->
<link href="/manifest.json" rel="manifest"/>
<meta content="#1a4d2e" name="theme-color"/>

<!-- CSS - UNIFIED PROFESSIONAL DESIGN SYSTEM (CONSOLIDATED) -->
<!-- ‚≠ê PROFESSIONAL SYSTEM FIRST - Core design tokens -->


<!-- ‚≠ê THEME SYSTEM (Tailwind + Ultimate Beauty) -->



<!-- ‚≠ê COMPONENT STYLES -->





<!-- ‚≠ê PRINT STYLES (media="print" = only for printing) -->



<!-- ‚≠ê TAILWIND (Loads second-to-last - utilities only, NO DUPLICATES) -->


<!-- ‚≠ê CASCADE FIX (Loads LAST - overrides conflicting variables) -->


<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
    // Wait for Supabase CDN to load before initializing singleton
    window.addEventListener('DOMContentLoaded', () => {
        if (!window.supabase) {
            // Log to monitoring instead of console
            if (window.posthog) {
                posthog.capture('supabase_cdn_error', {
                    message: 'Supabase CDN failed to load',
                    url: window.location.pathname
                });
            }
        }
    });
</script>
<script src="/js/supabase-singleton.js"></script>
<!-- My Kete Database Integration - loads after singleton -->
<script src="/js/my-kete-database.js"></script>
<!-- Navigation Loader Singleton - loads after supabase setup -->
<script src="/js/navigation-loader.js"></script>
<!-- Component Loader - centralized async component management -->
<script src="/js/component-loader.js"></script>
<meta name="mobile-web-app-capable" content="yes"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"/>
<meta content="Te Kete Ako" name="apple-mobile-web-app-title"/>
<link href="/icons/icon-192x192.png" rel="apple-touch-icon"/>
<!-- ENHANCED SEARCH -->
<script src="/js/enhanced-search.js" defer></script>
<!-- MOBILE PERFORMANCE OPTIMIZER -->
<script src="/js/mobile-performance-optimizer.js" defer></script>
<!-- TOUCH TARGET AUDITOR -->
<script src="/js/touch-target-auditor.js" defer></script>
<!-- üé® ULTIMATE CULTURAL GESTURES - Framer Motion System -->
<script src="/js/framer-cultural-gestures-ultimate.js" defer></script>
<!-- Service Worker Registration -->
<script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('‚úÖ PWA: Service Worker registered!', registration);
                    })
                    .catch(error => {
                        // Log to monitoring instead of console
                        if (window.posthog) {
                            posthog.capture('pwa_service_worker_error', {
                                message: 'Service Worker registration failed',
                                error: error.message,
                                url: window.location.pathname
                            });
                        }
                    });
            });
        }
</script>

<meta name="robots" content="index, follow"/>
<meta name="googlebot" content="index, follow"/>
<meta name="theme-color" content="#1a4d2e"/>



<meta name="robots" content="index, follow"/>
<meta name="googlebot" content="index, follow"/>
<meta name="theme-color" content="#1a4d2e"/>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- UNIFIED DESIGN SYSTEM -->
<!-- PWA Manifest -->
<link href="/manifest.json" rel="manifest"/>
<meta content="#1a4d2e" name="theme-color"/>

<!-- CSS - UNIFIED PROFESSIONAL DESIGN SYSTEM (CONSOLIDATED) -->
<!-- ‚≠ê PROFESSIONAL SYSTEM FIRST - Core design tokens -->


<!-- ‚≠ê THEME SYSTEM (Tailwind + Ultimate Beauty) -->



<!-- ‚≠ê COMPONENT STYLES -->
    
    
    
    

<!-- ‚≠ê PRINT STYLES (media="print" = only for printing) -->
    


<!-- ‚≠ê TAILWIND (Loads second-to-last - utilities only, NO DUPLICATES) -->


<!-- ‚≠ê CASCADE FIX (Loads LAST - overrides conflicting variables) -->
<body class="pattern-koru-subtle">    <!-- Navigation -->    <div id="nav-container"></div>    <script>        fetch('/components/navigation-standard.html')            .then(r => r.text())            .then(html => document.getElementById('nav-container').innerHTML = html);    </script>    <!-- Whakataukƒ´ -->    <div >        <p >            "He ara whakauru ki te mƒÅtauranga, he ara whakaputa ki te ao mƒÅrama"        </p>        <p >            The pathway into knowledge is the pathway to enlightenment        </p>    </div>    <!-- Hero -->    <section class="hero">        <div class="m-0 mx-auto" <h1 >üéØ Prerequisite Chain Explorer</h1>            <p style="opacity: 0.95;">                Discover perfect learning sequences with 100% confidence pathways            </p>            <p style="opacity: 0.85; margin-top: 0.5rem;">                üèÜ Featuring Y8 Digital Kaitiakitanga: 18-lesson perfect chain at 1.0 confidence!            </p>        </div>    </section>    <main class="chain-container">        <!-- Search -->        <div class="search-box">            <input                type="text"                class="search-input"                placeholder="üîç Search for a topic or lesson..."                id="search-input"                onkeyup="filterChains()"            >        </div>        <!-- Chains Display -->        <div id="chains-display" class="loading">            <div class="spinner"></div>            <p style="color: #64748b;">Loading prerequisite chains from GraphRAG...</p>        </div>    </main>    <!-- Footer -->    <div id="footer-container"></div>    <script>        fetch('/components/footer.html').then(r=>r.text()).then(html=>{            document.getElementById('footer-container').innerHTML=html;        });    </script>    <script>    const SUPABASE_URL = 'https://nlgldaqtubrlcqddppbq.supabase.co';    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5sZ2xkYXF0dWJybGNxZGRwcGJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwODkzMzksImV4cCI6MjA2ODY2NTMzOX0.IFaWqep1MBSofARiCUuzvAReC44hwGnmKOMNSd55nIM';    let allChains = [];    (async function() {        try {            // User feedback provided via UI            // Fetch prerequisite relationships            const response = await fetch(                `${SUPABASE_URL}/rest/v1/graphrag_relationships?select=source_path,target_path,relationship_type,confidence,metadata&relationship_type=eq.prerequisite&confidence=gte.0.85&order=confidence.desc&limit=100`,                { headers: { 'apikey': SUPABASE_KEY, 'Authorization': `Bearer ${SUPABASE_KEY}` } }            );            const relationships = await response.json();            console.log(`‚úÖ Found ${relationships.length} prerequisite relationships`);            // Get unique paths            const paths = [...new Set([                ...relationships.map(r => r.source_path),                ...relationships.map(r => r.target_path)            ])];            // Fetch resource details in chunks            const resources = [];            const chunkSize = 20;            for (let i = 0; i < paths.length; i += chunkSize) {                const chunk = paths.slice(i, i + chunkSize);                const pathFilter = chunk.map(p => `"${p}"`).join(',');                const resourceResponse = await fetch(                    `${SUPABASE_URL}/rest/v1/graphrag_resources?select=file_path,title,subject&file_path=in.(${pathFilter})`,                    { headers: { 'apikey': SUPABASE_KEY, 'Authorization': `Bearer ${SUPABASE_KEY}` } }                );                if (resourceResponse.ok) {                    const chunkResources = await resourceResponse.json();                    resources.push(...chunkResources);                }            }            const resourceMap = {};            resources.forEach(r => {                resourceMap[r.file_path] = r;            });            console.log(`‚úÖ Loaded ${resources.length} resource details`);            // Build chains by grouping by unit            const chainsByUnit = {};            relationships.forEach(rel => {                const unit = rel.metadata?.unit || 'general';                if (!chainsByUnit[unit]) {                    chainsByUnit[unit] = [];                }                chainsByUnit[unit].push({                    source: resourceMap[rel.source_path],                    target: resourceMap[rel.target_path],                    confidence: rel.confidence,                    sequence: rel.metadata?.sequence || 0                });            });            // Build ordered chains            allChains = Object.entries(chainsByUnit).map(([unit, links]) => {                const lessons = [];                const seen = new Set();                // Sort by sequence                links.sort((a, b) => a.sequence - b.sequence);                // Build chain                links.forEach(link => {                    if (link.source && !seen.has(link.source.file_path)) {                        lessons.push({                            ...link.source,                            confidence: link.confidence,                            sequence: link.sequence                        });                        seen.add(link.source.file_path);                    }                    if (link.target && !seen.has(link.target.file_path)) {                        lessons.push({                            ...link.target,                            confidence: link.confidence,                            sequence: link.sequence + 1                        });                        seen.add(link.target.file_path);                    }                });                const avgConfidence = links.reduce((sum, l) => sum + l.confidence, 0) / links.length;                return {                    unit: formatUnitName(unit),                    unitKey: unit,                    lessons: lessons,                    avgConfidence: avgConfidence,                    isPerfect: avgConfidence === 1.0,                    totalSteps: lessons.length                };            }).filter(chain => chain.lessons.length > 0);            // Sort: perfect chains first, then by length            allChains.sort((a, b) => {                if (a.isPerfect && !b.isPerfect) return -1;                if (!a.isPerfect && b.isPerfect) return 1;                return b.totalSteps - a.totalSteps;            });            displayChains(allChains);        } catch (error) {            // Log to monitoring instead of console
        if (window.posthog) {
            posthog.capture('javascript_error', {
                error: err.message,
                url: window.location.pathname
            }));
        }
        // Show user-friendly message instead of error
        document.getElementById('chains-display').innerHTML = `                <div style="padding: 3rem; color: #ef4444;">                    <div style="font-size: 3rem; ">‚ö†Ô∏è</div>                    <p >Error loading prerequisite chains</p>                    <p style="margin-top: 0.5rem;">${error.message}</p>                </div>            `;        }    })();    function formatUnitName(unit) {        return unit            .replace(/_/g, ' ')            .replace(/\b\w/g, c => c.toUpperCase())            .replace('Y8', 'Year 8')            .replace('Y7', 'Year 7');    }    function displayChains(chains) {        const container = document.getElementById('chains-display');        if (chains.length === 0) {            container.innerHTML = `                <div style="padding: 3rem; color: #64748b;">                    <div style="font-size: 3rem; ">üîç</div>                    <p>No chains match your search</p>                </div>            `;            return;        }        container.innerHTML = chains.map(chain => `            <div class="chain-card ${chain.isPerfect ? 'perfect-chain' : ''}">                <div style="justify-content: space-between; align-items: start; margin-bottom: 1.5rem;">                    <div>                        <h2 class="m-0" style="color: #0f172a; margin: 0 0 0.5rem 0;"${chain.unit}</h2>                        <div style="color: #64748b; ">                            ${chain.isPerfect ? '‚≠ê Perfect Chain' : 'High-Confidence Chain'} ¬∑ ${chain.totalSteps} lessons                        </div>                    </div>                    <span class="confidence-badge" style="background: ${chain.isPerfect ? '#10b981' : '#3b82f6'};">                        ${Math.round(chain.avgConfidence * 100)}% Confidence                    </span>                </div>                <div >                    ${chain.lessons.map((lesson, idx) => `                        <div class="lesson-node">                            <div class="lesson-title">                                ${idx + 1}. ${lesson.title || 'Lesson ' + (idx + 1)}                            </div>                            <div class="lesson-meta">                                ${lesson.subject || 'General'} ${lesson.confidence === 1 ? '¬∑ ‚úÖ Perfect prerequisite' : ''}                            </div>                        </div>                    `).join('')}                </div>                <div class="chain-stats">                    <div class="stat">                        <div class="stat-value">${chain.totalSteps}</div>                        <div class="stat-label">Total Lessons</div>                    </div>                    <div class="stat">                        <div class="stat-value">${Math.round(chain.avgConfidence * 100)}%</div>                        <div class="stat-label">Avg Confidence</div>                    </div>                    <div class="stat">                        <div class="stat-value">${chain.lessons.filter(l => l.confidence === 1).length}</div>                        <div class="stat-label">Perfect Links</div>                    </div>                </div>            </div>        `).join('');        console.log(`‚úÖ Displayed ${chains.length} prerequisite chains`);    }    function filterChains() {        const search = document.getElementById('search-input').value.toLowerCase();        if (!search) {            displayChains(allChains);            return;        }        const filtered = allChains.filter(chain => {            const unitMatch = chain.unit.toLowerCase().includes(search);            const lessonMatch = chain.lessons.some(l =>                l.title?.toLowerCase().includes(search) ||                l.subject?.toLowerCase().includes(search)            );            return unitMatch || lessonMatch;        });        displayChains(filtered);    }    </script><!-- üìä ULTIMATE BEAUTY: PostHog Analytics (Privacy-First) --><script src="/js/posthog-analytics.js" defer></script></body></html>
<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>GraphRAG Relationship Builder | Add Missing Connections | Te Kete Ako</title>    <!-- üé® ULTIMATE BEAUTY SYSTEM - Te Kete Ako Design Excellence -->     <link rel="stylesheet" href="/css/te-kete-professional.css">

    
    
       <!-- END ULTIMATE BEAUTY SYSTEM --><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>    <style>        .builder-hero {            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 50%, #ec4899 100%);            color: white;            padding: 4rem 2rem;            text-align: center;        }        .relationship-form {            background: white;            border-radius: 16px;            padding: 3rem;            box-shadow: 0 8px 30px rgba(0,0,0,0.1);            max-width: 900px;            margin: 3rem auto;        }        .form-group {            margin-bottom: 2rem;        }        .form-group label {            display: block;            font-weight: 700;            color: #1a4d2e;            margin-bottom: 0.5rem;        }        .form-group input, .form-group select, .form-group textarea {            width: 100%;            padding: 1rem;            border: 2px solid #e5e7eb;            border-radius: 8px;            font-size: 1rem;        }        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {            outline: none;            border-color: #7c3aed;        }        .btn-create {            background: linear-gradient(135deg, #10b981, #059669);            color: white;            padding: 1rem 2rem;            border: none;            border-radius: 8px;            font-size: 1.1rem;            font-weight: 700;            cursor: pointer;            transition: all 0.3s;        }        .btn-create:hover {            transform: translateY(-2px);            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.3);        }        .missing-relationships {            background: linear-gradient(135deg, #fef3c7, #fde68a);            padding: 2rem;            border-radius: 12px;            margin: 2rem 0;            border-left: 6px solid #d97706;        }        .suggestion-card {            background: white;            padding: 1.5rem;            border-radius: 8px;            margin: 1rem 0;            box-shadow: 0 2px 8px rgba(0,0,0,0.05);        }    </style><!-- Professional Design System --></head><body class="pattern-koru-subtle">    <!-- Navigation -->    <div id="nav-container"></div>    <script>        fetch('/components/navigation-standard.html')            .then(r => r.text())            .then(html => document.getElementById('nav-container').innerHTML = html);    </script>    <!-- Hero -->    <section class="builder-hero">        <h1 style="font-size: 4rem; margin-bottom: 1rem; font-weight: 800;">üîß GraphRAG Relationship Builder</h1>        <p style="font-size: 1.5rem; opacity: 0.95; max-width: 800px; margin: 0 auto;">            Add missing pedagogical relationships to strengthen the knowledge graph        </p>        <div style="background: rgba(255,255,255,0.15); padding: 1.5rem; border-radius: 12px; max-width: 600px; margin: 2rem auto;">            <div style="font-size: 2.5rem; font-weight: 800;">Only 4!</div>            <div style="font-size: 1rem; opacity: 0.9;">builds_on & applies_to relationships exist</div>            <div style="font-size: 0.9rem; opacity: 0.8; margin-top: 0.5rem;">Let's fix that! üöÄ</div>        </div>    </section>    <main style="max-width: 1200px; margin: 3rem auto; padding: 0 2rem;">        <!-- Missing Relationships Alert -->        <div class="missing-relationships">            <h2 style="color: #92400e; font-size: 1.75rem; margin-bottom: 1rem;">                ‚ö†Ô∏è GraphRAG Analysis: Critical Gaps Found            </h2>            <p style="color: #78350f; line-height: 1.8; margin-bottom: 1.5rem;">                Our knowledge graph has <strong>231,469 relationships</strong>, but key pedagogical                relationship types are severely underutilized:            </p>            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">                <div style="background: white; padding: 1.5rem; border-radius: 8px;">                    <div style="font-size: 2rem; color: #dc2626; font-weight: 800;">2</div>                    <div style="color: #666;">"builds_on" relationships</div>                </div>                <div style="background: white; padding: 1.5rem; border-radius: 8px;">                    <div style="font-size: 2rem; color: #dc2626; font-weight: 800;">2</div>                    <div style="color: #666;">"applies_to" relationships</div>                </div>                <div style="background: white; padding: 1.5rem; border-radius: 8px;">                    <div style="font-size: 2rem; color: #10b981; font-weight: 800;">849</div>                    <div style="color: #666;">"prerequisite" (well used!)</div>                </div>            </div>        </div>        <!-- AI Suggestions -->        <section style="margin: 3rem 0;">            <h2 style="font-size: 2rem; color: #1a4d2e; margin-bottom: 1.5rem;">                ü§ñ AI-Suggested Relationships to Create            </h2>            <div class="suggestion-card">                <div style="display: flex; justify-content: space-between; align-items: start;">                    <div style="flex: 1;">                        <h3 style="color: #7c3aed; font-size: 1.25rem; margin-bottom: 0.5rem;">builds_on</h3>                        <p style="color: #666; margin-bottom: 1rem;">                            <strong>From:</strong> Geometric Patterns in MƒÅori Art<br>                            <strong>To:</strong> Y9 Geometry Unit<br>                            <strong>Confidence:</strong> 0.92 (High)                        </p>                        <p style="color: #546e7a; font-size: 0.9rem; font-style: italic;">                            "The handout introduces concepts that the full unit builds upon"                        </p>                    </div>                    <button onclick="createRelationship('builds_on', '/generated-resources-alpha/handouts/geometric-patterns-in-mƒÅori-art-and-architecture.html', '/public/units/y9-maths-geometry-patterns/index.html', 0.92)"                        style="background: #10b981; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 600; cursor: pointer;">                        ‚úÖ Create                    </button>                </div>            </div>            <div class="suggestion-card">                <div style="display: flex; justify-content: space-between; align-items: start;">                    <div style="flex: 1;">                        <h3 style="color: #7c3aed; font-size: 1.25rem; margin-bottom: 0.5rem;">applies_to</h3>                        <p style="color: #666; margin-bottom: 1rem;">                            <strong>From:</strong> Scientific Method via MƒÅori Practices<br>                            <strong>To:</strong> All science lessons (unit_contains_lesson)<br>                            <strong>Confidence:</strong> 0.88 (High)                        </p>                        <p style="color: #546e7a; font-size: 0.9rem; font-style: italic;">                            "This methodology applies across all scientific inquiry lessons"                        </p>                    </div>                    <button onclick="createMultipleRelationships('applies_to', '/generated-resources-alpha/lessons/scientific-method-using-traditional-mƒÅori-practices.html')"                        style="background: #10b981; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 600; cursor: pointer;">                        ‚úÖ Bulk Create                    </button>                </div>            </div>            <div class="suggestion-card">                <div style="display: flex; justify-content: space-between; align-items: start;">                    <div style="flex: 1;">                        <h3 style="color: #7c3aed; font-size: 1.25rem; margin-bottom: 0.5rem;">builds_on</h3>                        <p style="color: #666; margin-bottom: 1rem;">                            <strong>From:</strong> Algebraic Thinking in MƒÅori Games<br>                            <strong>To:</strong> Y7 Algebra Unit<br>                            <strong>Confidence:</strong> 0.89 (High)                        </p>                        <p style="color: #546e7a; font-size: 0.9rem; font-style: italic;">                            "Cultural applications build on foundational algebra concepts"                        </p>                    </div>                    <button onclick="createRelationship('builds_on', '/generated-resources-alpha/handouts/algebraic-thinking-in-traditional-mƒÅori-games.html', '/public/units/y7-maths-algebra/index.html', 0.89)"                        style="background: #10b981; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 600; cursor: pointer;">                        ‚úÖ Create                    </button>                </div>            </div>        </section>        <!-- Manual Creation Form -->        <div class="relationship-form">            <h2 style="color: #1a4d2e; font-size: 2rem; margin-bottom: 2rem; text-align: center;">                ‚ûï Create Custom Relationship            </h2>            <form id="relationship-form">                <div class="form-group">                    <label>Relationship Type</label>                    <select id="rel-type" required>                        <option value="">Select type...</option>                        <option value="builds_on">builds_on - Concept development</option>                        <option value="applies_to">applies_to - Practical application</option>                        <option value="extends_concept">extends_concept - Advanced extension</option>                        <option value="contrasts_with">contrasts_with - Compare & contrast</option>                        <option value="prerequisite">prerequisite - Required before</option>                        <option value="related_content">related_content - Thematically similar</option>                        <option value="shared_cultural_element">shared_cultural_element - Cultural connection</option>                    </select>                </div>                <div class="form-group">                    <label>Source Resource Path</label>                    <input type="text" id="source-path" placeholder="/public/generated-resources-alpha/lessons/..." required>                    <small style="color: #666;">The resource that this relationship starts from</small>                </div>                <div class="form-group">                    <label>Target Resource Path</label>                    <input type="text" id="target-path" placeholder="/public/units/..." required>                    <small style="color: #666;">The resource that this relationship points to</small>                </div>                <div class="form-group">                    <label>Confidence Score (0.0 - 1.0)</label>                    <input type="number" id="confidence" min="0" max="1" step="0.01" value="0.85" required>                    <small style="color: #666;">How confident are you in this connection?</small>                </div>                <div class="form-group">                    <label>Reasoning (Optional)</label>                    <textarea id="reasoning" rows="3" placeholder="Why these resources should be connected..."></textarea>                </div>                <button type="submit" class="btn-create" style="width: 100%;">                    üîó Create Relationship in GraphRAG                </button>            </form>            <div id="result-message" style="margin-top: 2rem; padding: 1rem; border-radius: 8px; display: none;"></div>        </div>        <!-- Recent Additions -->        <section style="margin: 3rem 0;">            <h2 style="font-size: 2rem; color: #1a4d2e; margin-bottom: 1.5rem; text-align: center;">                üìä Recently Created Relationships            </h2>            <div id="recent-relationships" style="max-width: 900px; margin: 0 auto;">                <p style="text-align: center; color: #666;">Loading...</p>            </div>        </section>    </main>    <script>        const SUPABASE_URL = 'https://nlgldaqtubrlcqddppbq.supabase.co';        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5sZ2xkYXF0dWJybGNxZGRwcGJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwODkzMzksImV4cCI6MjA2ODY2NTMzOX0.IFaWqep1MBSofARiCUuzvAReC44hwGnmKOMNSd55nIM';        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);        // Pre-fill suggestions        async function createRelationship(type, source, target, confidence) {            try {                const { data, error } = await supabase                    .from('graphrag_relationships')                    .insert([{                        relationship_type: type,                        source_path: source,                        target_path: target,                        confidence: confidence,                        metadata: {                            created_by: 'graphrag_relationship_builder',                            created_at: new Date().toISOString(),                            auto_generated: false                        }                    }])                    .select();                if (error) throw error;                showMessage(`‚úÖ Created ${type} relationship! Graph updated.`, 'success');                loadRecentRelationships();            } catch (error) {                showMessage(`‚ùå Error: ${error.message}`, 'error');            }        }        // Form submission        document.getElementById('relationship-form').addEventListener('submit', async (e) => {            e.preventDefault();            const type = document.getElementById('rel-type').value;            const source = document.getElementById('source-path').value;            const target = document.getElementById('target-path').value;            const confidence = parseFloat(document.getElementById('confidence').value);            const reasoning = document.getElementById('reasoning').value;            try {                const { data, error } = await supabase                    .from('graphrag_relationships')                    .insert([{                        relationship_type: type,                        source_path: source,                        target_path: target,                        confidence: confidence,                        metadata: {                            created_by: 'manual_entry',                            created_at: new Date().toISOString(),                            reasoning: reasoning || null                        }                    }])                    .select();                if (error) throw error;                showMessage(`‚úÖ Successfully created ${type} relationship!`, 'success');                e.target.reset();                loadRecentRelationships();            } catch (error) {                showMessage(`‚ùå Error: ${error.message}`, 'error');            }        });        // Show message        function showMessage(text, type) {            const msgDiv = document.getElementById('result-message');            msgDiv.textContent = text;            msgDiv.style.display = 'block';            msgDiv.style.background = type === 'success' ? '#dcfce7' : '#fee2e2';            msgDiv.style.color = type === 'success' ? '#166534' : '#991b1b';            msgDiv.style.fontWeight = '600';        }        // Load recent relationships        async function loadRecentRelationships() {            try {                const { data, error } = await supabase                    .from('graphrag_relationships')                    .select('*')                    .in('relationship_type', ['builds_on', 'applies_to', 'extends_concept', 'contrasts_with'])                    .order('created_at', { ascending: false })                    .limit(10);                if (error) throw error;                const container = document.getElementById('recent-relationships');                if (!data || data.length === 0) {                    container.innerHTML = '<p style="text-align: center; color: #666;">No recent relationships of these types found.</p>';                    return;                }                container.innerHTML = data.map(rel => `                    <div class="suggestion-card">                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.75rem;">                            <span style="background: #dbeafe; color: #1e40af; padding: 0.5rem 1rem; border-radius: 20px; font-weight: 700; font-size: 0.85rem;">                                ${rel.relationship_type}                            </span>                            <span style="background: #dcfce7; color: #166534; padding: 0.5rem 1rem; border-radius: 20px; font-weight: 700; font-size: 0.85rem;">                                Confidence: ${(rel.confidence * 100).toFixed(0)}%                            </span>                        </div>                        <div style="color: #1f2937; font-weight: 600; margin-bottom: 0.5rem;">                            ${rel.source_path.split('/').pop().replace('.html', '')}                        </div>                        <div style="text-align: center; color: #7c3aed; margin: 0.5rem 0;">‚Üì</div>                        <div style="color: #1f2937; font-weight: 600;">                            ${rel.target_path.split('/').pop().replace('.html', '')}                        </div>                    </div>                `).join('');            } catch (error) {                console.error('Error loading recent relationships:', error);            }        }        // Load on page load        document.addEventListener('DOMContentLoaded', loadRecentRelationships);    </script><!-- üé® ULTIMATE BEAUTY SYSTEM: Complete UX --><!-- Footer --><div id="footer-container"></div><script>  fetch('/components/footer.html').then(r=>r.text()).then(html=>{    document.getElementById('footer-container').innerHTML=html;  });</script><!-- Mobile Navigation --><div id="mobile-nav-bottom"></div><script>  fetch('/components/mobile-bottom-nav.html').then(r=>r.text()).then(html=>{    document.getElementById('mobile-nav-bottom').innerHTML=html;  });</script><!-- Floating Action Button (Help) --><div id="fab-quick-actions"></div><script>  fetch('/components/quick-actions-fab.html').then(r=>r.text()).then(html=>{    document.getElementById('fab-quick-actions').innerHTML=html;  });</script><!-- üé® ULTIMATE BEAUTY: Framer Cultural Gestures --><script src="/js/framer-cultural-gestures-ultimate.js" defer></script><!-- üìä ULTIMATE BEAUTY: PostHog Analytics (Privacy-First) --><script src="/js/posthog-analytics.js" defer></script></body></html>
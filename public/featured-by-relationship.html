<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browse by Relationship Type | Te Kete Ako</title>
    <meta name="description" content="Discover resources by how they connect - 5,324 relationships">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/css/te-kete-professional.css">
    <link rel="stylesheet" href="/css/component-library.css">
    <link rel="stylesheet" href="/css/enhanced-cards.css">
    
    <style>
        .browse-hero {
            background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);
            color: white;
            padding: 4rem 2rem;
            text-align: center;
        }
        
        .relationship-type-card {
            background: white;
            padding: 2.5rem;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin-bottom: 2rem;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 6px solid #14b8a6;
        }
        
        .relationship-type-card:hover {
            transform: translateX(8px);
            box-shadow: 0 8px 24px rgba(20,184,166,0.2);
        }
        
        .count-bubble {
            background: #14b8a6;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 800;
            float: right;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <div id="nav-container"></div>
    <script>
        fetch('/components/navigation-standard.html')
            .then(r => r.text())
            .then(html => document.getElementById('nav-container').innerHTML = html);
    </script>
    
    <!-- Hero -->
    <section class="browse-hero">
        <h1 style="font-size: 4rem; margin-bottom: 1rem; font-weight: 800;">ðŸ”— Browse by Connection Type</h1>
        <p style="font-size: 1.5rem; opacity: 0.95;">
            Discover how our 25,861 resources connect
        </p>
    </section>
    
    <main style="max-width: 1000px; margin: 3rem auto; padding: 0 2rem;">
        
        <div id="relationship-types-list">
            <div style="text-align: center; padding: 4rem; color: #888;">
                <p>Loading relationship types...</p>
            </div>
        </div>
        
    </main>
    
    <!-- Footer -->
    <div id="footer-container"></div>
    <script>
        fetch('/components/footer.html').then(r=>r.text()).then(html=>{
            document.getElementById('footer-container').innerHTML=html;
        });
    </script>
    
    <script>
        // Load relationship types from GraphRAG
        async function loadRelationshipTypes() {
            try {
                const url = 'https://nlgldaqtubrlcqddppbq.supabase.co/rest/v1/graphrag_relationships';
                const headers = {
                    'apikey': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5sZ2xkYXF0dWJybGNxZGRwcGJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwODkzMzksImV4cCI6MjA2ODY2NTMzOX0.IFaWqep1MBSofARiCUuzvAReC44hwGnmKOMNSd55nIM',
                    'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5sZ2xkYXF0dWJybGNxZGRwcGJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwODkzMzksImV4cCI6MjA2ODY2NTMzOX0.IFaWqep1MBSofARiCUuzvAReC44hwGnmKOMNSd55nIM'
                };
                
                // Get all relationships and count by type
                const response = await fetch(`${url}?select=relationship_type`, { headers });
                const all = await response.json();
                
                const typeCounts = {};
                all.forEach(r => {
                    const type = r.relationship_type;
                    typeCounts[type] = (typeCounts[type] || 0) + 1;
                });
                
                displayTypes(typeCounts);
                
            } catch (error) {
                console.error('Error loading types:', error);
            }
        }
        
        const typeDescriptions = {
            'same_subject': 'Resources in the same subject area - great for finding related content',
            'same_year_level': 'Resources for the same year level - perfect for unit planning',
            'has_handout': 'Resources with accompanying handouts - ready-to-print materials',
            'lesson_has_handout': 'Lessons paired with handouts - complete lesson packages',
            'unit_contains_lesson': 'Units and their lessons - structured curriculum pathways',
            'has_interactive_game': 'Resources with interactive games - engage students',
            'prerequisite': 'Learning progressions - what to teach first',
            'has_assessment': 'Resources with assessments - measure student progress',
            'related_content': 'Related materials - expand your teaching'
        };
        
        function displayTypes(typeCounts) {
            const container = document.getElementById('relationship-types-list');
            
            const sorted = Object.entries(typeCounts).sort((a, b) => b[1] - a[1]);
            
            const html = sorted.map(([type, count]) => `
                <div class="relationship-type-card" onclick="window.location.href='/browse-relationships.html?type=${type}'">
                    <div class="count-bubble">${count}</div>
                    <h2 style="color: #1a4d2e; margin-bottom: 1rem; font-size: 1.75rem;">
                        ${type.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}
                    </h2>
                    <p style="color: #546e7a; line-height: 1.7;">
                        ${typeDescriptions[type] || 'Explore these connected resources'}
                    </p>
                    <div style="margin-top: 1.5rem; color: #14b8a6; font-weight: 600;">
                        Browse ${count} connections â†’
                    </div>
                </div>
            `).join('');
            
            container.innerHTML = html;
        }
        
        document.addEventListener('DOMContentLoaded', loadRelationshipTypes);
    </script>
</body>
</html>


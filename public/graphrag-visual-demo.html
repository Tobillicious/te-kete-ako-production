<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>GraphRAG Knowledge Graph Visualization | Te Kete Ako</title>    <meta name="description" content="Interactive visualization of 19,737 resources connected by 231,469 AI-discovered relationships"><!-- Professional Design System -->    <!-- 🎨 ULTIMATE BEAUTY SYSTEM - Te Kete Ako Design Excellence -->     <link rel="stylesheet" href="/css/te-kete-professional.css">
<link rel="stylesheet" href="/css/te-kete-ultimate-beauty-system.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/mobile-revolution.css">
    <link rel="stylesheet" href="/css/print.css" media="print"> <script src="https://cdn.tailwindcss.com"></script> <script src="/tailwind.config.ultimate.js"></script> <!-- END ULTIMATE BEAUTY SYSTEM --></head><body class="pattern-koru-subtle">    <!-- Navigation -->    <div id="nav-container"></div>    <script>        fetch('/components/navigation-standard.html')            .then(r => r.text())            .then(html => document.getElementById('nav-container').innerHTML = html);    </script>    <!-- Hero -->    <section class="viz-hero">        <div style="max-width: 1000px; margin: 0 auto;">            <div style="font-size: 4rem; margin-bottom: 1rem;">🧠🔗</div>            <h1 style="font-size: 3.5rem; margin-bottom: 1rem; font-weight: 800;">GraphRAG Knowledge Graph</h1>            <p style="font-size: 1.3rem; opacity: 0.95;">                Watch AI-discovered connections come alive            </p>        </div>    </section>    <main style="max-width: 1400px; margin: 3rem auto; padding: 0 2rem;">        <!-- Real-time Stats -->        <div class="stats-grid">            <div class="stat-card">                <div class="stat-number" id="stat-resources">19,737</div>                <div style="color: #666; margin-top: 0.5rem;">Total Resources</div>            </div>            <div class="stat-card">                <div class="stat-number" id="stat-relationships">231,469</div>                <div style="color: #666; margin-top: 0.5rem;">Knowledge Relationships</div>            </div>            <div class="stat-card">                <div class="stat-number" id="stat-subjects">12+</div>                <div style="color: #666; margin-top: 0.5rem;">Subject Areas</div>            </div>            <div class="stat-card">                <div class="stat-number" id="stat-cultural">8,421</div>                <div style="color: #666; margin-top: 0.5rem;">Cultural Resources</div>            </div>        </div>        <!-- Graph Visualization -->        <section style="margin: 3rem 0;">            <h2 style="text-align: center; font-size: 2.5rem; color: #1a4d2e; margin-bottom: 1rem;">                🌐 Live Knowledge Graph            </h2>            <p style="text-align: center; color: #666; margin-bottom: 2rem;">                Real connections from the GraphRAG database • Click nodes to explore            </p>            <div class="controls">                <button class="btn btn-primary" onclick="loadSubjectGraph('Science')">🔬 Science</button>                <button class="btn btn-primary" onclick="loadSubjectGraph('Mathematics')">📊 Mathematics</button>                <button class="btn btn-primary" onclick="loadSubjectGraph('English')">📝 English</button>                <button class="btn btn-primary" onclick="loadCulturalGraph()">🌿 Cultural Connections</button>                <button class="btn btn-primary" onclick="loadCrossSubject()">🔗 Cross-Curricular</button>            </div>            <div id="graph-container">                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">                    <div style="font-size: 3rem; margin-bottom: 1rem;">🧠</div>                    <p style="color: #666; font-size: 1.2rem;">Select a view above to visualize the knowledge graph</p>                </div>            </div>        </section>        <!-- Info Panel -->        <div class="info-panel">            <h3 style="font-size: 1.8rem; color: #7c3aed; margin-bottom: 1rem;">                How GraphRAG Works            </h3>            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-top: 2rem;">                <div>                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">🔍</div>                    <h4 style="color: #1a4d2e; font-weight: 700; margin-bottom: 0.5rem;">1. Analysis</h4>                    <p style="color: #666;">AI analyzes every resource, extracting topics, concepts, and cultural elements</p>                </div>                <div>                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">🔗</div>                    <h4 style="color: #1a4d2e; font-weight: 700; margin-bottom: 0.5rem;">2. Connection</h4>                    <p style="color: #666;">Discovers 231,469 relationships including prerequisites, cultural links, and cross-curricular connections</p>                </div>                <div>                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">🎯</div>                    <h4 style="color: #1a4d2e; font-weight: 700; margin-bottom: 0.5rem;">3. Recommendation</h4>                    <p style="color: #666;">Powers personalized learning pathways and smart resource suggestions</p>                </div>            </div>            <div style="background: linear-gradient(135deg, #f0fdf4, #dcfce7); padding: 1.5rem; border-radius: 12px; margin-top: 2rem;">                <h4 style="color: #166534; font-weight: 700; margin-bottom: 0.5rem;">🌟 Real Data, Real Impact</h4>                <p style="color: #047857;">                    Every connection you see is discovered by AI analyzing actual content. This isn't a concept—it's working right now across Te Kete Ako, helping students and teachers discover connections they never knew existed.                </p>            </div>        </div>        <!-- Relationship Types -->        <section style="margin: 4rem 0;">            <h2 style="text-align: center; font-size: 2.5rem; color: #1a4d2e; margin-bottom: 3rem;">                📊 Relationship Types in GraphRAG            </h2>            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">                <div style="background: #e0f2fe; padding: 1.5rem; border-radius: 12px;">                    <h4 style="color: #075985; font-weight: 700; margin-bottom: 0.5rem;">📚 Same Subject</h4>                    <div style="font-size: 1.5rem; font-weight: 800; color: #0891b2; margin: 0.5rem 0;">52,765</div>                    <p style="color: #0c4a6e; font-size: 0.9rem;">Resources in the same subject area</p>                </div>                <div style="background: #f0fdf4; padding: 1.5rem; border-radius: 12px;">                    <h4 style="color: #166534; font-weight: 700; margin-bottom: 0.5rem;">🌿 Cultural Elements</h4>                    <div style="font-size: 1.5rem; font-weight: 800; color: #10b981; margin: 0.5rem 0;">5,062</div>                    <p style="color: #065f46; font-size: 0.9rem;">Shared Māori cultural concepts</p>                </div>                <div style="background: #fef3c7; padding: 1.5rem; border-radius: 12px;">                    <h4 style="color: #92400e; font-weight: 700; margin-bottom: 0.5rem;">🔗 Cross-Curricular</h4>                    <div style="font-size: 1.5rem; font-weight: 800; color: #f59e0b; margin: 0.5rem 0;">1,200</div>                    <p style="color: #78350f; font-size: 0.9rem;">Connections across subjects</p>                </div>                <div style="background: #f3e8ff; padding: 1.5rem; border-radius: 12px;">                    <h4 style="color: #5b21b6; font-weight: 700; margin-bottom: 0.5rem;">📋 Prerequisites</h4>                    <div style="font-size: 1.5rem; font-weight: 800; color: #7c3aed; margin: 0.5rem 0;">849</div>                    <p style="color: #6b21a8; font-size: 0.9rem;">Learning progression chains</p>                </div>            </div>        </section>    </main>    <!-- Footer -->    <div id="footer-container"></div>    <script>        fetch('/components/footer.html').then(r=>r.text()).then(html=>{            document.getElementById('footer-container').innerHTML=html;        });    </script>    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>    <script>        const SUPABASE_URL = 'https://nlgldaqtubrlcqddppbq.supabase.co';        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5sZ2xkYXF0dWJybGNxZGRwcGJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY5ODgxMTksImV4cCI6MjA1MjU2NDExOX0.gN5RGe7kGmxj4-yI1xnDuCuKUPFDh4f-8CQqQdqrGq0';        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);        const subjectColors = {            'Science': '#0891b2',            'Mathematics': '#0284c7',            'English': '#dc2626',            'Social Studies': '#059669',            'History': '#7c3aed',            'Health & PE': '#f97316',            'Arts': '#ec4899',            'default': '#6b7280'        };        async function loadSubjectGraph(subject) {            const container = document.getElementById('graph-container');            container.innerHTML = '<div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;"><div style="font-size: 3rem;">⏳</div><p style="color: #666;">Loading ' + subject + ' knowledge graph...</p></div>';            try {                // Get top resources in this subject                const { data: resources, error } = await supabase                    .from('graphrag_resources')                    .select('*')                    .eq('subject', subject)                    .gte('quality_score', 70)                    .order('quality_score', { ascending: false })                    .limit(15);                if (error) throw error;                // Get relationships between these resources                const paths = resources.map(r => r.file_path);                const { data: relationships, error: relError } = await supabase                    .from('graphrag_relationships')                    .select('*')                    .in('source_path', paths)                    .in('target_path', paths)                    .gte('confidence', 0.75)                    .limit(30);                if (relError) throw relError;                visualizeGraph(resources, relationships, subject);            } catch (error) {                console.error('Error loading graph:', error);                container.innerHTML = '<div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;"><div style="font-size: 3rem;">❌</div><p style="color: #dc2626;">Error loading graph</p></div>';            }        }        async function loadCulturalGraph() {            const container = document.getElementById('graph-container');            container.innerHTML = '<div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;"><div style="font-size: 3rem;">⏳</div><p style="color: #666;">Loading cultural connections...</p></div>';            try {                // Get resources with cultural elements                const { data: resources, error } = await supabase                    .from('graphrag_resources')                    .select('*')                    .eq('cultural_context', true)                    .gte('quality_score', 80)                    .order('quality_score', { ascending: false })                    .limit(15);                if (error) throw error;                const paths = resources.map(r => r.file_path);                const { data: relationships, error: relError } = await supabase                    .from('graphrag_relationships')                    .select('*')                    .eq('relationship_type', 'shared_cultural_element')                    .in('source_path', paths)                    .in('target_path', paths)                    .limit(30);                if (relError) throw relError;                visualizeGraph(resources, relationships, 'Cultural');            } catch (error) {                console.error('Error loading cultural graph:', error);            }        }        async function loadCrossSubject() {            const container = document.getElementById('graph-container');            container.innerHTML = '<div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;"><div style="font-size: 3rem;">⏳</div><p style="color: #666;">Loading cross-curricular connections...</p></div>';            try {                // Get cross-curricular relationships                const { data: relationships, error } = await supabase                    .from('graphrag_relationships')                    .select(`                        *,                        source:source_path(title, subject),                        target:target_path(title, subject)                    `)                    .eq('relationship_type', 'cross_curricular_link')                    .gte('confidence', 0.85)                    .limit(20);                if (error) {                    // Fallback: manual query                    const { data: rels } = await supabase                        .from('graphrag_relationships')                        .select('*')                        .eq('relationship_type', 'cross_curricular_link')                        .gte('confidence', 0.85)                        .limit(20);                    if (rels) {                        container.innerHTML = `                            <div style="padding: 2rem; overflow-y: auto; height: 100%;">                                <h3 style="color: #7c3aed; margin-bottom: 1rem;">Cross-Curricular Connections (${rels.length} found)</h3>                                ${rels.map(rel => `                                    <div style="background: white; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #7c3aed;">                                        <div style="font-weight: 700; color: #1a4d2e;">${rel.source_path.split('/').pop()}</div>                                        <div style="color: #666; font-size: 0.9rem;">↔️ ${rel.target_path.split('/').pop()}</div>                                        <div style="color: #7c3aed; font-size: 0.85rem; margin-top: 0.5rem;">Confidence: ${Math.round(rel.confidence * 100)}%</div>                                    </div>                                `).join('')}                            </div>                        `;                    }                    return;                }                // Extract unique resources                const resourcesMap = new Map();                relationships.forEach(rel => {                    if (rel.source) resourcesMap.set(rel.source_path, rel.source);                    if (rel.target) resourcesMap.set(rel.target_path, rel.target);                });                const resources = Array.from(resourcesMap.values());                visualizeGraph(resources, relationships, 'Cross-Curricular');            } catch (error) {                console.error('Error loading cross-subject graph:', error);            }        }        function visualizeGraph(resources, relationships, label) {            const container = document.getElementById('graph-container');            container.innerHTML = '';            const width = container.clientWidth;            const height = container.clientHeight;            const centerX = width / 2;            const centerY = height / 2;            const radius = Math.min(width, height) * 0.35;            // Position nodes in a circle            const nodes = resources.map((resource, i) => {                const angle = (i / resources.length) * 2 * Math.PI;                return {                    x: centerX + radius * Math.cos(angle),                    y: centerY + radius * Math.sin(angle),                    resource: resource,                    color: subjectColors[resource.subject] || subjectColors.default                };            });            // Draw edges            relationships.forEach(rel => {                const sourceNode = nodes.find(n => n.resource.file_path === rel.source_path);                const targetNode = nodes.find(n => n.resource.file_path === rel.target_path);                if (sourceNode && targetNode) {                    const edge = document.createElement('div');                    edge.className = 'edge';                    const dx = targetNode.x - sourceNode.x;                    const dy = targetNode.y - sourceNode.y;                    const length = Math.sqrt(dx * dx + dy * dy);                    const angle = Math.atan2(dy, dx) * 180 / Math.PI;                    edge.style.width = length + 'px';                    edge.style.left = sourceNode.x + 'px';                    edge.style.top = sourceNode.y + 'px';                    edge.style.transform = `rotate(${angle}deg)`;                    edge.style.opacity = rel.confidence || 0.5;                    container.appendChild(edge);                }            });            // Draw nodes            nodes.forEach(node => {                const nodeEl = document.createElement('div');                nodeEl.className = 'node';                nodeEl.style.width = '80px';                nodeEl.style.height = '80px';                nodeEl.style.left = (node.x - 40) + 'px';                nodeEl.style.top = (node.y - 40) + 'px';                nodeEl.style.background = node.color;                nodeEl.style.color = 'white';                nodeEl.textContent = node.resource.subject || '?';                nodeEl.title = node.resource.title;                nodeEl.addEventListener('click', () => {                    if (node.resource.file_path) {                        window.location.href = node.resource.file_path;                    }                });                container.appendChild(nodeEl);            });            // Add info overlay            const info = document.createElement('div');            info.style.cssText = 'position: absolute; top: 20px; left: 20px; background: rgba(255,255,255,0.95); padding: 1rem; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);';            info.innerHTML = `                <div style="font-weight: 700; color: #7c3aed; margin-bottom: 0.5rem;">${label} Knowledge Graph</div>                <div style="font-size: 0.9rem; color: #666;">${resources.length} resources • ${relationships.length} connections</div>            `;            container.appendChild(info);        }        console.log('🧠 GraphRAG Visual Demo loaded!');    </script><!-- 📊 ULTIMATE BEAUTY: PostHog Analytics (Privacy-First) --><script src="/js/posthog-analytics.js" defer></script></body></html>
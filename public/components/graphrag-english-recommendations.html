<!-- GraphRAG English Recommendations Component --><section id="graphrag-english-recommendations" class="relative" >    <!-- Animated Background Pattern -->    <div class="absolute" data:image/svg+xml,%3Csvg width='80' height='80' xmlns='http://www.w3.org/2000/svg'%3E%3Ctext x='20' y='50' font-size='48' fill='white' font-family='serif' font-style='italic'%3E\"%3C/text%3E%3C/svg%3E\"); background-repeat: repeat; animation: drift 30s linear infinite;"></div>    <div class="max-w-6xl mx-auto relative" >        <div class="text-center" >            <div class="inline-block mb-4 shadow-lg" >                <span class="font-bold text-xs" >üß† GRAPHRAG INTELLIGENCE</span>            </div>            <h2 class="mb-4 font-extrabold" >                Discover English Resources            </h2>            <p class="text-base" >                Powered by <strong>231,469 knowledge graph relationships</strong>            </p>            <p class="text-sm mx-auto" >                AI-curated from 19,737 resources across the platform            </p>        </div>        <div id="graphrag-english-container" class="grid" >            <!-- Loading State -->            <div class="text-center" >                <div style="border: 4px solid rgba(255,255,255,0.3); border-top: 4px solid white; border-radius: 50%; width: 60px; height: 60px; animation: spin 1s linear infinite; margin: 0 auto 1.5rem;"></div>                <p class="text-sm" >Loading intelligent English recommendations...</p>            </div>        </div>        <div class="text-center" >            <a href="/advanced-search-graphrag.html" class="inline-block bg-white rounded-xl font-bold text-sm shadow-lg" >                üîç Explore Full GraphRAG Search ‚Üí            </a>        </div>    </div></section><style>@keyframes spin {    0% { transform: rotate(0deg); }    100% { transform: rotate(360deg); }}@keyframes drift {    0% { transform: translateX(0); }    100% { transform: translateX(-80px); }}@keyframes fadeInUp {    from { opacity: 0; transform: translateY(30px); }    to { opacity: 1; transform: translateY(0); }}.english-resource-card {    animation: fadeInUp 0.6s ease-out forwards;    opacity: 0;}</style><script>(async function() {    const SUPABASE_URL = 'https://nlgldaqtubrlcqddppbq.supabase.co';    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5sZ2xkYXF0dWJybGNxZGRwcGJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwODkzMzksImV4cCI6MjA2ODY2NTMzOX0.IFaWqep1MBSofARiCUuzvAReC44hwGnmKOMNSd55nIM';    try {        const url = `${SUPABASE_URL}/rest/v1/graphrag_resources`;        const headers = {            'apikey': SUPABASE_ANON_KEY,            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`        };        // Query for high-quality English resources        const queryParams = new URLSearchParams({            select: 'file_path,title,resource_type,subject,quality_score,cultural_context,year_level,has_te_reo,has_whakataukƒ´',            or: '(subject.ilike.%english%,title.ilike.%english%,title.ilike.%writing%,title.ilike.%literacy%,title.ilike.%poetry%,title.ilike.%narrative%,title.ilike.%argumentative%,file_path.ilike.%english%,file_path.ilike.%writing%)',            quality_score: 'gte.88',            order: 'quality_score.desc,cultural_context.desc',            limit: 30        });        const response = await fetch(`${url}?${queryParams}`, { headers });        if (!response.ok) {            throw new Error(`HTTP ${response.status}`);        }        const resources = await response.json();        console.log(`‚úçÔ∏è GraphRAG English: Loaded ${resources.length} premium resources (quality ‚â•88)`);        if (!resources || resources.length === 0) {            document.getElementById('graphrag-english-container').innerHTML = `                <div class="text-center" >                    <p class="text-sm" >üîÆ Discovering new English resources...</p>                    <p class="text-xs" >The knowledge graph is still being indexed!</p>                </div>            `;            return;        }        // Categorize resources        const units = resources.filter(r =>            (r.file_path?.includes('/units/') && r.subject?.toLowerCase().includes('english')) ||            r.resource_type?.toLowerCase().includes('unit')        );        const lessons = resources.filter(r =>            (r.resource_type?.toLowerCase().includes('lesson') || r.file_path?.includes('/lessons/')) &&            !units.includes(r)        );        const handouts = resources.filter(r =>            r.resource_type?.toLowerCase().includes('handout') &&            !units.includes(r) && !lessons.includes(r)        );        const writersToolkit = resources.filter(r =>            r.title?.toLowerCase().includes("writer's toolkit") ||            r.title?.toLowerCase().includes("writers toolkit")        );        // Render categories        const container = document.getElementById('graphrag-english-container');        let html = '';        // Show Writer's Toolkit first (featured collection)        if (writersToolkit.length > 0) {            html += `                <div class="mb-4" >                    <h3 class="mb-2 flex" >                        <span>‚úçÔ∏è</span> The Writer's Toolkit (${writersToolkit.length})                    </h3>                    <p class="mb-4" >Essential skills handouts for developing strong writers</p>                </div>            `;            writersToolkit.forEach((resource, index) => {                html += createResourceCard(resource, '#f59e0b', index * 0.08);            });        }        // Show units        if (units.length > 0) {            html += `                <div class="mb-4" >                    <h3 class="mb-2 flex" >                        <span>üìö</span> Complete English Units (${units.length})                    </h3>                </div>            `;            units.slice(0, 6).forEach((resource, index) => {                html += createResourceCard(resource, '#10b981', (writersToolkit.length + index) * 0.08);            });        }        // Show lessons        if (lessons.length > 0) {            html += `                <div class="mb-4" >                    <h3 class="mb-2 flex" >                        <span>üéì</span> Full Lesson Plans (${lessons.length})                    </h3>                </div>            `;            lessons.slice(0, 8).forEach((resource, index) => {                html += createResourceCard(resource, '#3b82f6', (writersToolkit.length + units.length + index) * 0.08);            });        }        // Show handouts (excluding Writer's Toolkit)        const otherHandouts = handouts.filter(h => !writersToolkit.includes(h));        if (otherHandouts.length > 0) {            html += `                <div class="mb-4" >                    <h3 class="mb-2 flex" >                        <span>üìÑ</span> Print-Ready Handouts (${otherHandouts.length})                    </h3>                </div>            `;            otherHandouts.slice(0, 6).forEach((resource, index) => {                html += createResourceCard(resource, '#8b5cf6', (writersToolkit.length + units.length + lessons.length + index) * 0.08);            });        }        container.innerHTML = html;    } catch (error) {        // Log to monitoring instead of console
        if (window.posthog) {
            posthog.capture('error', {
        message: '$2',
        details: $3,
        url: window.location.pathname
    });
        }
        // Show user-friendly message instead of error
        document.getElementById('graphrag-english-container').innerHTML = `            <div class="text-center" >                <p class="text-sm" >üí° GraphRAG temporarily unavailable</p>                <p class="text-xs" >Browse our curated collections above</p>            </div>        `;    }    function createResourceCard(resource, accentColor, delay) {        const culturalBadge = resource.cultural_context ?            '<span class="rounded-md font-semibold" ><span>üåø</span> Cultural</span>' : '';        const teReoBadge = resource.has_te_reo ?            '<span class="rounded-md font-semibold" >Te Reo</span>' : '';        const whakataukiBadge = resource.has_whakataukƒ´ ?            '<span class="rounded-md font-semibold" >Whakataukƒ´</span>' : '';        const yearBadge = resource.year_level ?            `<span class="rounded-md font-semibold" >${resource.year_level}</span>` : '';        // Emoji mapping for resource types        const typeEmoji = {            'unit': 'üìö',            'lesson': 'üéì',            'handout': 'üìÑ',            'interactive': 'üéÆ',            'page': 'üìñ'        };        const emoji = typeEmoji[resource.resource_type?.toLowerCase()] || '‚úçÔ∏è';        return `            <a href="${resource.file_path}"               class="english-resource-card p-6 rounded-2xl block" onmouseover="this.style.transform='translateY(-6px) scale(1.02)'; this.style.boxShadow='0 8px 24px rgba(0,0,0,0.4)'; this.style.borderColor='${accentColor}';"               onmouseout="this.style.transform=''; this.style.boxShadow='0 4px 16px rgba(0,0,0,0.3)'; this.style.borderColor='rgba(255,255,255,0.1)';">                <div class="flex mb-4" >                    <div class="flex" >                        ${culturalBadge}                        ${teReoBadge}                        ${whakataukiBadge}                        ${yearBadge}                    </div>                    <span class="rounded-lg font-bold shadow-md" >                        <span>‚≠ê</span> ${resource.quality_score || 95}                    </span>                </div>                <div class="flex" >                    <div style="font-size: 2rem; line-height: 1;">${emoji}</div>                    <h4 class="font-bold m-0" >                        ${resource.title}                    </h4>                </div>                <p class="text-xs m-0 flex" >                    <span class="rounded-md font-semibold" >                        ${resource.resource_type || 'Resource'}                    </span>                    ${resource.subject ? `<span style="opacity: 0.7;">‚Ä¢</span> <span>${resource.subject}</span>` : ''}                </p>            </a>        `;    }})();</script>
<!-- ðŸŽ¯ ASSIGN RESOURCE BUTTON - Teacher Workflow --><!-- Add this to any resource page to let teachers assign it --><button id="assign-resource-btn" class="assign-btn" class="p-3" style="    color: white;    border: none;    padding: 0.75rem 1.5rem;    cursor: pointer;    align-items: center;    gap: 0.5rem;    transition: all 0.2s ease;    "    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>        <circle cx="9" cy="7" r="4"></circle>        <line x1="19" y1="8" x2="19" y2="14"></line>        <line x1="22" y1="11" x2="16" y2="11"></line>    </svg>    Assign to Students</button><!-- Assignment Modal --><div id="assign-modal" style="    display: none;    top: 0;    left: 0;    right: 0;    bottom: 0;    background: rgba(0,0,0,0.7);    z-index: 10000;    align-items: center;    justify-content: center;">    <div style="        width: 90%;        box-shadow: 0 8px 32px rgba(0,0,0,0.2);    ">        <h2 class="m-0" style="margin: 0 0 1.5rem 0; "ðŸ“š Assign This Resource</h2>        <form id="assign-form">            <div >                <label style="color: #374151;">                    Assignment Title                </label>                <input type="text" id="assignment-title" required placeholder="e.g., Y8 Algebra Homework">            </div>            <div >                <label style="color: #374151;">                    Class/Students                </label>                <input type="text" id="assignment-class" required placeholder="e.g., 8B Math, All Year 9">                <small style="color: #6b7280; font-size: 0.875rem;">                    (Full class management coming soon - for now, enter class name)                </small>            </div>            <div >                <label style="color: #374151;">                    Due Date (Optional)                </label>                <input type="date" id="assignment-due-date" >            </div>            <div style="margin-bottom: 1.5rem;">                <label style="color: #374151;">                    Instructions (Optional)                </label>                <textarea id="assignment-description" rows="3" style="                    resize: vertical;                " placeholder="Additional instructions for students..."></textarea>            </div>            <div style="gap: 1rem;">                <button type="submit" style="                    flex: 1;                    background: #059669;                    color: white;                    border: none;                    cursor: pointer;                ">                    âœ… Assign                </button>                <button type="button" id="cancel-assign" style="                    flex: 1;                    background: #e5e7eb;                    color: #374151;                    border: none;                    cursor: pointer;                ">                    Cancel                </button>            </div>        </form>    </div></div><script>(async function() {    const assignBtn = document.getElementById('assign-resource-btn');    const modal = document.getElementById('assign-modal');    const form = document.getElementById('assign-form');    const cancelBtn = document.getElementById('cancel-assign');    // Check if user is a teacher    const supabase = window.supabaseClient || window.getSupabaseClient();    if (!supabase) {        assignBtn.style.display = 'none';        return;    }    const { data: { user } } = await supabase.auth.getUser();    if (!user) {        assignBtn.style.display = 'none';        return;    }    // Check if teacher    const { data: profile } = await supabase        .from('profiles')        .select('role')        .eq('user_id', user.id)        .single();    if (profile?.role !== 'teacher' && profile?.role !== 'admin') {        assignBtn.style.display = 'none';        return;    }    // Teacher confirmed - show button    assignBtn.style.display = 'flex';    // Open modal    assignBtn.addEventListener('click', () => {        modal.style.display = 'flex';        // Pre-fill title with page title        document.getElementById('assignment-title').value = document.title.replace(' | Te Kete Ako', '');    });    // Close modal    cancelBtn.addEventListener('click', () => {        modal.style.display = 'none';    });    // Submit assignment    form.addEventListener('submit', async (e) => {        e.preventDefault();        const title = document.getElementById('assignment-title').value;        const className = document.getElementById('assignment-class').value;        const dueDate = document.getElementById('assignment-due-date').value;        const description = document.getElementById('assignment-description').value;        try {            const { data, error } = await supabase                .from('assignments')                .insert({                    teacher_id: user.id,                    title: title,                    description: description,                    resource_path: window.location.pathname,                    resource_type: 'lesson', // Could detect from page                    assigned_to_class: className,                    due_date: dueDate || null                })                .select();            if (error) throw error;            // Success!            modal.style.display = 'none';            form.reset();            // Show confirmation            const toast = document.createElement('div');            toast.style.cssText = 'bottom:20px;right:20px;background:#059669;color:white;padding:1rem 1.5rem;z-index:99999;';            toast.innerHTML = `                <div style="margin-bottom:0.25rem;">âœ… Assignment Created!</div>                <div style="font-size:0.875rem;opacity:0.9;">${className} can now see this in their dashboard</div>            `;            document.body.appendChild(toast);            setTimeout(() => toast.remove(), 4000);        } catch (err) {            alert('Error creating assignment: ' + err.message);        }    });})();</script>
<!DOCTYPE html>
<html lang="en">
<head>
 <!-- Performance: Optimize rendering -->
 <meta name="format-detection" content="telephone=no">
 <meta name="theme-color" content="#1b4332">
 <meta name="color-scheme" content="light">
 <!-- Performance: DNS prefetch for external domains -->
 <link rel="dns-prefetch" href="//fonts.googleapis.com">
 <link rel="dns-prefetch" href="//fonts.gstatic.com">
 <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
 <!-- Performance: Preload critical resources -->
 <link rel="stylesheet" href="/components/badge-system.html">
 
 <link rel="preload" href="/js/te-kete-professional.js" as="script">
 <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Lato:wght@300;400;700&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300;1,400&display=swap&display=swap" as="style" crossorigin>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <meta name="description" content="Te Kete Ako - Award-winning educational platform integrating mātauranga Māori with contemporary learning">
 <meta name="keywords" content="education, māori, indigenous, ai, learning, new zealand">
 <meta name="author" content="Te Kete Ako">
<!-- Professional Design System -->
<link rel="stylesheet" href="/css/te-kete-professional.css"> <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Countdown Letters: Te Reo Māori | Te Kete Ako</title>
 
 
 
 
 
 
 <script src="/js/breadcrumbs.js" defer></script>

 <!-- 🎨 ULTIMATE BEAUTY SYSTEM - Te Kete Ako Design Excellence -->
 <link rel="stylesheet" href="/css/te-kete-ultimate-beauty-system.css">
 <script src="https://cdn.tailwindcss.com"></script>
 <script src="/tailwind.config.ultimate.js"></script>
 <!-- END ULTIMATE BEAUTY SYSTEM -->
</head>

<body class="pattern-koru-subtle">
 <header class="site-header no-print">
 <div class="nav-container">
 <a href="/index.html" class="nav-brand">Te Kete Ako</a>
 <nav class="main-nav">
 <ul>
 <li>
 <a href="/unit-plans.html">
 <span class="nav-icon">📚</span>
 <span class="nav-text-en">Unit Plans</span>
 <span class="nav-text-mi" lang="mi">Ngā Waehere</span>
 </a>
 </li>
 <li>
 <a href="/teachers/index.html">
 <span class="nav-icon">🧑‍🏫</span>
 <span class="nav-text-en">Teachers</span>
 <span class="nav-text-mi" lang="mi">Ngā Kaiako</span>
 </a>
 </li>
 <li>
 <a href="/lessons.html">
 <span class="nav-icon">🎓</span>
 <span class="nav-text-en">Lessons</span>
 <span class="nav-text-mi" lang="mi">Ngā Akoranga</span>
 </a>
 </li>
 <li>
 <a href="/handouts.html">
 <span class="nav-icon">📄</span>
 <span class="nav-text-en">Handouts</span>
 <span class="nav-text-mi" lang="mi">Ngā Rauemi</span>
 </a>
 </li>
 <li>
 <a href="/games.html">
 <span class="nav-icon">🎮</span>
 <span class="nav-text-en">Games</span>
 <span class="nav-text-mi" lang="mi">Ngā Kēmu</span> 
 </a>
 </li>
 <li class="auth-nav my-kete-link" style="display: none;">
 <a href="/my-kete.html">
 <span class="nav-icon">🧺</span>
 My Kete
 </a>
 </li>
 <li class="auth-nav">
 <a href="/login.html" class="login-btn">
 <span class="nav-icon">👤</span>
 Login
 </a>
 </li>
 <li class="auth-nav" style="display: none;">
 <a href="/register-simple.html" class="register-btn">
 <span class="nav-icon">📝</span>
 Register
 </a>
 </li>
 </ul>
 </nav>
 <nav class="breadcrumbs no-print" aria-label="Breadcrumb">
 <ol id="breadcrumbs" class="breadcrumbs-list"></ol>
 </nav>
 </div>
 </header>
 <div id="search-container"></div>

 <div class="mobile-nav-overlay" id="mobileNavOverlay" onclick="closeMobileNav()"></div>

 <div class="main-container">
 <aside class="left-sidebar no-print">
 <div class="sidebar-widget">
 <h3 class="sidebar-widget-title">Game Navigation</h3>
 <ul>
 <li><a href="/games.html">← Back to All Games</a></li>
 <li><a href="/te-reo-wordle.html">Te Reo Māori Wordle</a></li>
 <li><button onclick="showInstructions()" class="link-button">How to Play</button></li>
 <li><button onclick="newGame()" class="link-button">New Game</button></li>
 </ul>
 </div>
 

 <div class="sidebar-widget cultural-accent">
 <h3 class="sidebar-widget-title">Whakataukī</h3>
 <p style="font-style: italic; color: var(--color-secondary);">"Kōrero Māori, kia roa ai"</p>
 <p style="font-size: var(--text-sm);">Speak Māori, that it may continue</p>
 </div>

 <div class="sidebar-widget">
 <h3 class="sidebar-widget-title">Scoring Guide</h3>
 <ul style="font-size: var(--text-sm);">
 <li><strong>3-4 letters:</strong> 1 point</li>
 <li><strong>5-6 letters:</strong> 2 points</li>
 <li><strong>7-8 letters:</strong> 5 points</li>
 <li><strong>9 letters:</strong> 18 points!</li>
 <li><strong>Te Reo Māori:</strong> Double points!</li>
 </ul>
 </div>
 </aside>

 <main role="main" class="content-area">
 <div class="game-container">
 <div class="game-header">
 <h1 class="game-title" class="wiley-hero-title">Countdown Letters</h1>
 <p class="game-subtitle">Build the longest words from 9 letters - Te Reo Māori earns double points!</p>
 <p class="daily-challenge" style="background: var(--color-accent); color: white; padding: 0.5rem 1rem; border-radius: 20px; font-weight: bold; margin-top: 1rem; display: inline-block;">
 🎯 Daily Challenge: Find the hidden 9-letter word for 50 bonus points!
 </p>
 </div>

 <div class="timer-container">
 <div class="timer-section">
 <div class="timer" id="timer">30</div>
 <div class="timer-label">seconds remaining</div>
 </div>
 <div class="game-status">
 <button class="btn" id="startBtn" onclick="startGame()">Start Game</button>
 <button class="btn secondary" id="pauseBtn" onclick="pauseGame()" style="display: none;">Pause</button>
 </div>
 </div>

 <div class="letters-container">
 <h3>Available Letters</h3>
 <div class="letters-grid" id="lettersGrid">
 <!-- Letters will be generated by JavaScript -->
 </div>
 </div>

 <div class="word-building">
 <h3>Build Your Word</h3>
 <div class="current-word" id="currentWord">Click letters to build words</div>
 <div class="word-controls">
 <button class="btn secondary" onclick="clearWord()">Clear</button>
 <button class="btn" onclick="submitWord()">Submit Word</button>
 <button class="btn secondary" onclick="shuffleLetters()">Shuffle Letters</button>
 </div>
 </div>

 <div id="message"></div>

 <div class="score-container">
 <div class="score-item">
 <div class="score-number" id="totalScore">0</div>
 <div class="score-label">Total Points</div>
 </div>
 <div class="score-item">
 <div class="score-number" id="wordsFound">0</div>
 <div class="score-label">Words Found</div>
 </div>
 <div class="score-item">
 <div class="score-number" id="longestWord">0</div>
 <div class="score-label">Longest Word</div>
 </div>
 <div class="score-item">
 <div class="score-number" id="maoriWords">0</div>
 <div class="score-label">Te Reo Māori</div>
 </div>
 </div>

 <div class="target-words">
 <h4>🎯 Challenge Goals</h4>
 <p>Can you find the 9-letter word? Look for Te Reo Māori words for double points!</p>
 <p><strong>Hint:</strong> Common Māori word endings: -NGA, -AKI, -ARA, -URU</p>
 </div>

 <div class="words-found">
 <h3>Words Found</h3>
 <div class="words-grid">
 <div class="word-category">
 <div class="category-title">Short Words (3-4 letters)</div>
 <div id="shortWords"></div>
 </div>
 <div class="word-category">
 <div class="category-title">Medium Words (5-6 letters)</div>
 <div id="mediumWords"></div>
 </div>
 <div class="word-category">
 <div class="category-title">Long Words (7+ letters)</div>
 <div id="longWords"></div>
 </div>
 <div class="word-category">
 <div class="category-title">Te Reo Māori (Double Points!)</div>
 <div id="maoriWordsFound"></div>
 </div>
 </div>
 </div>

 <div class="game-instructions">
 <h4>How to Play:</h4>
 <ol>
 <li>Click <strong>Start Game</strong> to begin the 30-second timer</li>
 <li>Click letters to build words (minimum 3 letters)</li>
 <li>Submit words before time runs out</li>
 <li>Te Reo Māori words earn <strong>double points</strong>!</li>
 <li>Try to find the longest possible word</li>
 </ol>
 </div>
 </div>
 </main>
 </div>
 
 <!-- External Resources Section - Added by Te Kete Ako Content Enrichment -->
 <section class="external-resources-section no-print" style="border-left: 4px solid var(--color-maori-red, #CC0000); background: linear-gradient(135deg, #f0f8f4 0%, #e8f5e8 100%); padding: var(--space-6); margin: var(--space-8) 0; border-radius: var(--radius-lg);">
 <h3 style="margin: 0 0 1rem 0; color: var(--color-primary, #2E8B57); display: flex; align-items: center; gap: 0.5rem;">
 <span style="font-size: 1.5rem;">🌿</span>
 Nga Rauemi Tauwehe - External Resources
 </h3>
 <p style="margin: 0 0 1.5rem 0; color: var(--color-text-secondary, #666); font-size: var(--text-sm);">
 High-quality resources from official New Zealand education sites to extend and enrich this learning content.
 </p>
 <div class="external-resources-list">
 
 <div class="external-resource-item" style="margin: var(--space-4) 0; padding: var(--space-4); background: white; border-radius: var(--radius-md); box-shadow: 0 2px 4px var(--shadow-md);">
 <h4 style="margin: 0 0 0.5rem 0; color: var(--color-primary, #2E8B57);">
 <a href="https://www.sciencelearn.org.nz/" target="_blank" rel="noopener noreferrer" style="text-decoration: none; color: inherit;">
 Science Learning Hub
 </a>
 </h4>
 <p style="margin: 0.5rem 0; color: var(--color-text-secondary, #666); font-size: var(--text-sm); line-height: 1.4;">
 Over 11,550 NZ science education resources for teachers, students and community
 </p>
 <div class="flex">
 <div class="flex">
 <span style="background: var(--color-accent, #DAA520); color: white; padding: 0.25rem 0.5rem; border-radius: var(--radius-lg); font-size: 0.75rem;">
 Years: 1-13
 </span>
 <span style="background: var(--color-secondary, #FF6B35); color: white; padding: 0.25rem 0.5rem; border-radius: var(--radius-lg); font-size: 0.75rem;">
 60% Match
 </span>
 <span style="background: var(--color-primary, #2E8B57); color: white; padding: 0.25rem 0.5rem; border-radius: var(--radius-lg); font-size: 0.75rem;"> 
 Official NZ Resource
 </span>
 </div>
 </div>
 </div>
 <div class="external-resource-item" style="margin: var(--space-4) 0; padding: var(--space-4); background: white; border-radius: var(--radius-md); box-shadow: 0 2px 4px var(--shadow-md);">
 <h4 style="margin: 0 0 0.5rem 0; color: var(--color-primary, #2E8B57);">
 <a href="https://tahurangi.education.govt.nz/" target="_blank" rel="noopener noreferrer" style="text-decoration: none; color: inherit;">
 Tāhūrangi - Te Reo Māori Education Hub
 </a>
 </h4>
 <p style="margin: 0.5rem 0; color: var(--color-text-secondary, #666); font-size: var(--text-sm); line-height: 1.4;">
 Official NZ government hub for te reo Māori resources, guidance, and teaching support
 </p>
 <div class="flex">
 <div class="flex">
 <span style="background: var(--color-accent, #DAA520); color: white; padding: 0.25rem 0.5rem; border-radius: var(--radius-lg); font-size: 0.75rem;">
 Years: 7-13
 </span>
 <span style="background: var(--color-secondary, #FF6B35); color: white; padding: 0.25rem 0.5rem; border-radius: var(--radius-lg); font-size: 0.75rem;">
 40% Match
 </span>
 <span style="background: var(--color-primary, #2E8B57); color: white; padding: 0.25rem 0.5rem; border-radius: var(--radius-lg); font-size: 0.75rem;"> 
 Official NZ Resource
 </span>
 </div>
 </div>
 </div>
 <div class="external-resource-item" style="margin: var(--space-4) 0; padding: var(--space-4); background: white; border-radius: var(--radius-md); box-shadow: 0 2px 4px var(--shadow-md);">
 <h4 style="margin: 0 0 0.5rem 0; color: var(--color-primary, #2E8B57);">
 <a href="https://newzealandcurriculum.tahurangi.education.govt.nz/5637157326.c" target="_blank" rel="noopener noreferrer" style="text-decoration: none; color: inherit;">
 Te Reo Māori - The New Zealand Curriculum
 </a>
 </h4>
 <p style="margin: 0.5rem 0; color: var(--color-text-secondary, #666); font-size: var(--text-sm); line-height: 1.4;">
 Official curriculum guidelines for teaching te reo Māori in English-medium schools
 </p>
 <div class="flex">
 <div class="flex">
 <span style="background: var(--color-accent, #DAA520); color: white; padding: 0.25rem 0.5rem; border-radius: var(--radius-lg); font-size: 0.75rem;">
 Years: 1-13
 </span>
 <span style="background: var(--color-secondary, #FF6B35); color: white; padding: 0.25rem 0.5rem; border-radius: var(--radius-lg); font-size: 0.75rem;">
 32% Match
 </span>
 <span style="background: var(--color-primary, #2E8B57); color: white; padding: 0.25rem 0.5rem; border-radius: var(--radius-lg); font-size: 0.75rem;"> 
 Official NZ Resource
 </span>
 </div>
 </div>
 </div>
 </div>
 <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #ddd; font-size: 0.8rem; color: var(--color-text-muted, #888);">
 <p style="margin: 0;">
 🤖 <em>These resources were automatically curated by Te Kete Ako's AI system to complement this content. 
 All external links lead to official New Zealand educational and government websites.</em>
 </p>
 </div>
 </section>

 <section class="cultural-integration" style="background: linear-gradient(135deg, #fff7ed, #ffedd5); padding: 2rem; border-radius: 12px; margin: 2rem 0; border-left: 4px solid var(--color-accent); box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
 <h2 style="color: var(--color-primary); margin-top: 0; display: flex; align-items: center; gap: 0.5rem;">
 <span>🌿</span>
 <span>Cultural Context | Horopaki Ahurea</span>
 </h2>
 
 <div class="whakatauaki-section" style="background: white; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem; text-align: center; border: 2px solid var(--color-accent);">
 <h3 style="font-size: 0.9rem; color: var(--color-text-secondary); margin: 0 0 0.5rem; text-transform: uppercase; letter-spacing: 1px;">Whakataukī</h3>
 <p style="font-size: 1.3rem; font-style: italic; color: var(--color-primary); margin: 0.5rem 0; font-weight: 500;">"Ko te akoranga te pūtake o te ora"</p>
 <p style="font-size: 1rem; color: var(--color-text-secondary); margin: 0.5rem 0;">"Education is the foundation of wellbeing"</p>
 </div>
 
 <div class="house-values" style="background: white; padding: 1.5rem; border-radius: 8px;">
 <h3 style="font-size: 1rem; color: var(--color-primary); margin-top: 0;">🏛️ Connection to Mangakōtukutuku College Values</h3>
 <div style="background: rgba(241, 143, 1, 0.1); padding: 1rem; border-radius: 6px; border-left: 3px solid var(--color-accent);">
 <p style="margin: 0; font-size: 0.95rem;">
 <strong style="color: var(--color-accent); text-transform: capitalize;">Whaiora:</strong> Wellbeing - Caring for collective health and prosperity
 </p>
 <p style="margin: 0.75rem 0 0; font-size: 0.9rem; color: var(--color-text-secondary);">
 This learning connects to the value of <strong>whaiora</strong> by encouraging students to [engage with content in ways that embody this value].
 </p>
 </div>
 </div>
 
 <div class="cultural-safety" style="background: rgba(27, 67, 50, 0.05); padding: 1rem; border-radius: 8px; margin-top: 1rem;">
 <h4 style="font-size: 0.95rem; color: var(--color-primary); margin: 0 0 0.5rem;">🛡️ Cultural Safety Considerations</h4>
 <ul style="font-size: 0.9rem; margin: 0; color: var(--color-text-secondary);">
 <li>Approach Māori content with respect and openness</li>
 <li>Recognize students' diverse cultural backgrounds and experiences</li>
 <li>Create space for Māori students to share their perspectives</li>
 <li>Consult with whānau and local iwi for culturally sensitive topics</li>
 </ul>
 </div>
 </section>



 <footer class="site-footer no-print">
 <div class="footer-content">
 <div class="footer-simple">
 <div class="footer-brand">
 <h3>🧺 Te Kete Ako</h3>
 <p>"Whaowhia te kete mātauranga" - Fill the basket of knowledge</p>
 </div>
 <div class="footer-links">
 <a href="/unit-plans.html">Unit Plans</a>
 <a href="/lessons.html">Lessons</a>
 <a href="/handouts.html">Handouts</a>
 <a href="/my-kete.html">My Kete</a>
 <a href="/sitemap.html">Sitemap</a>
 <a href="/orphans.html">Discover</a>
 </div>
 </div>
 <div class="footer-bottom">
 <span>© 2025 Te Kete Ako - Educational resources for Aotearoa New Zealand</span>
 </div>
 </div>
 </footer>

 <!-- Enhanced game dependencies -->
 <script src="/js/maori-dictionary-api.js"></script>
 <script src="/js/gamification-system.js"></script>
 <script src="/js/adaptive-difficulty-system.js"></script>
 
 <script>
 // Game state
 let gameLetters = [];
 let currentWord = '';
 let selectedLetters = [];
 let foundWords = [];
 let score = 0;
 let gameTime = 30;
 let gameTimer = null;
 let gameActive = false;
 let gamePaused = false;
 
 // Enhanced features
 let wordDefinitions = new Map();
 let pronunciationEnabled = true;

 // Te Reo Māori word lists for scoring
 const MAORI_WORDS = [
 // Common 3-4 letter words
 'kai', 'poi', 'hui', 'iwi', 'tui', 'moa', 'kia', 'ana', 'awa', 'ika',
 'kai', 'mea', 'nei', 'pai', 'tao', 'tau', 'uri', 'wai', 'whā', 'ako',
 'ata', 'hoa', 'hou', 'koe', 'māu', 'noa', 'roa', 'tae', 'tua', 'ura',
 
 // 5-6 letter words
 'aroha', 'kaiako', 'mauri', 'tangi', 'tapu', 'tino', 'wairua', 'whenua',
 'whare', 'mana', 'papa', 'rama', 'roto', 'taha', 'taiao', 'taonga', 'whaea',
 'matua', 'tamariki', 'hapū', 'iwi', 'kura', 'ranga', 'waka', 'mata', 'nuku',
 
 // 7+ letter words
 'whakatōhea', 'rangatiratanga', 'manaakitanga', 'whakapapa', 'kaitiakitanga',
 'whakatōhea', 'tangata', 'tamariki', 'kaumātua', 'wahine', 'tāngata'
 ];

 // Letter frequency for realistic game generation
 const LETTER_FREQUENCIES = {
 'A': 8, 'E': 8, 'I': 7, 'O': 6, 'U': 4, // Māori vowels are common
 'N': 6, 'R': 6, 'T': 6, 'K': 5, 'M': 5, 'W': 5, 'H': 5,
 'G': 4, 'P': 4, 'L': 3, 'S': 3, 'C': 2, 'F': 2,
 'B': 1, 'D': 1, 'J': 1, 'Q': 1, 'V': 1, 'X': 1, 'Y': 1, 'Z': 1
 };

 // Daily puzzle words - 9-letter words with good letter combinations
 const DAILY_PUZZLES = [
 'WHAKATANE', 'AROHANGIA', 'RANGITOTO', 'TAKITAHEA', 'WHAKATERE',
 'NGATIPOROU', 'MAUIWHARE', 'TARANAKI', 'WAIKAMINO', 'TANGIHANG',
 'KAITARARE', 'WHAKANERE', 'TORANGAPA', 'MAIGARETU', 'WAKATOIRE',
 'RANGATAHE', 'WHAKAMANO', 'KAITANGA', 'TEKERATO', 'WAKAMETU'
 ];

 // Get daily puzzle based on date
 function getDailyPuzzle() {
 const today = new Date();
 const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);
 const puzzleIndex = dayOfYear % DAILY_PUZZLES.length;
 return DAILY_PUZZLES[puzzleIndex];
 }

 // Generate letters for daily puzzle
 function generateLetters() {
 const dailyWord = getDailyPuzzle();
 const letters = dailyWord.split('');
 
 // Shuffle the letters to make it challenging
 for (let i = letters.length - 1; i > 0; i--) {
 const j = Math.floor(Math.random() * (i + 1));
 [letters[i], letters[j]] = [letters[j], letters[i]];
 }
 
 return letters;
 }

 // Check if word uses all 9 letters (the daily word solution)
 function isDailySolution(word) {
 const dailyWord = getDailyPuzzle();
 return word.toUpperCase() === dailyWord;
 }

 // Initialize game with enhanced features
 function initGame() {
 gameLetters = generateLetters();
 selectedLetters = [];
 currentWord = '';
 foundWords = [];
 score = 0;
 gameTime = 30;
 gameActive = false;
 gamePaused = false;
 wordDefinitions.clear();
 
 renderLetters();
 updateDisplay();
 updateTimer();
 
 document.getElementById('startBtn').style.display = 'inline-block';
 document.getElementById('pauseBtn').style.display = 'none';
 
 // Initialize gamification system if available
 if (window.gamificationSystem) {
 window.gamificationSystem.startGameSession('countdown-letters', {
 difficulty: 'medium',
 learningObjectives: ['te-reo-maori', 'word-building', 'cultural-literacy']
 });
 }
 
 // Initialize adaptive difficulty if available
 if (window.adaptiveDifficulty) {
 window.adaptiveDifficulty.startSession('countdown-letters');
 }
 }

 // Render letter tiles
 function renderLetters() {
 const grid = document.getElementById('lettersGrid');
 grid.innerHTML = '';
 
 gameLetters.forEach((letter, index) => {
 const tile = document.createElement('div');
 tile.className = 'letter-tile';
 tile.textContent = letter;
 tile.onclick = () => selectLetter(index);
 tile.id = `letter-${index}`;
 grid.appendChild(tile);
 });
 }

 // Select a letter
 function selectLetter(index) {
 if (!gameActive || gamePaused) return;
 
 const tile = document.getElementById(`letter-${index}`);
 if (tile.classList.contains('used')) return;
 
 selectedLetters.push(index);
 currentWord += gameLetters[index];
 tile.classList.add('selected');
 
 updateCurrentWord();
 }

 // Update current word display
 function updateCurrentWord() {
 document.getElementById('currentWord').textContent = currentWord || 'Click letters to build words';
 }

 // Clear current word
 function clearWord() {
 selectedLetters.forEach(index => {
 const tile = document.getElementById(`letter-${index}`);
 tile.classList.remove('selected');
 tile.classList.remove('used');
 });
 selectedLetters = [];
 currentWord = '';
 updateCurrentWord();
 }

 // Enhanced submit word with API validation and definitions
 async function submitWord() {
 if (!gameActive || currentWord.length < 3) {
 showMessage('Words must be at least 3 letters long!', 'error');
 return;
 }
 
 if (foundWords.find(w => w.word === currentWord.toLowerCase())) {
 showMessage('You already found that word!', 'error');
 clearWord();
 return;
 }
 
 // Enhanced validation with Māori Dictionary API
 let isValidWord = false;
 let isMaori = false;
 let wordDefinition = null;
 
 // Check against predefined lists first
 isMaori = MAORI_WORDS.includes(currentWord.toLowerCase());
 const isEnglish = COMMON_WORDS.includes(currentWord.toLowerCase());
 
 if (isMaori || isEnglish) {
 isValidWord = true;
 } else if (window.maoriDictionaryAPI) {
 // Check with API for additional Māori words
 try {
 const isValidMaori = await window.maoriDictionaryAPI.validateMaoriWord(currentWord.toUpperCase());
 if (isValidMaori) {
 isMaori = true;
 isValidWord = true;
 // Get definition for display
 wordDefinition = await window.maoriDictionaryAPI.getWordDefinition(currentWord.toUpperCase());
 if (wordDefinition) {
 wordDefinitions.set(currentWord.toLowerCase(), wordDefinition);
 }
 }
 } catch (error) {
 
 }
 }
 
 if (!isValidWord) {
 showMessage(`"${currentWord}" is not a valid word. Try again!`, 'error');
 clearWord();
 return;
 }
 
 // Calculate points
 const isDailyWord = isDailySolution(currentWord);
 let points = calculatePoints(currentWord.length);
 
 // Apply bonuses
 if (isMaori) points *= 2;
 if (isDailyWord) points += 50; // Big bonus for the daily solution!
 
 // Add to found words with enhanced data
 const wordObj = {
 word: currentWord.toLowerCase(),
 length: currentWord.length,
 points: points,
 isMaori: isMaori,
 isDailyWord: isDailyWord,
 definition: wordDefinition
 };
 foundWords.push(wordObj);
 score += points;
 
 // Mark letters as used
 selectedLetters.forEach(index => {
 const tile = document.getElementById(`letter-${index}`);
 tile.classList.add('used');
 tile.classList.remove('selected');
 });
 
 // Show success message with definition popup
 let message;
 if (isDailyWord) {
 message = `🎉 DAILY WORD SOLVED! "${currentWord}" - ${points} points (includes 50 bonus points)!`;
 } else if (isMaori) {
 message = `Ka rawe! "${currentWord}" is Te Reo Māori - ${points} points (doubled)!`;
 } else {
 message = `Great! "${currentWord}" - ${points} points!`;
 }
 showMessage(message, 'success');
 
 // Show definition popup if available
 if (wordDefinition) {
 showDefinitionPopup(currentWord, wordDefinition);
 }
 
 // Reset for next word
 selectedLetters = [];
 currentWord = '';
 updateCurrentWord();
 updateDisplay();
 }

 // Calculate points based on word length
 function calculatePoints(length) {
 if (length <= 4) return 1;
 if (length <= 6) return 2;
 if (length <= 8) return 5;
 return 18; // 9-letter word
 }

 // Start game
 function startGame() {
 gameActive = true;
 gamePaused = false;
 gameTime = 30;
 
 document.getElementById('startBtn').style.display = 'none';
 document.getElementById('pauseBtn').style.display = 'inline-block';
 
 gameTimer = setInterval(() => {
 if (!gamePaused) {
 gameTime--;
 updateTimer();
 
 if (gameTime <= 0) {
 endGame();
 }
 }
 }, 1000);
 }

 // Pause game
 function pauseGame() {
 gamePaused = !gamePaused;
 const btn = document.getElementById('pauseBtn');
 btn.textContent = gamePaused ? 'Resume' : 'Pause';
 }

 // End game with enhanced tracking
 function endGame() {
 gameActive = false;
 clearInterval(gameTimer);
 
 document.getElementById('startBtn').style.display = 'inline-block';
 document.getElementById('pauseBtn').style.display = 'none';
 document.getElementById('startBtn').textContent = 'New Game';
 
 // Calculate enhanced stats
 const maoriWordsFound = foundWords.filter(w => w.isMaori).length;
 const dailyWordsFound = foundWords.filter(w => w.isDailyWord).length;
 const averageWordLength = foundWords.length > 0 ? 
 foundWords.reduce((sum, w) => sum + w.length, 0) / foundWords.length : 0;
 
 // Track with gamification system
 if (window.gamificationSystem) {
 window.gamificationSystem.endGameSession({
 score: score,
 wordsFound: foundWords.length,
 maoriWordsFound: maoriWordsFound,
 dailyWordsFound: dailyWordsFound,
 averageWordLength: averageWordLength,
 timeSpent: 30 - gameTime,
 achievements: calculateAchievements(foundWords, score)
 });
 }
 
 // Track with adaptive difficulty
 if (window.adaptiveDifficulty) {
 window.adaptiveDifficulty.recordPerformance({
 gameType: 'countdown-letters',
 score: score,
 accuracy: foundWords.length / Math.max(1, foundWords.length + 5), // Estimate
 timeSpent: 30 - gameTime,
 difficulty: 'medium'
 });
 }
 
 showMessage(`Time's up! Final score: ${score} points with ${foundWords.length} words found (${maoriWordsFound} Māori words).`, 'info');
 }

 // Calculate achievements
 function calculateAchievements(words, score) {
 const achievements = [];
 
 if (words.length >= 10) achievements.push('word-master');
 if (score >= 50) achievements.push('high-scorer');
 if (words.filter(w => w.isMaori).length >= 5) achievements.push('maori-learner');
 if (words.filter(w => w.isDailyWord).length > 0) achievements.push('daily-champion');
 
 return achievements;
 }

 // New game
 function newGame() {
 if (gameTimer) clearInterval(gameTimer);
 initGame();
 document.getElementById('startBtn').textContent = 'Start Game';
 clearMessage();
 }

 // Shuffle letters
 function shuffleLetters() {
 for (let i = gameLetters.length - 1; i > 0; i--) {
 const j = Math.floor(Math.random() * (i + 1));
 [gameLetters[i], gameLetters[j]] = [gameLetters[j], gameLetters[i]];
 }
 renderLetters();
 clearWord();
 }

 // Update timer display
 function updateTimer() {
 document.getElementById('timer').textContent = gameTime;
 }

 // Update score and words display
 function updateDisplay() {
 document.getElementById('totalScore').textContent = score;
 document.getElementById('wordsFound').textContent = foundWords.length;
 
 const longestWordLength = foundWords.length > 0 ? 
 Math.max(...foundWords.map(w => w.length)) : 0;
 document.getElementById('longestWord').textContent = longestWordLength;
 
 const maoriWordCount = foundWords.filter(w => w.isMaori).length;
 document.getElementById('maoriWords').textContent = maoriWordCount;
 
 // Update word lists
 updateWordLists();
 }

 // Update word lists by category
 function updateWordLists() {
 const shortWords = document.getElementById('shortWords');
 const mediumWords = document.getElementById('mediumWords');
 const longWords = document.getElementById('longWords');
 const maoriWordsFound = document.getElementById('maoriWordsFound');
 
 shortWords.innerHTML = '';
 mediumWords.innerHTML = '';
 longWords.innerHTML = '';
 maoriWordsFound.innerHTML = '';
 
 foundWords.forEach(wordObj => {
 const wordDiv = document.createElement('div');
 wordDiv.className = 'found-word';
 wordDiv.innerHTML = `
 <span class="word-text">${wordObj.word.toUpperCase()}</span>
 <span class="word-points">${wordObj.points}pts</span>
 `;
 
 if (wordObj.isMaori) {
 maoriWordsFound.appendChild(wordDiv);
 } else if (wordObj.length <= 4) {
 shortWords.appendChild(wordDiv);
 } else if (wordObj.length <= 6) {
 mediumWords.appendChild(wordDiv);
 } else {
 longWords.appendChild(wordDiv);
 }
 });
 }

 // Show message
 function showMessage(text, type) {
 const messageDiv = document.getElementById('message');
 messageDiv.innerHTML = `<div class="message ${type}">${text}</div>`;
 
 if (type === 'error' || type === 'success') {
 setTimeout(() => {
 messageDiv.innerHTML = '';
 }, 3000);
 }
 }

 // Enhanced definition popup with pronunciation
 function showDefinitionPopup(word, definition) {
 const popup = document.createElement('div');
 popup.className = 'definition-popup';
 popup.style.cssText = `
 position: fixed;
 top: 50%;
 left: 50%;
 transform: translate(-50%, -50%);
 background: white;
 border: 2px solid var(--color-primary);
 border-radius: 12px;
 padding: 2rem;
 box-shadow: 0 8px 32px rgba(0,0,0,0.2);
 z-index: 1000;
 max-width: 500px;
 width: 90%;
 text-align: center;
 `;
 
 popup.innerHTML = `
 <div style="margin-bottom: 1rem;">
 <h3 style="margin: 0 0 1rem 0; color: var(--color-primary); font-size: 1.5rem; display: flex; align-items: center; justify-content: center; gap: 1rem;">
 <span>${word.toUpperCase()}</span>
 <button onclick="speakMaoriWord('${word}', '${definition.pronunciation || ''}')"
 style="background: var(--color-secondary); color: white; border: none; border-radius: 20px; padding: 0.5rem 1rem; cursor: pointer;"
 title="Listen to pronunciation">
 🔊 Whakarongo
 </button>
 </h3>
 <p style="margin: 0 0 1rem 0; font-size: 1.1rem;"><strong>Meaning:</strong> ${definition.meaning}</p>
 ${definition.example ? `<p style="margin: 0 0 1rem 0; font-style: italic;"><strong>Example:</strong> ${definition.example}</p>` : ''}
 ${definition.pronunciation ? `<p style="margin: 0 0 1rem 0; color: var(--color-secondary); font-style: italic;"><strong>Pronunciation:</strong> ${definition.pronunciation}</p>` : ''}
 <div style="margin-top: 1rem; padding: 1rem; background: rgba(184, 134, 11, 0.1); border-radius: 6px; border-left: 4px solid var(--color-secondary);">
 <p style="margin: 0; font-style: italic; color: var(--color-secondary);">
 <strong>🌟 Cultural Note:</strong> Every Te Reo Māori word carries deeper cultural meaning and connects to the rich history and worldview of Māori people.
 </p>
 </div>
 </div>
 <button onclick="closeDefinitionPopup()" 
 style="background: var(--color-primary); color: white; border: none; border-radius: 6px; padding: 0.8rem 1.5rem; cursor: pointer; font-size: 1rem;">
 Ka rawe! (Awesome!)
 </button>
 `;
 
 document.body.appendChild(popup);
 
 // Close on background click
 popup.addEventListener('click', (e) => {
 if (e.target === popup) {
 closeDefinitionPopup();
 }
 });
 }

 // Close definition popup
 function closeDefinitionPopup() {
 const popup = document.querySelector('.definition-popup');
 if (popup) {
 popup.remove();
 }
 }

 // Māori pronunciation using Web Speech API
 function speakMaoriWord(word, pronunciation) {
 if (!pronunciationEnabled) return;
 
 if ('speechSynthesis' in window) {
 const utterance = new SpeechSynthesisUtterance(word);
 utterance.lang = 'mi-NZ'; // Māori language code
 utterance.rate = 0.7; // Slower for learning
 utterance.pitch = 1.0;
 
 // Try to find a Māori voice if available
 const voices = speechSynthesis.getVoices();
 const maoriVoice = voices.find(voice => 
 voice.lang.includes('mi') || 
 voice.name.toLowerCase().includes('maori') ||
 voice.name.toLowerCase().includes('māori')
 );
 
 if (maoriVoice) {
 utterance.voice = maoriVoice;
 }
 
 speechSynthesis.speak(utterance);
 } else {
 
 }
 }

 // Clear message
 function clearMessage() {
 document.getElementById('message').innerHTML = '';
 }

 // Show instructions
 function showInstructions() {
 showMessage('Build words from the 9 letters provided. Te Reo Māori words earn double points! Try to find the longest word possible. You have 30 seconds once you start the timer.', 'info');
 }

 // Initialize game when page loads
 document.addEventListener('DOMContentLoaded', initGame);
 </script>

 <!-- Load Supabase Client -->
 <!-- Load Auth UI -->
 <script>
 // Register service worker for performance
 if ('serviceWorker' in navigator) {
 window.addEventListener('load', () => {
 navigator.serviceWorker.register('/sw.js')
 .then(registration => )
 .catch(error => );
 });
 }
 </script>
 
<!-- 🎨 ULTIMATE BEAUTY SYSTEM: Complete UX -->

<!-- Footer -->
<div id="footer-container"></div>
<script>
  fetch('/components/footer.html').then(r=>r.text()).then(html=>{
    document.getElementById('footer-container').innerHTML=html;
  });
</script>

<!-- Mobile Navigation -->
<div id="mobile-nav-bottom"></div>
<script>
  fetch('/components/mobile-bottom-nav.html').then(r=>r.text()).then(html=>{
    document.getElementById('mobile-nav-bottom').innerHTML=html;
  });
</script>

<!-- Floating Action Button (Help) -->
<div id="fab-quick-actions"></div>
<script>
  fetch('/components/quick-actions-fab.html').then(r=>r.text()).then(html=>{
    document.getElementById('fab-quick-actions').innerHTML=html;
  });
</script>

<!-- 🎨 ULTIMATE BEAUTY: Framer Cultural Gestures -->
<script src="/js/framer-cultural-gestures-ultimate.js" defer></script>


<!-- 📊 ULTIMATE BEAUTY: PostHog Analytics (Privacy-First) -->
<script src="/js/posthog-analytics.js" defer></script>

</body>
</html>
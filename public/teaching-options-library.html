<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Teaching Options Library - Choose from thousands of lesson variants based on your class needs, cultural context, and time available.">
    <title>Teaching Options Library | Te Kete Ako</title>
    
    <!-- CANONICAL CSS SYSTEM -->
    <link rel="stylesheet" href="/css/te-kete-professional.css">
    <link rel="stylesheet" href="/css/component-library.css" />
    <link rel="stylesheet" href="/css/animations-professional.css" />
    <link rel="stylesheet" href="/css/beautiful-navigation.css" />
    <link rel="stylesheet" href="/css/mobile-optimization.css" />
    <link rel="stylesheet" href="/css/cultural-patterns.css" />
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div id="nav-placeholder"></div>
    
    <main class="container">
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <a href="/index.html">Home</a>
            <span>â†’</span>
            <span class="current">Teaching Options Library</span>
        </nav>

        <!-- WhakataukÄ« Cultural Context -->
        <div class="whakataukÄ«-box" style="margin: 2rem 0;">
            <p class="whakataukÄ«-text">
                "MÄ te huruhuru te manu ka rere"
            </p>
            <p class="whakataukÄ«-attribution">
                â€” It is the feathers that enable the bird to fly (With the right tools and support, we soar)
            </p>
        </div>

        <header class="kowhaiwhai-border-top kowhaiwhai-border-bottom" style="background: linear-gradient(135deg, #e0f2fe 0%, #7dd3fc 100%); padding: 4rem 2rem; text-align: center; border-radius: 16px; margin: 2rem 0; position: relative;">
            <div style="display: inline-block; background: rgba(255,255,255,0.3); padding: 0.5rem 1.5rem; border-radius: 24px; margin-bottom: 1rem;">
                <span style="color: #0c4a6e; font-weight: 700; font-size: 0.95rem;">â­ SMART SEARCH</span>
            </div>
            <h1 style="font-size: 3.5rem; color: #0c4a6e; margin-bottom: 1rem; font-weight: 800;">ğŸ¯ Teaching Options Library</h1>
            <p style="font-size: 1.4rem; color: #075985; max-width: 800px; margin: 0 auto;">
                Choose from <strong id="total-variants">20,000+</strong> lesson variants - same content, different approaches!
            </p>
            <p style="margin-top: 1rem; color: #0369a1; font-size: 1.1rem; font-weight: 600;">
                Pick the version that fits YOUR students, YOUR time, YOUR context
            </p>
        </header>

        <!-- Filter Panel -->
        <section style="background: white; padding: 2rem; border-radius: 12px; margin: 2rem 0; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            <h2 style="color: #1a4d2e; margin-bottom: 1.5rem;">ğŸ” Find Your Perfect Teaching Option</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
                <!-- Cultural Integration Filter -->
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #1a4d2e;">
                        ğŸŒ¿ Cultural Integration
                    </label>
                    <select id="filter-cultural" style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                        <option value="">All Levels</option>
                        <option value="high">High (WhakataukÄ«, tikanga, mÄtauranga)</option>
                        <option value="medium">Medium (MÄori context included)</option>
                        <option value="low">Low (Minimal cultural content)</option>
                    </select>
                </div>

                <!-- Resource Type Filter -->
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #1a4d2e;">
                        ğŸ“š Resource Type
                    </label>
                    <select id="filter-type" style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                        <option value="">All Types</option>
                        <option value="lesson">Lessons</option>
                        <option value="handout">Handouts</option>
                        <option value="unit-plan">Unit Plans</option>
                        <option value="game">Games</option>
                        <option value="assessment">Assessments</option>
                    </select>
                </div>

                <!-- Variant Type Filter -->
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #1a4d2e;">
                        ğŸ¨ Variant Type
                    </label>
                    <select id="filter-variant" style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;">
                        <option value="">All Variants</option>
                        <option value="active">Current/Active Version</option>
                        <option value="legacy_css">Legacy CSS (simpler styling)</option>
                        <option value="historical">Historical Archive</option>
                        <option value="timestamped">Timestamped Backup</option>
                    </select>
                </div>

                <!-- Search with Autocomplete -->
                <div style="position: relative;">
                    <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: #1a4d2e;">
                        ğŸ” Search
                    </label>
                    <input type="text" id="search-box" placeholder="Search lessons..." style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem;" autocomplete="off">
                    
                    <!-- Autocomplete suggestions dropdown -->
                    <div id="autocomplete-suggestions" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 2px solid #e5e7eb; border-top: none; border-radius: 0 0 8px 8px; max-height: 300px; overflow-y: auto; z-index: 100; box-shadow: 0 8px 16px rgba(0,0,0,0.1);"></div>
                </div>
            </div>
            
            <!-- Popular Searches -->
            <div style="margin-top: 1rem; padding: 1rem; background: #f0f9ff; border-radius: 8px; border-left: 3px solid #0284c7;">
                <div style="font-weight: 600; color: #0369a1; margin-bottom: 0.75rem; font-size: 0.9rem;">ğŸ”¥ Popular Searches:</div>
                <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                    <button onclick="quickSearch('algebra')" class="quick-search-btn">algebra</button>
                    <button onclick="quickSearch('ecosystem')" class="quick-search-btn">ecosystem</button>
                    <button onclick="quickSearch('statistics')" class="quick-search-btn">statistics</button>
                    <button onclick="quickSearch('digital')" class="quick-search-btn">digital kaitiakitanga</button>
                    <button onclick="quickSearch('whakataukÄ«')" class="quick-search-btn">whakataukÄ«</button>
                    <button onclick="quickSearch('writing')" class="quick-search-btn">writing</button>
                </div>
            </div>

            <div style="margin-top: 1.5rem; text-align: center;">
                <button id="apply-filters" style="background: #1a4d2e; color: white; padding: 1rem 3rem; border: none; border-radius: 8px; font-size: 1.1rem; cursor: pointer; font-weight: 600;">
                    ğŸ¯ Find Teaching Options
                </button>
                <button id="clear-filters" style="background: #6b7280; color: white; padding: 1rem 2rem; border: none; border-radius: 8px; font-size: 1rem; cursor: pointer; margin-left: 1rem;">
                    Clear All
                </button>
            </div>
        </section>

        <!-- Results Section -->
        <section id="results-section" style="margin: 3rem 0;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 style="color: #1a4d2e; margin: 0;">
                    ğŸ“‹ Teaching Options
                    <span id="results-count" style="color: #6b7280; font-size: 1.2rem; font-weight: normal;"></span>
                </h2>
                <div style="color: #6b7280;">
                    <span id="loading-indicator" style="display: none;">â³ Loading...</span>
                </div>
            </div>

            <div id="results-container" style="display: grid; gap: 1.5rem;">
                <!-- Results will be populated here -->
                <div style="text-align: center; padding: 4rem 2rem; color: #6b7280;">
                    <p style="font-size: 1.2rem;">Click "Find Teaching Options" to see available variants</p>
                    <p style="margin-top: 1rem;">Or use the filters above to narrow your search</p>
                </div>
            </div>
        </section>
    </main>

    <div id="footer-placeholder"></div>
    
    <script src="/components/load-components.js"></script>
    <script src="/js/global-scripts.js"></script>
    
    <script>
        // Initialize Supabase
        const SUPABASE_URL = 'https://nlgldaqtubrlcqddppbq.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5sZ2xkYXF0dWJybGNxZGRwcGJxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMwODkzMzksImV4cCI6MjA2ODY2NTMzOX0.IFaWqep1MBSofARiCUuzvAReC44hwGnmKOMNSd55nIM';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        // Load total count on page load
        async function loadTotalCount() {
            const { count } = await supabase
                .from('resources')
                .select('*', { count: 'exact', head: true });
            
            document.getElementById('total-variants').textContent = count.toLocaleString();
        }

        // Search and filter function
        async function findTeachingOptions() {
            const cultural = document.getElementById('filter-cultural').value;
            const type = document.getElementById('filter-type').value;
            const variant = document.getElementById('filter-variant').value;
            const search = document.getElementById('search-box').value;

            document.getElementById('loading-indicator').style.display = 'inline';
            
            let query = supabase.from('resources').select('*');

            // Apply filters
            if (type) {
                query = query.eq('type', type);
            }

            if (cultural) {
                query = query.eq('cultural_elements->>cultural_integration', cultural);
            }

            if (variant) {
                query = query.eq('cultural_elements->>variant_type', variant);
            }

            if (search) {
                query = query.ilike('title', `%${search}%`);
            }

            // Order by recent first, limit to 50 results
            query = query.order('created_at', { ascending: false }).limit(50);

            const { data, error, count } = await query;

            document.getElementById('loading-indicator').style.display = 'none';

            if (error) {
                alert('Error loading results: ' + error.message);
                return;
            }

            displayResults(data);
        }

        // Display results with RICH DETAILS
        function displayResults(resources) {
            const container = document.getElementById('results-container');
            const countSpan = document.getElementById('results-count');
            
            if (!resources || resources.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 3rem; color: #6b7280;"><p style="font-size: 1.2rem;">No teaching options found with these filters</p><p style="margin-top: 1rem;">Try adjusting your search criteria</p></div>';
                countSpan.textContent = '(0 results)';
                return;
            }

            countSpan.textContent = `(${resources.length} results shown)`;
            
            container.innerHTML = resources.map(resource => {
                const cultural = resource.cultural_elements?.cultural_integration || 'unknown';
                const variantType = resource.cultural_elements?.variant_type || 'standard';
                const difficulty = resource.difficulty_level || 'intermediate';
                
                const culturalColor = cultural === 'high' ? '#16a34a' : (cultural === 'medium' ? '#f59e0b' : '#6b7280');
                const culturalBg = cultural === 'high' ? '#dcfce7' : (cultural === 'medium' ? '#fef3c7' : '#f3f4f6');
                const culturalStars = cultural === 'high' ? 'ğŸŒ¿ğŸŒ¿ğŸŒ¿' : (cultural === 'medium' ? 'ğŸŒ¿ğŸŒ¿' : 'ğŸŒ¿');
                
                // Quality score (mock - could be real from metadata)
                const qualityScore = cultural === 'high' ? 95 : (cultural === 'medium' ? 85 : 75);
                
                return `
                    <div class="lesson-card cultural-card" style="background: white; padding: 2rem; border-radius: 16px; border-left: 6px solid ${culturalColor}; box-shadow: 0 6px 16px rgba(0,0,0,0.1); position: relative;">
                        <!-- Quality Badge -->
                        <div style="position: absolute; top: 1rem; right: 1rem;">
                            <span class="gold-standard-badge" style="font-size: 0.8rem; padding: 0.3rem 0.8rem;">
                                â­ ${qualityScore}/100
                            </span>
                        </div>
                        
                        <!-- Title with Cultural Stars -->
                        <div style="margin-bottom: 1.5rem; padding-right: 5rem;">
                            <div style="margin-bottom: 0.5rem;">
                                <span style="font-size: 1.4rem;" title="Cultural integration level">${culturalStars}</span>
                            </div>
                            <h3 style="margin: 0; color: #1a4d2e; font-size: 1.4rem; font-weight: 700; line-height: 1.3;">
                                ${resource.title}
                            </h3>
                        </div>
                        
                        <!-- Description -->
                        <p style="color: #546e7a; margin: 1rem 0; line-height: 1.7; font-size: 1rem;">
                            ${resource.description || 'Professional teaching resource with cultural integration'}
                        </p>
                        
                        <!-- Rich Details Grid -->
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin: 1.5rem 0; padding: 1rem; background: #f9fafb; border-radius: 8px;">
                            <div>
                                <div style="font-size: 0.85rem; color: #6b7280; margin-bottom: 0.25rem;">Resource Type</div>
                                <div style="font-weight: 600; color: #1a4d2e;">ğŸ“š ${resource.type}</div>
                            </div>
                            <div>
                                <div style="font-size: 0.85rem; color: #6b7280; margin-bottom: 0.25rem;">Duration</div>
                                <div style="font-weight: 600; color: #1a4d2e;">â±ï¸ ${resource.estimated_duration_minutes || 60} min</div>
                            </div>
                            <div>
                                <div style="font-size: 0.85rem; color: #6b7280; margin-bottom: 0.25rem;">Difficulty</div>
                                <div style="font-weight: 600; color: #1a4d2e;">ğŸ“ˆ ${difficulty}</div>
                            </div>
                            <div>
                                <div style="font-size: 0.85rem; color: #6b7280; margin-bottom: 0.25rem;">Year Level</div>
                                <div style="font-weight: 600; color: #1a4d2e;">ğŸ“ ${resource.level || 'Multi-level'}</div>
                            </div>
                        </div>
                        
                        <!-- Tags -->
                        <div style="display: flex; gap: 0.75rem; margin: 1rem 0; flex-wrap: wrap;">
                            <span class="cultural-badge cultural-badge-${cultural}" style="display: inline-flex; align-items: center; gap: 0.3rem;">
                                ${culturalStars} ${cultural.charAt(0).toUpperCase() + cultural.slice(1)} Cultural
                            </span>
                            <span style="background: #fef3c7; color: #92400e; padding: 0.4rem 1rem; border-radius: 16px; font-size: 0.85rem; font-weight: 600;">
                                ğŸ¨ ${variantType.replace(/_/g, ' ')}
                            </span>
                        </div>
                        
                        <!-- Path -->
                        <div style="margin: 1rem 0; padding: 0.75rem; background: #f0f9ff; border-radius: 6px; border-left: 3px solid #0284c7;">
                            <small style="color: #0369a1; font-family: monospace; font-size: 0.85rem;">
                                ğŸ“ ${resource.path ? resource.path : 'Path not available'}
                            </small>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 1rem; margin-top: 1.5rem;">
                            <a href="${resource.path}" target="_blank" style="background: linear-gradient(135deg, ${culturalColor}, ${culturalColor}dd); color: white; padding: 1rem; text-align: center; border-radius: 10px; text-decoration: none; font-weight: 700; transition: all 0.3s; box-shadow: 0 4px 12px ${culturalColor}33;">
                                ğŸ“– View Lesson
                            </a>
                            <button onclick="findSimilarVariants('${resource.title.split('(')[0].trim()}')" style="background: #f59e0b; color: white; padding: 1rem; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s;">
                                ğŸ” Variants
                            </button>
                            <button onclick="addToKete('${resource.id}', '${resource.title.replace(/'/g, "\\'")}')" style="background: #6366f1; color: white; padding: 1rem; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s;">
                                ğŸ’ Save
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // Add to My Kete function
        function addToKete(resourceId, title) {
            let kete = JSON.parse(localStorage.getItem('myKete') || '[]');
            const item = { id: resourceId, title: title, addedAt: new Date().toISOString() };
            
            if (!kete.find(k => k.id === resourceId)) {
                kete.push(item);
                localStorage.setItem('myKete', JSON.stringify(kete));
                
                // Show success feedback
                const btn = event.target;
                const originalText = btn.innerHTML;
                btn.innerHTML = 'âœ… Saved!';
                btn.style.background = '#16a34a';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = '#6366f1';
                }, 2000);
            } else {
                alert('Already in your kete!');
            }
        }

        // Find similar variants of the same lesson
        async function findSimilarVariants(baseTitle) {
            const { data } = await supabase
                .from('resources')
                .select('*')
                .ilike('title', `%${baseTitle}%`)
                .limit(20);
            
            if (data && data.length > 1) {
                displayResults(data);
                document.getElementById('results-count').textContent = `(${data.length} variants of "${baseTitle}")`;
            }
        }

        // Clear filters
        function clearFilters() {
            document.getElementById('filter-cultural').value = '';
            document.getElementById('filter-type').value = '';
            document.getElementById('filter-variant').value = '';
            document.getElementById('search-box').value = '';
            
            document.getElementById('results-container').innerHTML = '<div style="text-align: center; padding: 4rem 2rem; color: #6b7280;"><p style="font-size: 1.2rem;">Filters cleared! Click "Find Teaching Options" to browse</p></div>';
            document.getElementById('results-count').textContent = '';
        }

        // Event listeners
        document.getElementById('apply-filters').addEventListener('click', findTeachingOptions);
        document.getElementById('clear-filters').addEventListener('click', clearFilters);
        
        // Search on Enter
        document.getElementById('search-box').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                findTeachingOptions();
            }
        });

        // Load total count on page load
        loadTotalCount();

        // Autocomplete functionality
        let autocompleteTimeout;
        document.getElementById('search-box').addEventListener('input', async (e) => {
            const term = e.target.value.trim();
            const suggestionsDiv = document.getElementById('autocomplete-suggestions');
            
            if (term.length < 2) {
                suggestionsDiv.style.display = 'none';
                return;
            }
            
            // Debounce
            clearTimeout(autocompleteTimeout);
            autocompleteTimeout = setTimeout(async () => {
                const { data } = await supabase
                    .from('resources')
                    .select('title, type, path')
                    .ilike('title', `%${term}%`)
                    .limit(10);
                
                if (data && data.length > 0) {
                    suggestionsDiv.innerHTML = data.map(item => `
                        <div onclick="selectSuggestion('${item.title.replace(/'/g, "\\'")}', '${item.path}')" style="padding: 0.75rem 1rem; cursor: pointer; border-bottom: 1px solid #f3f4f6; transition: background 0.2s;" onmouseover="this.style.background='#f0f9ff'" onmouseout="this.style.background='white'">
                            <div style="font-weight: 600; color: #1a4d2e; margin-bottom: 0.25rem;">${item.title}</div>
                            <div style="font-size: 0.85rem; color: #6b7280;">ğŸ“š ${item.type}</div>
                        </div>
                    `).join('');
                    suggestionsDiv.style.display = 'block';
                } else {
                    suggestionsDiv.style.display = 'none';
                }
            }, 300);
        });
        
        // Select suggestion
        function selectSuggestion(title, path) {
            document.getElementById('search-box').value = title;
            document.getElementById('autocomplete-suggestions').style.display = 'none';
            findTeachingOptions();
        }
        
        // Hide suggestions on click outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('#search-box') && !e.target.closest('#autocomplete-suggestions')) {
                document.getElementById('autocomplete-suggestions').style.display = 'none';
            }
        });

        // Example searches for quick access
        function quickSearch(searchTerm, cultural = '') {
            document.getElementById('search-box').value = searchTerm;
            if (cultural) {
                document.getElementById('filter-cultural').value = cultural;
            }
            findTeachingOptions();
        }
    </script>
    
    <style>
        .quick-search-btn {
            background: white;
            color: #0369a1;
            border: 2px solid #0284c7;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .quick-search-btn:hover {
            background: #0284c7;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(2,132,199,0.3);
        }
    </style>

    <!-- Quick Access Examples -->
    <section style="margin: 3rem 0; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 2rem; border-radius: 12px;">
        <h3 style="color: #92400e; margin-bottom: 1rem;">âš¡ Quick Examples - Try These:</h3>
        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
            <button onclick="quickSearch('algebra')" style="background: white; color: #1a4d2e; padding: 0.75rem 1.5rem; border: 2px solid #1a4d2e; border-radius: 8px; cursor: pointer; font-weight: 600;">
                ğŸ”¢ Algebra Lessons
            </button>
            <button onclick="quickSearch('ecosystem', 'high')" style="background: white; color: #1a4d2e; padding: 0.75rem 1.5rem; border: 2px solid #16a34a; border-radius: 8px; cursor: pointer; font-weight: 600;">
                ğŸŒ¿ Ecosystem (High Cultural)
            </button>
            <button onclick="quickSearch('statistics')" style="background: white; color: #1a4d2e; padding: 0.75rem 1.5rem; border: 2px solid #1a4d2e; border-radius: 8px; cursor: pointer; font-weight: 600;">
                ğŸ“Š Statistics
            </button>
            <button onclick="quickSearch('digital')" style="background: white; color: #1a4d2e; padding: 0.75rem 1.5rem; border: 2px solid #1a4d2e; border-radius: 8px; cursor: pointer; font-weight: 600;">
                ğŸ’» Digital Kaitiakitanga
            </button>
        </div>
    </section>

    <!-- Hover Preview Modal -->
    <div id="preview-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; padding: 2rem; overflow-y: auto;" onclick="closePreview(event)">
        <div style="max-width: 800px; margin: 2rem auto; background: white; border-radius: 20px; padding: 3rem; position: relative; box-shadow: 0 20px 60px rgba(0,0,0,0.3);" onclick="event.stopPropagation()">
            <button onclick="closePreview()" style="position: absolute; top: 1.5rem; right: 1.5rem; background: #dc2626; color: white; width: 40px; height: 40px; border: none; border-radius: 50%; cursor: pointer; font-size: 1.5rem; font-weight: 700; box-shadow: 0 4px 12px rgba(220,38,38,0.3);">
                Ã—
            </button>
            
            <div id="preview-content">
                <!-- Content loaded dynamically -->
            </div>
        </div>
    </div>
    
    <script>
        // Hover preview functionality
        function showPreview(resourceId) {
            // Load resource details from GraphRAG
            supabase.from('resources').select('*').eq('id', resourceId).single()
                .then(({ data }) => {
                    if (data) {
                        const modal = document.getElementById('preview-modal');
                        const content = document.getElementById('preview-content');
                        
                        const cultural = data.cultural_elements?.cultural_integration || 'medium';
                        const culturalStars = cultural === 'high' ? 'ğŸŒ¿ğŸŒ¿ğŸŒ¿' : (cultural === 'medium' ? 'ğŸŒ¿ğŸŒ¿' : 'ğŸŒ¿');
                        
                        content.innerHTML = `
                            <div style="margin-bottom: 2rem;">
                                <div style="font-size: 2rem; margin-bottom: 1rem;">${culturalStars}</div>
                                <h2 style="color: #1a4d2e; font-size: 2rem; margin-bottom: 1rem; font-weight: 800;">${data.title}</h2>
                                <p style="color: #546e7a; font-size: 1.1rem; line-height: 1.7;">${data.description || ''}</p>
                            </div>
                            
                            <div style="background: #f9fafb; padding: 2rem; border-radius: 12px; margin: 2rem 0;">
                                <h3 style="color: #1a4d2e; margin-bottom: 1rem;">ğŸ“‹ Details</h3>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem;">
                                    <div>
                                        <div style="color: #6b7280; font-size: 0.9rem; margin-bottom: 0.5rem;">Type</div>
                                        <div style="font-weight: 600; color: #1a4d2e;">ğŸ“š ${data.type}</div>
                                    </div>
                                    <div>
                                        <div style="color: #6b7280; font-size: 0.9rem; margin-bottom: 0.5rem;">Duration</div>
                                        <div style="font-weight: 600; color: #1a4d2e;">â±ï¸ ${data.estimated_duration_minutes || 60} min</div>
                                    </div>
                                    <div>
                                        <div style="color: #6b7280; font-size: 0.9rem; margin-bottom: 0.5rem;">Difficulty</div>
                                        <div style="font-weight: 600; color: #1a4d2e;">ğŸ“ˆ ${data.difficulty_level || 'Intermediate'}</div>
                                    </div>
                                    <div>
                                        <div style="color: #6b7280; font-size: 0.9rem; margin-bottom: 0.5rem;">Cultural</div>
                                        <div style="font-weight: 600; color: #1a4d2e;">${culturalStars} ${cultural}</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1rem; margin-top: 2rem;">
                                <a href="${data.path}" target="_blank" style="background: #1a4d2e; color: white; padding: 1.25rem; text-align: center; border-radius: 10px; text-decoration: none; font-weight: 700; font-size: 1.1rem;">
                                    ğŸ“– Open Resource
                                </a>
                                <button onclick="addToKete('${data.id}', '${data.title.replace(/'/g, "\\'")}')" style="background: #f59e0b; color: white; padding: 1.25rem; border: none; border-radius: 10px; cursor: pointer; font-weight: 700;">
                                    ğŸ’ Save
                                </button>
                            </div>
                        `;
                        
                        modal.style.display = 'block';
                        document.body.style.overflow = 'hidden';
                    }
                });
        }
        
        function closePreview(event) {
            if (!event || event.target.id === 'preview-modal') {
                document.getElementById('preview-modal').style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }
        
        // Close on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closePreview();
            }
        });
    </script>

    <!-- Why Variants Section -->
    <section style="margin: 4rem 0; background: white; border: 2px solid #e5e7eb; padding: 2rem; border-radius: 12px;">
        <h2 style="color: #1a4d2e; margin-bottom: 1rem;">â“ Why Multiple Variants?</h2>
        <p style="color: #546e7a; line-height: 1.8; margin-bottom: 1rem;">
            The same lesson content can be taught in many different ways! We've preserved multiple versions 
            so you can choose the approach that works best for YOUR students and YOUR context.
        </p>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 2rem;">
            <div style="padding: 1.5rem; background: #f0f9ff; border-radius: 8px;">
                <h3 style="color: #0369a1; margin-bottom: 0.5rem;">ğŸ¨ Different Styling</h3>
                <p style="color: #546e7a; font-size: 0.95rem;">Legacy CSS vs Modern CSS - choose what works for your tech setup</p>
            </div>
            
            <div style="padding: 1.5rem; background: #dcfce7; border-radius: 8px;">
                <h3 style="color: #166534; margin-bottom: 0.5rem;">ğŸŒ¿ Cultural Levels</h3>
                <p style="color: #546e7a; font-size: 0.95rem;">High, medium, or low cultural integration based on your class context</p>
            </div>
            
            <div style="padding: 1.5rem; background: #fef3c7; border-radius: 8px;">
                <h3 style="color: #92400e; margin-bottom: 0.5rem;">â±ï¸ Time Flexibility</h3>
                <p style="color: #546e7a; font-size: 0.95rem;">Quick versions vs extended deep-dives</p>
            </div>
            
            <div style="padding: 1.5rem; background: #fce7f3; border-radius: 8px;">
                <h3 style="color: #9f1239; margin-bottom: 0.5rem;">ğŸ“ˆ Difficulty Levels</h3>
                <p style="color: #546e7a; font-size: 0.95rem;">Differentiated options for diverse learners</p>
            </div>
        </div>
    </section>
</body>
</html>


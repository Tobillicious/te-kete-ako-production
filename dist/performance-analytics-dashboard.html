<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="/css/te-kete-professional.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Analytics Dashboard | Te Kete Ako</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            min-height: 100vh;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            color: #f1f5f9;
            margin-bottom: 8px;
        }

        .header p {
            color: #94a3b8;
            font-size: 1.1rem;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .metric-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            background: rgba(15, 23, 42, 0.8);
            border-color: rgba(59, 130, 246, 0.3);
            transform: translateY(-2px);
        }

        .metric-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .metric-icon {
            font-size: 1.5rem;
            margin-right: 12px;
        }

        .metric-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #cbd5e1;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: #f1f5f9;
            margin-bottom: 8px;
        }

        .metric-subtitle {
            color: #94a3b8;
            font-size: 0.9rem;
        }

        .trend-up { color: #10b981; }
        .trend-down { color: #ef4444; }

        .charts-section {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #f1f5f9;
        }

        .performance-chart {
            background: rgba(30, 41, 59, 0.4);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(148, 163, 184, 0.1);
        }

        .live-queries {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 12px;
            padding: 24px;
        }

        .query-item {
            background: rgba(30, 41, 59, 0.4);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            border-left: 4px solid #3b82f6;
        }

        .query-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .query-text {
            font-weight: 600;
            color: #f1f5f9;
        }

        .query-time {
            background: #1f2937;
            color: #10b981;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .query-details {
            color: #94a3b8;
            font-size: 0.9rem;
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-online { background: #10b981; }
        .status-warning { background: #f59e0b; }
        .status-offline { background: #ef4444; }

        .refresh-button {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }

        .refresh-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }
    </style>
</head>
<body>
<header class="site-header no-print">
        <div class="nav-container">
            <a href="index.html" class="nav-brand">
                <span class="brand-logo">🧺</span>
                <span class="brand-text">
                    <span class="brand-main">Te Kete Ako</span>
                </span>
            </a>
            <nav class="main-nav">
                <ul>
                        <li>
                            <a href="browse.html">
                                <span class="nav-icon">📚</span>
                                <span class="nav-text-mi" lang="mi">Ngā Rauemi</span>
                                <span class="nav-text-en">Resources</span>
                            </a>
                        <div class="nav-dropdown">
                            <ul>
                                <li><a href="unit-plans.html"><span class="dropdown-mi">📚 Ngā Mahere Wāhanga</span><span class="dropdown-en">Unit Plans (6-8 weeks)</span></a></li>
                                <li><a href="lessons.html"><span class="dropdown-mi">📖 Ngā Mahere Akoranga</span><span class="dropdown-en">Lesson Plans (60-75 min)</span></a></li>
                                <li><a href="handouts.html"><span class="dropdown-mi">📄 Ngā Kape</span><span class="dropdown-en">Handouts & Materials</span></a></li>
                                <li><a href="browse.html"><span class="dropdown-mi">🔍 Tirohia Katoa</span><span class="dropdown-en">Browse All Resources</span></a></li>
                            </ul>
                        </div>
                    </li>
                        <li>
                            <a href="browse.html?filter=subject">
                                <span class="nav-icon">🎨</span>
                                <span class="nav-text-mi" lang="mi">Ngā Marau</span>
                                <span class="nav-text-en">Subjects</span>
                            </a>
                        <div class="nav-dropdown">
                            <ul>
                                <li><a href="browse.html?subject=english"><span class="dropdown-mi">📝 Reo Pākehā</span><span class="dropdown-en">English</span></a></li>
                                <li><a href="browse.html?subject=math"><span class="dropdown-mi">🔢 Pāngarau</span><span class="dropdown-en">Mathematics</span></a></li>
                                <li><a href="browse.html?subject=science"><span class="dropdown-mi">🔬 Pūtaiao</span><span class="dropdown-en">Science</span></a></li>
                                <li><a href="browse.html?subject=social-studies"><span class="dropdown-mi">🌏 Tikanga-ā-Iwi</span><span class="dropdown-en">Social Studies</span></a></li>
                                <li><a href="browse.html?subject=te-reo"><span class="dropdown-mi">🌿 Te Reo Māori</span><span class="dropdown-en">Māori Language</span></a></li>
                                <li><a href="browse.html?subject=arts"><span class="dropdown-mi">🎨 Ngā Toi</span><span class="dropdown-en">The Arts</span></a></li>
                                <li><a href="browse.html?subject=health-pe"><span class="dropdown-mi">💪 Hauora</span><span class="dropdown-en">Health & PE</span></a></li>
                                <li><a href="browse.html?subject=technology"><span class="dropdown-mi">🔧 Hangarau</span><span class="dropdown-en">Technology</span></a></li>
                            </ul>
                        </div>
                    </li>
                        <li>
                            <a href="browse.html?filter=year">
                                <span class="nav-icon">📅</span>
                                <span class="nav-text-mi" lang="mi">Ngā Tau</span>
                                <span class="nav-text-en">Year Levels</span>
                            </a>
                            <div class="nav-dropdown nav-dropdown-wide">
                                <div class="year-stage-label">Primary / Tuatahi (1-6)</div>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=1"><span class="dropdown-mi">Tau 1</span><span class="dropdown-en">Year 1</span></a></li>
                                    <li><a href="browse.html?year=2"><span class="dropdown-mi">Tau 2</span><span class="dropdown-en">Year 2</span></a></li>
                                    <li><a href="browse.html?year=3"><span class="dropdown-mi">Tau 3</span><span class="dropdown-en">Year 3</span></a></li>
                                </ul>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=4"><span class="dropdown-mi">Tau 4</span><span class="dropdown-en">Year 4</span></a></li>
                                    <li><a href="browse.html?year=5"><span class="dropdown-mi">Tau 5</span><span class="dropdown-en">Year 5</span></a></li>
                                    <li><a href="browse.html?year=6"><span class="dropdown-mi">Tau 6</span><span class="dropdown-en">Year 6</span></a></li>
                                </ul>
                                <div class="year-stage-label">Intermediate / Waenga (7-8)</div>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=7"><span class="dropdown-mi">Tau 7</span><span class="dropdown-en">Year 7</span></a></li>
                                    <li><a href="browse.html?year=8"><span class="dropdown-mi">Tau 8</span><span class="dropdown-en">Year 8</span></a></li>
                                </ul>
                                <div class="year-stage-label">Junior Secondary / Tuarua (9-10)</div>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=9"><span class="dropdown-mi">Tau 9</span><span class="dropdown-en">Year 9</span></a></li>
                                    <li><a href="browse.html?year=10"><span class="dropdown-mi">Tau 10</span><span class="dropdown-en">Year 10</span></a></li>
                                </ul>
                                <div class="year-stage-label">Senior Secondary / NCEA (11-13)</div>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=11"><span class="dropdown-mi">Tau 11</span><span class="dropdown-en">Year 11</span></a></li>
                                    <li><a href="browse.html?year=12"><span class="dropdown-mi">Tau 12</span><span class="dropdown-en">Year 12</span></a></li>
                                    <li><a href="browse.html?year=13"><span class="dropdown-mi">Tau 13</span><span class="dropdown-en">Year 13</span></a></li>
                                </ul>
                            </div>
                        </li>
                    <li>
                        <a href="#more">
                            <span class="nav-icon">📦</span>
                            <span class="nav-text-mi" lang="mi">Ētahi Atu</span>
                            <span class="nav-text-en">More Stuff</span>
                        </a>
                        <div class="nav-dropdown">
                            <ul>
                                <li><a href="games.html"><span class="dropdown-mi">🎮 Ngā Kēmu</span><span class="dropdown-en">Games</span></a></li>
                                <li><a href="youtube.html"><span class="dropdown-mi">📺 Ataata YouTube</span><span class="dropdown-en">YouTube Videos</span></a></li>
                                <li><a href="curriculum-alignment.html"><span class="dropdown-mi">📋 Te Marautanga</span><span class="dropdown-en">Curriculum Alignment</span></a></li>
                                <li><a href="other-resources.html"><span class="dropdown-mi">🔗 Ētahi Atu Rauemi</span><span class="dropdown-en">Other Resources</span></a></li>
                            </ul>
                        </div>
                    </li>
                    <li class="auth-nav auth-logged-out">
                        <a href="login.html" class="auth-btn">
                            <span class="nav-icon" data-icon="login"></span>
                            <span class="nav-text-mi" lang="mi">Takiuru</span>
                            <span class="nav-text-en">Login</span>
                        </a>
                    </li>
                    <li class="auth-nav auth-logged-in" style="display: none;">
                        <a href="my-kete.html" class="dashboard-btn">
                            <span class="nav-icon" data-icon="kete"></span>
                            <span class="nav-text-mi" lang="mi">Tōku Kete</span>
                            <span class="nav-text-en">My Kete</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="dashboard-container">
        <!-- Header -->
        <div class="header">
            <h1>⚡ Performance Analytics Dashboard</h1>
            <p>Real-time monitoring for Te Kete Ako's AI orchestration system</p>
        </div>

        <button class="refresh-button" onclick="refreshMetrics()">🔄 Refresh Metrics</button>

        <!-- Key Metrics -->
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-icon">🚀</span>
                    <span class="metric-title">Avg Response Time</span>
                </div>
                <div class="metric-value" id="avg-response-time">--</div>
                <div class="metric-subtitle">Sub-second queries</div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-icon">🎯</span>
                    <span class="metric-title">Cache Hit Rate</span>
                </div>
                <div class="metric-value" id="cache-hit-rate">--</div>
                <div class="metric-subtitle">Performance optimization</div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-icon">📊</span>
                    <span class="metric-title">Total Queries</span>
                </div>
                <div class="metric-value" id="total-queries">--</div>
                <div class="metric-subtitle">Today's activity</div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <span class="metric-icon">🧠</span>
                    <span class="metric-title">GraphRAG Status</span>
                </div>
                <div class="metric-value">
                    <span class="status-indicator status-online"></span>
                    <span id="graphrag-status">Online</span>
                </div>
                <div class="metric-subtitle">775+ resources active</div>
            </div>
        </div>

        <!-- Performance Charts -->
        <div class="charts-section">
            <h2 class="section-title">📈 Performance Trends</h2>
            <div class="performance-chart">
                <div style="text-align: center;">
                    <h3 style="color: #94a3b8; margin-bottom: 10px;">Response Time Trends</h3>
                    <p style="color: #64748b;">Real-time performance visualization coming soon</p>
                    <div style="margin-top: 20px; color: #10b981;">⚡ Average: <span id="chart-avg">0ms</span></div>
                </div>
            </div>
        </div>

        <!-- Live Query Feed -->
        <div class="live-queries">
            <h2 class="section-title">🔍 Live Query Feed</h2>
            <div id="query-feed">
                <!-- Dynamic query items will be inserted here -->
            </div>
        </div>
    </div>

    <script>
        // Performance Analytics JavaScript
        let performanceData = {
            avgResponseTime: 0,
            cacheHitRate: '0%',
            totalQueries: 0,
            recentQueries: []
        };

        async function refreshMetrics() {
            try {
                // Test query to get performance metrics
                const response = await fetch('/.netlify/functions/cached-graphrag-turbo', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ query: 'Te Tiriti performance test', maxResults: 3 })
                });
                
                const data = await response.json();
                
                if (data.metadata?.metrics) {
                    updateMetrics(data.metadata.metrics);
                    addToQueryFeed('Performance test query', data.metadata.performance);
                }
            } catch (error) {
                console.error('Error refreshing metrics:', error);
                updateStatus('warning');
            }
        }

        function updateMetrics(metrics) {
            document.getElementById('avg-response-time').textContent = 
                Math.round(metrics.avgResponseTime || 0) + 'ms';
            document.getElementById('cache-hit-rate').textContent = metrics.cacheHitRate || '0%';
            document.getElementById('total-queries').textContent = metrics.totalQueries || 0;
            
            // Update chart average
            document.getElementById('chart-avg').textContent = 
                Math.round(metrics.avgResponseTime || 0) + 'ms';
        }

        function addToQueryFeed(query, performance) {
            const feed = document.getElementById('query-feed');
            const queryItem = document.createElement('div');
            queryItem.className = 'query-item';
            
            const cached = performance.cached ? 'CACHED' : 'LIVE';
            const timeColor = performance.responseTime < 100 ? '#10b981' : 
                           performance.responseTime < 500 ? '#f59e0b' : '#ef4444';
            
            queryItem.innerHTML = `
                <div class="query-meta">
                    <span class="query-text">${query}</span>
                    <span class="query-time" style="background: ${timeColor};">
                        ${performance.responseTime}ms
                    </span>
                </div>
                <div class="query-details">
                    Status: ${cached} • ${new Date().toLocaleTimeString()}
                </div>
            `;
            
            feed.insertBefore(queryItem, feed.firstChild);
            
            // Keep only last 10 queries
            while (feed.children.length > 10) {
                feed.removeChild(feed.lastChild);
            }
        }

        function updateStatus(status) {
            const statusEl = document.getElementById('graphrag-status');
            const indicator = statusEl.previousElementSibling;
            
            switch(status) {
                case 'online':
                    statusEl.textContent = 'Online';
                    indicator.className = 'status-indicator status-online';
                    break;
                case 'warning':
                    statusEl.textContent = 'Warning';
                    indicator.className = 'status-indicator status-warning';
                    break;
                case 'offline':
                    statusEl.textContent = 'Offline';
                    indicator.className = 'status-indicator status-offline';
                    break;
            }
        }

        // Auto-refresh every 30 seconds
        setInterval(refreshMetrics, 30000);
        
        // Initial load
        refreshMetrics();

        // Simulate some activity for demo
        setTimeout(() => {
            addToQueryFeed('Traditional navigation mathematics', { responseTime: 45, cached: true });
            addToQueryFeed('Te Reo Maori greetings handout', { responseTime: 123, cached: false });
            addToQueryFeed('Treaty of Waitangi analysis', { responseTime: 67, cached: true });
        }, 2000);
    </script>

<footer class="site-footer no-print">
        <div class="footer-content">
            <div class="footer-grid">
                <!-- Brand Section -->
                <div class="footer-section footer-brand">
                    <h3>🧺 Te Kete Ako</h3>
                    <p class="footer-whakataukī">"Whaowhia te kete mātauranga"</p>
                    <p class="footer-tagline">Fill the basket of knowledge</p>
                    <p class="footer-description">Quality teaching resources for Aotearoa New Zealand educators, honoring mātauranga Māori and contemporary pedagogy.</p>
                </div>

                <!-- Resources Section -->
                <div class="footer-section footer-resources">
                    <h4><span class="footer-mi">Ngā Rauemi</span> <span class="footer-en">Resources</span></h4>
                    <ul>
                        <li><a href="unit-plans.html">📚 Unit Plans / Ngā Mahere Wāhanga</a></li>
                        <li><a href="lessons.html">📖 Lesson Plans / Ngā Akoranga</a></li>
                        <li><a href="handouts.html">📄 Handouts / Ngā Kape</a></li>
                        <li><a href="games.html">🎮 Games / Ngā Kēmu</a></li>
                        <li><a href="browse.html">🔍 Browse All / Tirohia Katoa</a></li>
                    </ul>
                </div>

                <!-- Curriculum Section -->
                <div class="footer-section footer-curriculum">
                    <h4><span class="footer-mi">Te Marautanga</span> <span class="footer-en">Curriculum</span></h4>
                    <ul>
                        <li><a href="browse.html?subject=english">📝 English / Reo Pākehā</a></li>
                        <li><a href="browse.html?subject=math">🔢 Mathematics / Pāngarau</a></li>
                        <li><a href="browse.html?subject=science">🔬 Science / Pūtaiao</a></li>
                        <li><a href="browse.html?subject=social-studies">🌏 Social Studies / Tikanga-ā-Iwi</a></li>
                        <li><a href="curriculum-alignment.html">📋 NZ Curriculum Alignment</a></li>
                    </ul>
                </div>

                <!-- Account & Support Section -->
                <div class="footer-section footer-support">
                    <h4><span class="footer-mi">Tautoko</span> <span class="footer-en">Support</span></h4>
                    <ul>
                        <li><a href="my-kete.html">🧺 My Kete / Tōku Kete</a></li>
                        <li><a href="login.html">🔐 Login / Takiuru</a></li>
                        <li><a href="#about">ℹ️ About Us / Mō Mātou</a></li>
                        <li><a href="#contact">✉️ Contact / Whakapā Mai</a></li>
                        <li><a href="#help">❓ Help / Āwhina</a></li>
                    </ul>
                </div>
            </div>

            <!-- Footer Bottom -->
            <div class="footer-bottom">
                <div class="footer-bottom-content">
                    <span class="footer-copyright">© 2025 Te Kete Ako</span>
                    <span class="footer-separator">•</span>
                    <span class="footer-location">Aotearoa New Zealand</span>
                    <span class="footer-separator">•</span>
                    <a href="#privacy">Privacy</a>
                    <span class="footer-separator">•</span>
                    <a href="#terms">Terms</a>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>
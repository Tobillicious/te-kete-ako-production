<!DOCTYPE html>
<html lang="mi">
<head>
    <link rel="stylesheet" href="/css/te-kete-professional.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåü AI P≈´rƒÅkau Generator | Te Kete Ako</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;600;700&family=Dancing+Script:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Lato', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .floating-element {
            position: absolute;
            opacity: 0.1;
            animation: float 20s infinite linear;
            font-size: 2rem;
        }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); }
            100% { transform: translateY(-100px) rotate(360deg); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 10;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .title {
            font-family: 'Dancing Script', cursive;
            font-size: 3.5rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            font-size: 1.3rem;
            color: #666;
            margin-bottom: 20px;
        }

        .cultural-intro {
            background: linear-gradient(135deg, #e8f5e8, #f0f8f0);
            border: 2px solid #4caf50;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            font-style: italic;
            color: #2e7d32;
            text-align: left;
        }

        .generator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 968px) {
            .generator-grid {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 45px rgba(0, 0, 0, 0.15);
        }

        .panel-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e8f5e8;
        }

        .panel-icon {
            font-size: 2.5rem;
            margin-right: 15px;
        }

        .panel-title {
            font-size: 1.6rem;
            font-weight: 700;
            color: #667eea;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.2);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
            font-family: 'Lato', Arial, sans-serif;
        }

        .form-select {
            cursor: pointer;
        }

        .generate-button {
            width: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .generate-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
        }

        .generate-button:disabled {
            opacity: 0.7;
            transform: none;
            cursor: not-allowed;
        }

        .story-output {
            background: white;
            border-radius: 15px;
            padding: 30px;
            min-height: 400px;
            box-shadow: inset 0 4px 15px rgba(0, 0, 0, 0.05);
            font-size: 1.1rem;
            line-height: 1.8;
            position: relative;
        }

        .story-placeholder {
            color: #999;
            text-align: center;
            font-style: italic;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 300px;
            flex-direction: column;
            gap: 15px;
        }

        .loading-animation {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #e0e0e0;
            border-left: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .agent-status {
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .agent-status h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .agent-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }

        .agent-item {
            background: rgba(255, 255, 255, 0.8);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            text-align: center;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .agent-active {
            background: rgba(102, 126, 234, 0.2);
            border-color: #667eea;
            font-weight: 600;
        }

        .story-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .action-button {
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
        }

        .action-button.secondary {
            background: linear-gradient(135deg, #ff9800, #f57c00);
        }

        .examples {
            background: rgba(255, 248, 220, 0.8);
            border: 1px solid #ffd54f;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .examples h4 {
            color: #f57c00;
            margin-bottom: 10px;
        }

        .example-item {
            color: #666;
            margin: 5px 0;
            font-style: italic;
        }

        .wide-panel {
            grid-column: 1 / -1;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2.5rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
            }
            
            .container {
                padding: 15px;
            }
            
            .header {
                padding: 25px;
            }
            
            .panel {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
<header class="site-header no-print">
        <div class="nav-container">
            <a href="index.html" class="nav-brand">
                <span class="brand-logo">üß∫</span>
                <span class="brand-text">
                    <span class="brand-main">Te Kete Ako</span>
                </span>
            </a>
            <nav class="main-nav">
                <ul>
                        <li>
                            <a href="browse.html">
                                <span class="nav-icon">üìö</span>
                                <span class="nav-text-mi" lang="mi">NgƒÅ Rauemi</span>
                                <span class="nav-text-en">Resources</span>
                            </a>
                        <div class="nav-dropdown">
                            <ul>
                                <li><a href="unit-plans.html"><span class="dropdown-mi">üìö NgƒÅ Mahere WƒÅhanga</span><span class="dropdown-en">Unit Plans (6-8 weeks)</span></a></li>
                                <li><a href="lessons.html"><span class="dropdown-mi">üìñ NgƒÅ Mahere Akoranga</span><span class="dropdown-en">Lesson Plans (60-75 min)</span></a></li>
                                <li><a href="handouts.html"><span class="dropdown-mi">üìÑ NgƒÅ Kape</span><span class="dropdown-en">Handouts & Materials</span></a></li>
                                <li><a href="browse.html"><span class="dropdown-mi">üîç Tirohia Katoa</span><span class="dropdown-en">Browse All Resources</span></a></li>
                            </ul>
                        </div>
                    </li>
                        <li>
                            <a href="browse.html?filter=subject">
                                <span class="nav-icon">üé®</span>
                                <span class="nav-text-mi" lang="mi">NgƒÅ Marau</span>
                                <span class="nav-text-en">Subjects</span>
                            </a>
                        <div class="nav-dropdown">
                            <ul>
                                <li><a href="browse.html?subject=english"><span class="dropdown-mi">üìù Reo PƒÅkehƒÅ</span><span class="dropdown-en">English</span></a></li>
                                <li><a href="browse.html?subject=math"><span class="dropdown-mi">üî¢ PƒÅngarau</span><span class="dropdown-en">Mathematics</span></a></li>
                                <li><a href="browse.html?subject=science"><span class="dropdown-mi">üî¨ P≈´taiao</span><span class="dropdown-en">Science</span></a></li>
                                <li><a href="browse.html?subject=social-studies"><span class="dropdown-mi">üåè Tikanga-ƒÅ-Iwi</span><span class="dropdown-en">Social Studies</span></a></li>
                                <li><a href="browse.html?subject=te-reo"><span class="dropdown-mi">üåø Te Reo MƒÅori</span><span class="dropdown-en">MƒÅori Language</span></a></li>
                                <li><a href="browse.html?subject=arts"><span class="dropdown-mi">üé® NgƒÅ Toi</span><span class="dropdown-en">The Arts</span></a></li>
                                <li><a href="browse.html?subject=health-pe"><span class="dropdown-mi">üí™ Hauora</span><span class="dropdown-en">Health & PE</span></a></li>
                                <li><a href="browse.html?subject=technology"><span class="dropdown-mi">üîß Hangarau</span><span class="dropdown-en">Technology</span></a></li>
                            </ul>
                        </div>
                    </li>
                        <li>
                            <a href="browse.html?filter=year">
                                <span class="nav-icon">üìÖ</span>
                                <span class="nav-text-mi" lang="mi">NgƒÅ Tau</span>
                                <span class="nav-text-en">Year Levels</span>
                            </a>
                            <div class="nav-dropdown nav-dropdown-wide">
                                <div class="year-stage-label">Primary / Tuatahi (1-6)</div>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=1"><span class="dropdown-mi">Tau 1</span><span class="dropdown-en">Year 1</span></a></li>
                                    <li><a href="browse.html?year=2"><span class="dropdown-mi">Tau 2</span><span class="dropdown-en">Year 2</span></a></li>
                                    <li><a href="browse.html?year=3"><span class="dropdown-mi">Tau 3</span><span class="dropdown-en">Year 3</span></a></li>
                                </ul>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=4"><span class="dropdown-mi">Tau 4</span><span class="dropdown-en">Year 4</span></a></li>
                                    <li><a href="browse.html?year=5"><span class="dropdown-mi">Tau 5</span><span class="dropdown-en">Year 5</span></a></li>
                                    <li><a href="browse.html?year=6"><span class="dropdown-mi">Tau 6</span><span class="dropdown-en">Year 6</span></a></li>
                                </ul>
                                <div class="year-stage-label">Intermediate / Waenga (7-8)</div>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=7"><span class="dropdown-mi">Tau 7</span><span class="dropdown-en">Year 7</span></a></li>
                                    <li><a href="browse.html?year=8"><span class="dropdown-mi">Tau 8</span><span class="dropdown-en">Year 8</span></a></li>
                                </ul>
                                <div class="year-stage-label">Junior Secondary / Tuarua (9-10)</div>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=9"><span class="dropdown-mi">Tau 9</span><span class="dropdown-en">Year 9</span></a></li>
                                    <li><a href="browse.html?year=10"><span class="dropdown-mi">Tau 10</span><span class="dropdown-en">Year 10</span></a></li>
                                </ul>
                                <div class="year-stage-label">Senior Secondary / NCEA (11-13)</div>
                                <ul class="year-grid">
                                    <li><a href="browse.html?year=11"><span class="dropdown-mi">Tau 11</span><span class="dropdown-en">Year 11</span></a></li>
                                    <li><a href="browse.html?year=12"><span class="dropdown-mi">Tau 12</span><span class="dropdown-en">Year 12</span></a></li>
                                    <li><a href="browse.html?year=13"><span class="dropdown-mi">Tau 13</span><span class="dropdown-en">Year 13</span></a></li>
                                </ul>
                            </div>
                        </li>
                    <li>
                        <a href="#more">
                            <span class="nav-icon">üì¶</span>
                            <span class="nav-text-mi" lang="mi">ƒítahi Atu</span>
                            <span class="nav-text-en">More Stuff</span>
                        </a>
                        <div class="nav-dropdown">
                            <ul>
                                <li><a href="games.html"><span class="dropdown-mi">üéÆ NgƒÅ Kƒìmu</span><span class="dropdown-en">Games</span></a></li>
                                <li><a href="youtube.html"><span class="dropdown-mi">üì∫ Ataata YouTube</span><span class="dropdown-en">YouTube Videos</span></a></li>
                                <li><a href="curriculum-alignment.html"><span class="dropdown-mi">üìã Te Marautanga</span><span class="dropdown-en">Curriculum Alignment</span></a></li>
                                <li><a href="other-resources.html"><span class="dropdown-mi">üîó ƒítahi Atu Rauemi</span><span class="dropdown-en">Other Resources</span></a></li>
                            </ul>
                        </div>
                    </li>
                    <li class="auth-nav auth-logged-out">
                        <a href="login.html" class="auth-btn">
                            <span class="nav-icon" data-icon="login"></span>
                            <span class="nav-text-mi" lang="mi">Takiuru</span>
                            <span class="nav-text-en">Login</span>
                        </a>
                    </li>
                    <li class="auth-nav auth-logged-in" style="display: none;">
                        <a href="my-kete.html" class="dashboard-btn">
                            <span class="nav-icon" data-icon="kete"></span>
                            <span class="nav-text-mi" lang="mi">T≈çku Kete</span>
                            <span class="nav-text-en">My Kete</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="floating-elements">
        <!-- Floating cultural elements -->
        <div class="floating-element" style="left: 10%; animation-delay: 0s;">üå∫</div>
        <div class="floating-element" style="left: 20%; animation-delay: 3s;">üåø</div>
        <div class="floating-element" style="left: 30%; animation-delay: 6s;">üèîÔ∏è</div>
        <div class="floating-element" style="left: 40%; animation-delay: 9s;">üåä</div>
        <div class="floating-element" style="left: 50%; animation-delay: 12s;">ü¶Ö</div>
        <div class="floating-element" style="left: 60%; animation-delay: 15s;">üå≥</div>
        <div class="floating-element" style="left: 70%; animation-delay: 18s;">‚≠ê</div>
        <div class="floating-element" style="left: 80%; animation-delay: 21s;">ü¶ã</div>
        <div class="floating-element" style="left: 90%; animation-delay: 24s;">üå∏</div>
    </div>

    <div class="container">
        <div class="header">
            <h1 class="title">üåü AI P≈´rƒÅkau Generator</h1>
            <p class="subtitle">Create authentic MƒÅori stories with the power of multiple AI agents</p>
            
            <div class="cultural-intro">
                <strong>üå∫ He aha te p≈´rƒÅkau?</strong><br>
                P≈´rƒÅkau are traditional MƒÅori stories that carry cultural knowledge, values, and wisdom. 
                Our AI agents work together to help you create stories that honor Te Ao MƒÅori while 
                inspiring creativity and learning. Each story is crafted with cultural authenticity and educational purpose.
            </div>
        </div>

        <div class="generator-grid">
            <!-- Story Creation Panel -->
            <div class="panel">
                <div class="panel-header">
                    <span class="panel-icon">‚ú®</span>
                    <h2 class="panel-title">Create Your P≈´rƒÅkau</h2>
                </div>

                <div class="examples">
                    <h4>üé® Story Inspiration Examples:</h4>
                    <div class="example-item">"A young kiwi learns about whakapapa from Tane Mahuta"</div>
                    <div class="example-item">"Tangaroa teaches a fisherman about mauri of the ocean"</div>
                    <div class="example-item">"A child discovers their cultural identity through dreams"</div>
                </div>

                <form id="story-form">
                    <div class="form-group">
                        <label class="form-label" for="story-theme">üé≠ Story Theme/Topic</label>
                        <input type="text" id="story-theme" class="form-input" 
                               placeholder="e.g., Friendship, Environment, Cultural Identity, Courage">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="cultural-elements">üåø Cultural Elements to Include</label>
                        <input type="text" id="cultural-elements" class="form-input" 
                               placeholder="e.g., Whakapapa, Kaitiakitanga, Mauri, Te Reo phrases">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="story-setting">üèîÔ∏è Setting</label>
                        <select id="story-setting" class="form-input form-select">
                            <option value="">Choose a setting...</option>
                            <option value="ngahere">Ngahere (Forest)</option>
                            <option value="moana">Moana (Ocean)</option>
                            <option value="maunga">Maunga (Mountain)</option>
                            <option value="kainga">KƒÅinga (Village)</option>
                            <option value="marae">Marae (Cultural Center)</option>
                            <option value="awa">Awa (River)</option>
                            <option value="whenua">Whenua (Land/Earth)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="age-group">üë• Target Age Group</label>
                        <select id="age-group" class="form-input form-select">
                            <option value="years-1-3">Years 1-3 (Ages 5-7)</option>
                            <option value="years-4-6">Years 4-6 (Ages 8-10)</option>
                            <option value="years-7-8">Years 7-8 (Ages 11-12)</option>
                            <option value="years-9-10">Years 9-10 (Ages 13-14)</option>
                            <option value="years-11-13">Years 11-13 (Ages 15-17)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="story-length">üìè Story Length</label>
                        <select id="story-length" class="form-input form-select">
                            <option value="short">Short (200-400 words)</option>
                            <option value="medium">Medium (400-800 words)</option>
                            <option value="long">Long (800-1200 words)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="additional-notes">üìù Additional Ideas (Optional)</label>
                        <textarea id="additional-notes" class="form-input form-textarea" 
                                  placeholder="Any specific characters, lessons, or cultural values you'd like included..."></textarea>
                    </div>

                    <button type="submit" class="generate-button" id="generate-btn">
                        ü§ñ Deploy AI Agents & Create P≈´rƒÅkau
                    </button>
                </form>
            </div>

            <!-- Story Output Panel -->
            <div class="panel">
                <div class="panel-header">
                    <span class="panel-icon">üìñ</span>
                    <h2 class="panel-title">Your Generated P≈´rƒÅkau</h2>
                </div>

                <div class="agent-status" id="agent-status" style="display: none;">
                    <h4>ü§ñ Multi-Agent DeepSeek Status</h4>
                    <div class="agent-list" id="agent-list">
                        <div class="agent-item">Cultural Agent</div>
                        <div class="agent-item">Narrative Agent</div>
                        <div class="agent-item">Language Agent</div>
                        <div class="agent-item">Educational Agent</div>
                    </div>
                </div>

                <div class="story-output" id="story-output">
                    <div class="story-placeholder">
                        <span style="font-size: 3rem;">üìö</span>
                        <p>Your beautiful p≈´rƒÅkau will appear here once you create it!</p>
                        <p style="font-size: 0.9rem; color: #bbb;">Each story is crafted by multiple AI agents working together to ensure cultural authenticity and educational value.</p>
                    </div>
                </div>

                <div class="loading-animation" id="loading-animation">
                    <div class="loading-spinner"></div>
                    <p>ü§ñ <strong>Multiple DeepSeek agents are creating your p≈´rƒÅkau...</strong></p>
                    <p style="font-size: 0.9rem; color: #666;">Cultural validation, narrative construction, and educational optimization in progress</p>
                </div>

                <div class="story-actions" id="story-actions" style="display: none;">
                    <button class="action-button" onclick="shareStory()">üì§ Share Story</button>
                    <button class="action-button secondary" onclick="improveStory()">‚ú® Enhance</button>
                    <button class="action-button secondary" onclick="generateVariation()">üîÑ New Version</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // AI P≈™RƒÄKAU GENERATOR WITH MULTI-AGENT DEEPSEEK INTEGRATION
        let currentStory = null;
        let agentData = null;

        document.getElementById('story-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            await generatePurakau();
        });

        async function generatePurakau() {
            console.log('üåü Generating AI P≈´rƒÅkau with multiple DeepSeek agents...');
            
            // Get form data
            const formData = {
                theme: document.getElementById('story-theme').value,
                culturalElements: document.getElementById('cultural-elements').value,
                setting: document.getElementById('story-setting').value,
                ageGroup: document.getElementById('age-group').value,
                storyLength: document.getElementById('story-length').value,
                additionalNotes: document.getElementById('additional-notes').value
            };

            // Validate required fields
            if (!formData.theme) {
                alert('Please enter a story theme or topic');
                return;
            }

            // Show loading state
            showLoadingState();

            try {
                // Deploy multiple DeepSeek agents for story generation
                const response = await fetch('/.netlify/functions/deepseek-multi-agent-orchestra', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        task: `Create an authentic MƒÅori p≈´rƒÅkau (story) with the following parameters: Theme: "${formData.theme}", Cultural Elements: "${formData.culturalElements}", Setting: "${formData.setting}", Age Group: "${formData.ageGroup}", Length: "${formData.storyLength}", Additional Notes: "${formData.additionalNotes}". Ensure cultural authenticity, appropriate Te Reo MƒÅori integration, and educational value.`,
                        context: {
                            role: 'purakau_generator',
                            focus: 'cultural_storytelling',
                            age_group: formData.ageGroup,
                            story_type: 'maori_purakau',
                            cultural_authenticity: 'high',
                            source: 'student_story_generator'
                        },
                        priority: 'high',
                        agentCount: 4  // Deploy 4 specialized agents for storytelling
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    displayGeneratedStory(data, formData);
                    agentData = data;
                } else {
                    throw new Error('Story generation failed');
                }

            } catch (error) {
                console.error('‚ùå Story generation error:', error);
                displayError('Sorry! The AI story generators are having trouble right now. Please try again in a moment.');
            }

            hideLoadingState();
        }

        function showLoadingState() {
            document.getElementById('generate-btn').disabled = true;
            document.getElementById('generate-btn').textContent = 'ü§ñ AI Agents Working...';
            
            document.getElementById('story-output').style.display = 'none';
            document.getElementById('loading-animation').style.display = 'block';
            document.getElementById('agent-status').style.display = 'block';
            
            // Animate agent activation
            const agents = document.querySelectorAll('.agent-item');
            agents.forEach((agent, index) => {
                setTimeout(() => {
                    agent.classList.add('agent-active');
                }, index * 500);
            });
        }

        function hideLoadingState() {
            document.getElementById('generate-btn').disabled = false;
            document.getElementById('generate-btn').textContent = 'ü§ñ Deploy AI Agents & Create P≈´rƒÅkau';
            
            document.getElementById('loading-animation').style.display = 'none';
            document.getElementById('story-output').style.display = 'block';
            
            // Remove agent animation
            const agents = document.querySelectorAll('.agent-item');
            agents.forEach(agent => {
                agent.classList.remove('agent-active');
            });
        }

        function displayGeneratedStory(data, formData) {
            const storyOutput = document.getElementById('story-output');
            
            // Extract the story content from multi-agent response
            let storyContent = data.orchestration?.primary_response || "Once upon a time in Aotearoa...";
            
            // Add cultural guidance if available
            let culturalNotes = '';
            if (data.orchestration?.cultural_guidance) {
                culturalNotes = `<div style="background: rgba(76, 175, 80, 0.1); border-left: 4px solid #4caf50; padding: 15px; margin: 20px 0; border-radius: 5px;">
                    <h4 style="color: #4caf50; margin-bottom: 8px;">üåø Cultural Notes:</h4>
                    <p style="font-style: italic; color: #2e7d32;">${data.orchestration.cultural_guidance}</p>
                </div>`;
            }

            // Add educational insights
            let educationalInsights = '';
            if (data.orchestration?.practical_steps?.length > 0) {
                educationalInsights = `<div style="background: rgba(33, 150, 243, 0.1); border-left: 4px solid #2196f3; padding: 15px; margin: 20px 0; border-radius: 5px;">
                    <h4 style="color: #2196f3; margin-bottom: 8px;">üìö Teaching Opportunities:</h4>
                    <ul style="margin-left: 20px; color: #1565c0;">
                        ${data.orchestration.practical_steps.slice(0, 3).map(step => `<li>${step}</li>`).join('')}
                    </ul>
                </div>`;
            }

            // Multi-agent attribution
            let agentInfo = '';
            if (data.analytics?.agents_deployed) {
                agentInfo = `<div style="background: rgba(156, 39, 176, 0.1); border-left: 4px solid #9c27b0; padding: 15px; margin: 20px 0; border-radius: 5px;">
                    <h4 style="color: #9c27b0; margin-bottom: 8px;">ü§ñ Created by ${data.analytics.agents_deployed} AI Agents</h4>
                    <p style="font-size: 0.9rem; color: #7b1fa2;">Cultural authenticity score: ${(data.analytics.cultural_authenticity_score || 90).toFixed(1)}%</p>
                </div>`;
            }

            storyOutput.innerHTML = `
                <div style="line-height: 1.8; font-size: 1.1rem;">
                    ${storyContent}
                </div>
                ${culturalNotes}
                ${educationalInsights}
                ${agentInfo}
            `;

            currentStory = {
                content: storyContent,
                metadata: formData,
                agentData: data
            };

            document.getElementById('story-actions').style.display = 'flex';
        }

        function displayError(message) {
            const storyOutput = document.getElementById('story-output');
            storyOutput.innerHTML = `
                <div class="story-placeholder">
                    <span style="font-size: 3rem;">üòî</span>
                    <p style="color: #f44336;">${message}</p>
                    <p style="font-size: 0.9rem; color: #bbb;">Our AI agents will be back soon to help create amazing p≈´rƒÅkau!</p>
                </div>
            `;
        }

        async function shareStory() {
            if (!currentStory) return;
            
            const shareData = {
                title: 'üåü My AI-Generated P≈´rƒÅkau',
                text: `I created a beautiful MƒÅori story using Te Kete Ako's AI P≈´rƒÅkau Generator! Theme: ${currentStory.metadata.theme}`,
                url: window.location.href
            };
            
            if (navigator.share) {
                try {
                    await navigator.share(shareData);
                } catch (err) {
                    console.log('Share cancelled');
                }
            } else {
                // Fallback to copy to clipboard
                const textToCopy = `${shareData.title}\n\n${currentStory.content}\n\nCreated with Te Kete Ako AI P≈´rƒÅkau Generator`;
                navigator.clipboard.writeText(textToCopy).then(() => {
                    alert('Story copied to clipboard! üìã');
                });
            }
        }

        async function improveStory() {
            if (!currentStory) return;
            
            showLoadingState();
            
            try {
                const response = await fetch('/.netlify/functions/deepseek-multi-agent-orchestra', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        task: `Enhance and improve this existing p≈´rƒÅkau story while maintaining cultural authenticity: "${currentStory.content}". Add more vivid descriptions, strengthen cultural elements, improve narrative flow, and ensure age-appropriate language for ${currentStory.metadata.ageGroup}.`,
                        context: {
                            role: 'story_enhancement',
                            focus: 'narrative_improvement',
                            original_story: currentStory.content,
                            source: 'story_improvement'
                        },
                        priority: 'high',
                        agentCount: 4
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    displayGeneratedStory(data, currentStory.metadata);
                } else {
                    throw new Error('Story enhancement failed');
                }
            } catch (error) {
                console.error('‚ùå Story enhancement error:', error);
                alert('Story enhancement is temporarily unavailable. Please try again later.');
            }
            
            hideLoadingState();
        }

        async function generateVariation() {
            if (!currentStory) return;
            
            showLoadingState();
            
            try {
                const response = await fetch('/.netlify/functions/deepseek-multi-agent-orchestra', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        task: `Create a new variation of this p≈´rƒÅkau with the same theme but different characters, plot development, or perspective: "${currentStory.metadata.theme}". Maintain cultural authenticity while providing a fresh narrative approach. Setting: ${currentStory.metadata.setting}, Age Group: ${currentStory.metadata.ageGroup}.`,
                        context: {
                            role: 'story_variation',
                            focus: 'narrative_creativity',
                            original_theme: currentStory.metadata.theme,
                            source: 'story_variation'
                        },
                        priority: 'high',
                        agentCount: 4
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    displayGeneratedStory(data, currentStory.metadata);
                } else {
                    throw new Error('Story variation failed');
                }
            } catch (error) {
                console.error('‚ùå Story variation error:', error);
                alert('Story variation is temporarily unavailable. Please try again later.');
            }
            
            hideLoadingState();
        }

        // Initialize floating elements
        function initFloatingElements() {
            const elements = document.querySelectorAll('.floating-element');
            elements.forEach(element => {
                element.style.left = Math.random() * 90 + '%';
                element.style.animationDelay = Math.random() * 20 + 's';
                element.style.animationDuration = (15 + Math.random() * 10) + 's';
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            console.log('üåü AI P≈´rƒÅkau Generator initialized');
            initFloatingElements();
        });
    </script>

<footer class="site-footer no-print">
        <div class="footer-content">
            <div class="footer-grid">
                <!-- Brand Section -->
                <div class="footer-section footer-brand">
                    <h3>üß∫ Te Kete Ako</h3>
                    <p class="footer-whakataukƒ´">"Whaowhia te kete mƒÅtauranga"</p>
                    <p class="footer-tagline">Fill the basket of knowledge</p>
                    <p class="footer-description">Quality teaching resources for Aotearoa New Zealand educators, honoring mƒÅtauranga MƒÅori and contemporary pedagogy.</p>
                </div>

                <!-- Resources Section -->
                <div class="footer-section footer-resources">
                    <h4><span class="footer-mi">NgƒÅ Rauemi</span> <span class="footer-en">Resources</span></h4>
                    <ul>
                        <li><a href="unit-plans.html">üìö Unit Plans / NgƒÅ Mahere WƒÅhanga</a></li>
                        <li><a href="lessons.html">üìñ Lesson Plans / NgƒÅ Akoranga</a></li>
                        <li><a href="handouts.html">üìÑ Handouts / NgƒÅ Kape</a></li>
                        <li><a href="games.html">üéÆ Games / NgƒÅ Kƒìmu</a></li>
                        <li><a href="browse.html">üîç Browse All / Tirohia Katoa</a></li>
                    </ul>
                </div>

                <!-- Curriculum Section -->
                <div class="footer-section footer-curriculum">
                    <h4><span class="footer-mi">Te Marautanga</span> <span class="footer-en">Curriculum</span></h4>
                    <ul>
                        <li><a href="browse.html?subject=english">üìù English / Reo PƒÅkehƒÅ</a></li>
                        <li><a href="browse.html?subject=math">üî¢ Mathematics / PƒÅngarau</a></li>
                        <li><a href="browse.html?subject=science">üî¨ Science / P≈´taiao</a></li>
                        <li><a href="browse.html?subject=social-studies">üåè Social Studies / Tikanga-ƒÅ-Iwi</a></li>
                        <li><a href="curriculum-alignment.html">üìã NZ Curriculum Alignment</a></li>
                    </ul>
                </div>

                <!-- Account & Support Section -->
                <div class="footer-section footer-support">
                    <h4><span class="footer-mi">Tautoko</span> <span class="footer-en">Support</span></h4>
                    <ul>
                        <li><a href="my-kete.html">üß∫ My Kete / T≈çku Kete</a></li>
                        <li><a href="login.html">üîê Login / Takiuru</a></li>
                        <li><a href="#about">‚ÑπÔ∏è About Us / M≈ç MƒÅtou</a></li>
                        <li><a href="#contact">‚úâÔ∏è Contact / WhakapƒÅ Mai</a></li>
                        <li><a href="#help">‚ùì Help / ƒÄwhina</a></li>
                    </ul>
                </div>
            </div>

            <!-- Footer Bottom -->
            <div class="footer-bottom">
                <div class="footer-bottom-content">
                    <span class="footer-copyright">¬© 2025 Te Kete Ako</span>
                    <span class="footer-separator">‚Ä¢</span>
                    <span class="footer-location">Aotearoa New Zealand</span>
                    <span class="footer-separator">‚Ä¢</span>
                    <a href="#privacy">Privacy</a>
                    <span class="footer-separator">‚Ä¢</span>
                    <a href="#terms">Terms</a>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>